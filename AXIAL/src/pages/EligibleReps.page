<apex:page showHeader="true" sidebar="true" controller="EligibleRepsController">

    <apex:includeScript value="{!$Resource.jquery}"/>
    <apex:includeScript value="{!$Resource.UnderscoreJS}"/>
    <link href="{!URLFOR($Resource.Bootstrap, 'bootstrap-3.1.1-dist/css/bootstrap.css')}" rel="stylesheet"/>

    <div class="container">
        <apex:form >
            <div class="row">
                <div class="col-xs-6">
                    <div class="col-xs-8">
                        <input type="text" placeholder="filter..." onKeyUp="filter();" id="search-filter" class="form-control"/>
                    </div>
                        <apex:commandButton action="{!save}" value="Save" id="topSave" styleClass="col-xs-3 btn"/>
                </div>
            </div>

            <div class="row">
                <div class="col-lg-6">
                    <table id="rep-table" class="table">
                        <thead>
                            <th></th>
                            <th>First Name</th>
                            <th>Last Name</th>
                            <th>Eligible?</th>
                            <th>Sales Pod</th>
                            <th>MOA</th>
                        </thead>

                        <tbody>
                            <apex:repeat value="{!eligibleReps}" var="rep">
                                <tr data-rep-name="{!rep.FirstName} {!rep.LastName}" class="row">
                                    <td>{!rep.FirstName}</td>
                                    <td>{!rep.LastName}</td>
                                    <td><apex:inputCheckbox value="{!rep.Eligible_To_Receive_Leads__c}"></apex:inputCheckbox></td>
                                    <td><apex:inputField value="{!rep.Sales_Pod__c}"></apex:inputField></td>
                                    <td><apex:inputField value="{!rep.MOA__c}"></apex:inputField></td>
                                </tr>
                            </apex:repeat>
                        </tbody>
                    </table>
                </div>
            </div>

        </apex:form>
    </div>


    <script>
        $.expr[":"].contains = $.expr.createPseudo(function(arg) {
            return function( elem ) {
                return $(elem).text().toUpperCase().indexOf(arg.toUpperCase()) >= 0;
            };
        });

        function filter(){
            var data = $("#search-filter").val().split(" ");
            console.log(data);
            var jo = $("#rep-table").find("tr");
            if (data == "") {
                jo.show();
                return;
            }
            jo.hide();

            jo.filter(function (i, v) {
                var $t = $(this);
                for (var d = 0; d < data.length; ++d) {
                    if ($t.is(":contains('" + data[d] + "')")) {
                        return true;
                    }
                }
                return false;
            })
            //show the rows that match.
            .show();
        }
    </script>

</apex:page>