<apex:page controller="queryGenerator" standardStylesheets="false"  renderAs="pdf" >
<head>
  <style>
    body
    {
        font-size:10px;
    }
    @page {
        size: A3 landscape;
        margin : .2in;
        @top-center {
            content : element(header);
         }

        @bottom-left {
            content : element(footer);
        }

    }
    table
    {
        width:100%;
    }
    @bottom-left {
        content : element(footer);
    }
    div.footer {
        position : running(footer) ;
    }    
  </style> 
</head>

    <apex:outputText rendered="{!IF(ERROR_OCCURED,true,false)}" value="{!ERROR_MESSAGE}"/>
     
    <apex:outputText rendered="{!IF(!ERROR_OCCURED,true,false)}">   
        <h1>Report of {!OBJECT_TYPE_LABEL} ({!RECORD_COUNT} Records)</h1> 
        <table>
            <tr>
                <apex:repeat value="{!OBJECT_FIELDS}" var="FieldLable">          
                    <apex:outputText rendered="{!IF(HIDDEN_FIELD_MAP[LOWER(FieldLable)],false,true)}"><th>{!OBJECT_FIELD_MAP[LOWER(FieldLable)]}</th></apex:outputText>
                </apex:repeat>        
            </tr>
    
            
            <apex:repeat value="{!OBJECTS}" var="rec">
                <tr>
                    <apex:repeat value="{!OBJECT_FIELDS}" var="FieldLable">
                       <apex:outputText rendered="{!IF(HIDDEN_FIELD_MAP[LOWER(FieldLable)],false,true)}">
                           <td>
                               <apex:outputText rendered="{!IF(FIELD_DATA_TYPES[LOWER(FieldLable)]!= 'date',true,false)}">
                                  {!rec[LOWER(FieldLable)]}
                               </apex:outputText>
                               
                               <apex:outputText value="{0,date,MM'/'dd'/'yyyy}" rendered="{!IF(FIELD_DATA_TYPES[LOWER(FieldLable)]== 'date',true,false)}">
                                    <apex:param value="{!rec[LOWER(FieldLable)]}" /> 
                               </apex:outputText>
                           </td>
                       </apex:outputText>
                    </apex:repeat>
                </tr>
            </apex:repeat>
            
        </table>
    
        <div class="footer">
        <apex:outputText value="The Date: {0,date,MMMMM dd, yyyy 'at' hh:mm a}" styleClass="footer" >
            <apex:param value="{!NOW()}" />
        </apex:outputText> 
        </div>  
    </apex:outputText>  
</apex:page>