<apex:page controller="DealTeam_AddMultiple"  id="thePage" tabStyle="Ibanking_Project__c">  
<apex:sectionHeader title="Deal Team Edit" subtitle="New Deal Team"/>

<apex:form id="af">
    <apex:stylesheet value="{!URLFOR($Resource.dirs_img_css, '/css/tracker.main.css')}"/>
    <apex:stylesheet value="{!URLFOR($Resource.dirs_img_css, '/css/jquery.kiketable.colsizable.css')}"/>
    <apex:stylesheet value="{!URLFOR($Resource.dirs_img_css, '/css/ui-lightness/jquery-ui-1.7.2.custom.css')}"/>
    <apex:stylesheet value="{!$Resource.multyedit}"/>
    <apex:includeScript value="{!URLFOR($Resource.dir_js, '/js/jquery-1.3.2.min.js')}"/>
    <apex:includeScript value="{!URLFOR($Resource.dir_js, '/js/jquery-ui-1.7.2.custom.min.js')}"/>
    <apex:includeScript value="{!$Resource.jquery_tracker_buildO}"/>
    <apex:includeScript value="{!$Resource.jquery_tracker_build}"/>
    <apex:outputPanel id="trackerContainer" >
    	<apex:inputHidden value="{!jsonContent}" id="jsonContainer" />
    	<script> var objContainer = document.getElementById("{!$Component.jsonContainer}");</script>
	<div align="center" style="color:red;font-weight: bold !important;">{!ErrorMsg}</div>    
        <apex:pageBlock id="afpb" title="Deal Team Multi-Edit">
			<apex:pageBlockButtons >
                <!--
				<apex:commandButton value="Save & Close" action="{!save_close}"/>
                <apex:commandButton value="Save" action="{!save}"/>
            --> 
            
     
            
                <input class="btn" type="button" id="saveClose"  value="Save & Close" onclick="saveJson2(true);"/>
                <input class="btn" type="button" id="save" value="Save" onclick="saveJson2();"/>
                <input class="btn" type="button" onclick="addRows();" value="New"/>
                <input class="btn" type="button" value="Delete " onclick="deleteRows(0);" />
                <input class="btn" type="button" value="Cancel" onclick="location.href='/{!CurDealId}'" />
            </apex:pageBlockButtons>
            <apex:pageMessages id="error"/>
            <apex:pageBlockSection id="pbsJson" columns="1">
                <apex:pageBlockSectionItem id="pbsiJson">
                    <div id="div-space"></div>
                    <div id="div-space-2"></div>
                    <div style="padding:2px 0">
                    <table class="kiketable-colsizable" style="background-color: white;">
                    <colgroup>
                    <col style="width: 60px;"/>
                    <col style="width: 210px;"/>
                    <col style="width: 210px;"/>
                    <col style="width: 180px;"/>
                    <col style="width: 160px;"/>
                    <col style="width: 430px;"/>
                    </colgroup>
                    </table>
                    </div>
                    <!-- <apex:inputTextarea value="{!UserMsg}"/>-->
                </apex:pageBlockSectionItem>
            </apex:pageBlockSection>
        </apex:pageBlock>
                
        <style>
			iframe {
				width: 250px;
				position: absolute;
				top: 50%;
				margin-top: -90px;
				left: 50%;
				margin-left: -220px;
				/*display: none;*/
				/*background-color: #343434;*/
				border-color: #ffa602;
				border-style: solid;
				border-width: thin;
			}
		</style>
		
        <script>
        	function setIFrameSize(){
				$("#iframe").css("display", ""); 
				$("#iframe").height($("#iframe").contents().find('body').height());
				$("#iframe").css("display", "none");
				$("#iframe").contents().find("body").css("background-color", "#fefdb9");
			}
        
            var jsonTable;
            $(document).ready(
                function ()
                {
                	$("#thePage\\:af\\:afpb").append("<iframe id=\"iframe\" onload=\"setIFrameSize();\" scrolling=\"no\" frameborder=\"1\"></iframe>");
                    $.getJSON('/apex/DealTeam_AddMultipleJSON?did={!CurDealId}',{},function (data, textStatus) {
                        jsonTable = $.drawTable({
                            json : data,
                            debug : false,
                            divPath : "#div-space",
                            classes : {
                                "header" : [],
                                "table" : [
                                    "centerTd",
                                    "",
                                    "",
                                    "",
                                    "",
                                    ""
                                ],
                                "footer" : []
                            },
                            styles : {
                                colsWidth : [30,200,210,180,160,430]
                            }
                        });  
                        $.each($(".helpOrb"), function(i, img){
                        	var id = img.id;
                        	//img.title = data.hint[""+id];
                        });
                        $(".helpOrb").mouseenter(function(e){
                        	var html = "<div id=\"helpDiv\">" + data.hint[""+this.id].data + "</div>";
                        	//var html = data.hint[""+this.id];
	    					$("#iframe").css("top", ""+e.pageY+"px");
	    					$("#iframe").css("left", ""+e.pageX+"px");
	    					$("#iframe").css("display", "block");
	    					$("#iframe").contents().find("body").html(""+html);
	    					$("#iframe").css("height", data.hint[""+this.id].height);
	    					$("#iframe").contents().find('#helpDiv').css("font-size", "12px");
	    					$("#iframe").contents().find('#helpDiv').css("padding-top", "0px");
	    					//$("#iframe").css("height", "" + $("#iframe").contents().find('body').height() + "px");
	    				}).mouseleave(function(e){
	    					$("#iframe").css("display", "none");
	    				});
                    });
                }       
            );
function candelete()
{
	return {!canDelete};
}
            </script>
<apex:includeScript value="{!$Resource.jquery_tracker_functions}"/>            
        <!-- 
                    <input type="button" onclick="showJson();" value="Show JSON"/><br />
                        <textarea id="json-textarea" cols="100" rows="15"></textarea>
                        -->
               
    </apex:outputPanel>

</apex:form>

<div style="display:none;"> 
<apex:form id="saveJsonForm">
<apex:outputPanel id="showstate">
<apex:commandButton value="Save" action="{!save}" id="saveJson_save_btn" rerender="showstate"/>
<apex:inputHidden value="{!jsonContent}" id="theHiddenInput_strJSON"/>
<script>returnValues('/apex/DealTeam_AddMultiple?did={!CurDealId}','/{!CurDealId}');</script>
</apex:outputPanel>
</apex:form>
</div>
</apex:page>