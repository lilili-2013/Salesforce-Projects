<apex:page cache="true" action="{!preToSearch}" controller="SSearch" id="sResPage" contentType="application/vnd.ms-excel#ComplexConflictSearchResult.xls" renderAs="{!chooserender}">

	<apex:outputPanel rendered="{!IF(chooserender2==null && chooserender!='pdf', 'true', 'false')}" id="form">
	<div class="bFilter" style="margin:0px">
		<div class="view" style="margin:0px">
			<h2><label for="_sbstr">Complex Conflict Search</label></h2>
			
		</div>
	</div>
	
<apex:repeat rendered="{!IF(chooserender2==null && chooserender!='pdf', 'true', 'false')}" value="{!LinkPanel}" id="mmm" var="cfadd" rows="1">
<hr/>
<div class="panelWrapper" style="padding-left:20px;padding-bottom:12px">
	<div class="listLinks" style="visibility: visible;">
		<a id="Account_link" class="linklet" href="#Account_target">
			<span class="listTitle">Companies <span class="count">[{!AccountListSize}]</span></span></a>
		<span class="pipe"> | </span>
		<a id="Contact_link" class="linklet" href="#Contact_target">
			<span class="listTitle">Contacts <span class="count">[{!ContactListSize}]</span></span></a>
		<span class="pipe"> | </span>
		<a id="Activity_link" class="linklet" href="#Deal_target">
			<span class="listTitle">Deals <span class="count">[{!DealListSize}]</span></span></a>
		<span class="pipe"> | </span>
<!--		<a id="Note_link" class="linklet" href="#dealIdea_target">-->
<!--			<span class="listTitle">Deal Ideas <span class="count">[{!dealIdeaListSize}]</span></span></a>-->
		<span class="pipe"> | </span>
		<a id="Report_link" class="linklet" href="#Employee_target">
			<span class="listTitle">Employees <span class="count">[{!EmployeeListSize}]</span></span></a>
		<span class="pipe"> | </span>
		<a id="User_link" class="linklet" href="#TargetBuyers_target">
			<span class="listTitle">Target Buyers <span class="count">[{!TargetBuyersListSize}]</span></span></a>




		<span class="pipe"> | </span>
		<a id="Parent_Financial_Sponsor_link" class="linklet" href="#Parent_Financial_Sponsor_target">
			<span class="listTitle">Parent Financial Sponsor <span class="count">[{!Parent_Financial_Sponsor_ListSize}]</span></span></a>
		<span class="pipe"> | </span>
		<a id="Deal_Client_Contact_link" class="linklet" href="#Deal_Client_Contact_target">
			<span class="listTitle">Deal Client Contact <span class="count">[{!Deal_Client_Contact_ListSize}]</span></span></a>
		<span class="pipe"> | </span>
		<a id="Deal_Team_link" class="linklet" href="#Deal_Team_target">
			<span class="listTitle">Deal Teams <span class="count">[{!Deal_Team_ListSize}]</span></span></a>
		<span class="pipe"> | </span>
		<a id="Deal_Related_Party_link" class="linklet" href="#Deal_Related_Party_target">
			<span class="listTitle">Deal Related Party <span class="count">[{!Deal_Related_Party_ListSize}]</span></span></a>
		<span class="pipe"> | </span>
<!--		<a id="Key_Constituents_link" class="linklet" href="#Key_Constituents_target">-->
<!--			<span class="listTitle">Key Constituents <span class="count">[{!Key_Constituents_ListSize}]</span></span></a>-->


		<span class="pipe"> | </span>
		<a id="Target_Buyer_Contacts_link" class="linklet" href="#Target_Buyer_Contacts_target">
			<span class="listTitle">Target Buyer Contacts <span class="count">[{!Target_Buyer_Contacts_ListSize}]</span></span></a>
		<span class="pipe"> | </span>
		<!-- 
		<a id="Deal_Idea_Client_link" class="linklet" href="#Deal_Idea_Client_target">
			<span class="listTitle">Deal Idea Client <span class="count">[{!Deal_Idea_Client_ListSize}]</span></span></a>-->
		<span class="pipe"> | </span>
		<a id="Moelis_Employee_Relationship_link" class="linklet" href="#Moelis_Employee_Relationship_target">
			<span class="listTitle">Moelis Employee Relationship <span class="count">[{!Moelis_Employee_Relationship_ListSize}]</span></span></a>


	</div>
</div>
</apex:repeat>
</apex:outputPanel>      
  
<apex:outputPanel id="searchResPanel">
<!-- {!TraceInfo}  -->
<div class="bRelatedList">


	<apex:outputPanel rendered="{!IF(IsResults == false, 'true', 'false')}">
		<br/><br/><br/><br/>
		<div style="text-align: center;font-size:150%;"><b>There are no matching results</b></div>
	</apex:outputPanel>


   <!--        ACCOUNT OUTPUT     ------------------------------------------------------------------------------------------------------------------        -->
            <apex:pageBlock tabStyle="Account" rendered="{!IF(AccountListSize != '0', 'true', 'false')}">
                <apex:facet name="header">
                <a name="Account_target"/>
                   	<apex:outputPanel layout="none" style="line-height:20px;" >
                    <div style="line-height:20px;">
						<h3>Companies [{!AccountListSize}]</h3>
                    </div>
					</apex:outputPanel>
                </apex:facet>
              
                <apex:pageBlockTable value="{!AccountList}" var="varAccount" id="blockAccountId">
                    <apex:column styleClass="actionColumn">
                        <apex:facet name="header"><h3>Action</h3></apex:facet>
                            <apex:outputLink value="{!URLFOR($Action.Account.Edit, varAccount.id)}">
                                <b>Edit</b>
                            </apex:outputLink>                        
                    </apex:column>
                    <apex:column >
                        <apex:facet name="header">
                            <b>Name</b> 
                                    
                        </apex:facet>
                        <apex:outputLink value="{!URLFOR($Action.Account.View, varAccount.id)}">
                            {!varAccount.name}
                        </apex:outputLink>                          
                    </apex:column>
                    <apex:column >
                        <apex:facet name="header">Phone</apex:facet>
						{!varAccount.Phone}
                    </apex:column>
                    <apex:column >
                        <apex:facet name="header">Owner Alias</apex:facet>
                        <apex:outputLink value="/{!varAccount.OwnerId}">
                            {!varAccount.Owner.Alias}
                        </apex:outputLink>                          
                    </apex:column>
                </apex:pageBlockTable>
    
               
            </apex:pageBlock> 

   <!--      END OF ACCOUNT OUTPUT             -->
   
   
   
   
   <!--      CONTANT OUTPUT                    -->
           <apex:pageBlock tabStyle="Contact" rendered="{!IF(ContactListSize != '0', 'true', 'false')}">
                <apex:facet name="header">
	                <a name="Contact_target"/>
                   	<apex:outputPanel layout="none" style="line-height:20px;" >
                    <div style="line-height:20px;">
						<h3>Contacts [{!ContactListSize}]</h3>
                    </div>
					</apex:outputPanel>
                </apex:facet>
                
                
                
                <apex:pageBlockTable value="{!ContactList}" var="varContact" id="blockContactId">
                    <apex:column styleClass="actionColumn">
                        <apex:facet name="header"><h3>Action</h3></apex:facet>
                            <apex:outputLink value="{!URLFOR($Action.Contact.Edit, varContact.id)}">
                                <b>Edit</b>
                            </apex:outputLink>                        
                    </apex:column>
                    <apex:column >
                        <apex:facet name="header">
                            <b>Name</b>
                        </apex:facet>
                        <apex:outputLink value="{!URLFOR($Action.Contact.View, varContact.id)}">
                            {!varContact.name}
                        </apex:outputLink>                          
                    </apex:column>
                    <apex:column >
                        <apex:facet name="header">Company Name</apex:facet>
                        <apex:outputLink value="/{!varContact.Account.Id}">
                            {!varContact.Account.Name}
                        </apex:outputLink>                          
                    </apex:column>
                    <apex:column >
                        <apex:facet name="header">Phone</apex:facet>
						{!varContact.Phone}
                    </apex:column>
                    <apex:column >
                        <apex:facet name="header">Email</apex:facet>
                        <apex:outputLink value="mailto:{!varContact.Email}">
                            {!varContact.Email}
                        </apex:outputLink>                          
                    </apex:column>

                    <apex:column >
                        <apex:facet name="header">Contact Owner Alias</apex:facet>
                        <apex:outputLink value="/{!varContact.OwnerId}">
                            {!varContact.Owner.Alias}
                        </apex:outputLink>                          
                    </apex:column>


                </apex:pageBlockTable>
    
              
            </apex:pageBlock> 
   
   <!--      END OF CONTACT OUTPUT-->



    
   <!--      DEAL OUTPUT-->
           <apex:pageBlock tabStyle="Ibanking_Project__c" rendered="{!IF(DealListSize != '0', 'true', 'false')}">
                <apex:facet name="header">
                <a name="Deal_target"/>
                   	<apex:outputPanel layout="none" style="line-height:20px;" >
                    <div style="line-height:20px;">
						<h3>Deals [{!DealListSize}]</h3>
                    </div>
					</apex:outputPanel>
                </apex:facet>
                
               
                <apex:pageBlockTable value="{!DealList}" var="varDeal" id="blockDealId">
                    <apex:column styleClass="actionColumn">
                        <apex:facet name="header"><h3>Action</h3></apex:facet>
                            <apex:outputLink value="{!URLFOR($Action.Ibanking_Project__c.Edit, varDeal.id)}">
                                <b>Edit</b>
                            </apex:outputLink>                        
                    </apex:column>
                    <apex:column >
                        <apex:facet name="header">
                            <b>Project Name</b>
                        </apex:facet>
                        <apex:outputLink value="{!URLFOR($Action.Ibanking_Project__c.View, varDeal.id)}">
                            {! varDeal.name}
                        </apex:outputLink>                          
                    </apex:column>
                    <apex:column >
                        <apex:facet name="header">Client</apex:facet>
                        <apex:outputLink value="/{!varDeal.Client__c}">
                            {!varDeal.Client__r.Name}
                        </apex:outputLink>                          
                    </apex:column>
                    <apex:column >
                        <apex:facet name="header">Status</apex:facet>
						{!varDeal.Status__c}
                    </apex:column>


                </apex:pageBlockTable>
    
               
            </apex:pageBlock> 
   <!--      END OF DEAL OUTPUT-->
   
   
   


   <!--      EMPLOYEE OUTPUT-->
           <apex:pageBlock tabStyle="Employee_Profile__c" rendered="{!IF(EmployeeListSize != '0', 'true', 'false')}">
                <apex:facet name="header">
                	<a name="Employee_target"/>
                   	<apex:outputPanel layout="none" style="line-height:20px;" >
                    <div style="line-height:20px;">
						<h3>Employees [{!EmployeeListSize}]</h3>
                    </div>
					</apex:outputPanel>
                </apex:facet>
                
                <apex:pageBlockTable value="{!EmployeeList}" var="varEmployee" id="blockEmployeeId">
                    <apex:column styleClass="actionColumn">
                        <apex:facet name="header"><h3>Action</h3></apex:facet>
                            <apex:outputLink value="{!URLFOR($Action.Employee_Profile__c.Edit, varEmployee.id)}">
                                <b>Edit</b>
                            </apex:outputLink>                        
                    </apex:column>
                    <apex:column >
                        <apex:facet name="header">
                            <b>Employee ID</b>
                        </apex:facet>
                        <apex:outputLink value="{!URLFOR($Action.Employee_Profile__c.View, varEmployee.id)}">
                            {! varEmployee.name}
                        </apex:outputLink>                          
                    </apex:column>
                    <apex:column >
                        <apex:facet name="header">Last Name</apex:facet>
						{!varEmployee.Last_Name__c}
                    </apex:column>                    
                    <apex:column >
                        <apex:facet name="header">First Name</apex:facet>
						{!varEmployee.First_Name__c}
                    </apex:column>                    
                    <apex:column >
                        <apex:facet name="header">Title</apex:facet>
						{!varEmployee.Title__c}
                    </apex:column>                    
                    <apex:column >
                        <apex:facet name="header">Office Location</apex:facet>
						{!varEmployee.Office_Location__c}
                    </apex:column>                    
                    <apex:column >
                        <apex:facet name="header">Sub-Sector Specialities</apex:facet>
						{!varEmployee.Speciality_Sectors__c}
                    </apex:column>                    
                    <apex:column >
                        <apex:facet name="header">Group</apex:facet>
						{!varEmployee.Group__c}
                    </apex:column>                    
                    
                    
                </apex:pageBlockTable>
    
            </apex:pageBlock> 
   <!--      END OF EMPLOYEE OUTPUT-->




   <!--      TARGET BUYER OUTPUT-->
           <apex:pageBlock tabStyle="Potential_Buyer_Investor__c" rendered="{!IF(TargetBuyersListSize != '0', 'true', 'false')}">
                <apex:facet name="header">
                	<a name="TargetBuyers_target"/>
                   	<apex:outputPanel layout="none" style="line-height:20px;" >
                    <div style="line-height:20px;">
						<h3>Target Buyers [{!TargetBuyersListSize}]</h3>
                    </div>
					</apex:outputPanel>
                </apex:facet>
                
                <apex:pageBlockTable value="{!TargetBuyersList}" var="varTargetBuyers" id="blockTargetBuyersId">
                    <apex:column styleClass="actionColumn">
                        <apex:facet name="header"><h3>Action</h3></apex:facet>
                            <apex:outputLink value="{!URLFOR($Action.Potential_Buyer_Investor__c.Edit, varTargetBuyers.id)}">
                                <b>Edit</b>
                            </apex:outputLink>                        
                    </apex:column>
                    <apex:column >
                        <apex:facet name="header">
                            <b>Target Buyer Name </b>
                                    
                        </apex:facet>
                        <apex:outputLink value="{!URLFOR($Action.Potential_Buyer_Investor__c.View, varTargetBuyers.id)}">
                            {! varTargetBuyers.name}
                        </apex:outputLink>                          
                    </apex:column>
                </apex:pageBlockTable>
    
            </apex:pageBlock> 
    <!--      END OF TARGER BUYER OUTPUT-->










   <!--        Parent_Financial_Sponsor OUTPUT             -->
            <apex:pageBlock tabStyle="Account" rendered="{!IF(Parent_Financial_Sponsor_ListSize != '0', 'true', 'false')}">
                <apex:facet name="header">
                <a name="Parent_Financial_Sponsor_target"/>
                   	<apex:outputPanel layout="none" style="line-height:20px;" >
                    <div style="line-height:20px;">
						<h3>Parent Financial Sponsor [{!Parent_Financial_Sponsor_ListSize}]</h3>
                    </div>
					</apex:outputPanel>
                </apex:facet>
                
                <apex:pageBlockTable value="{!Parent_Financial_Sponsor_List}" var="var_Parent_Financial_Sponsor" id="block_Parent_Financial_Sponsor_Id">
                    <apex:column styleClass="actionColumn">
                        <apex:facet name="header"><h3>Action</h3></apex:facet>
                            <apex:outputLink value="{!URLFOR($Action.Financial_Sponsors__c.Edit, var_Parent_Financial_Sponsor.id)}">
                                <b>Edit</b>
                            </apex:outputLink>                        
                    </apex:column>
                    <apex:column >
                        <apex:facet name="header">
                            <b>Name </b>
                                    
                        </apex:facet>
                        <apex:outputLink value="{!URLFOR($Action.Financial_Sponsors__c.View, var_Parent_Financial_Sponsor.id)}">
                            {!var_Parent_Financial_Sponsor.name}
                        </apex:outputLink>                          
                    </apex:column>
                    <apex:column >
                        <apex:facet name="header">Company Name</apex:facet>
						{!var_Parent_Financial_Sponsor.Company_Name__r.Name}
                    </apex:column>
                    <apex:column >
                        <apex:facet name="header">Financial Sponsor Name</apex:facet>
                        {!var_Parent_Financial_Sponsor.Financial_Sponsor_Name__r.Name}
                    </apex:column>
                </apex:pageBlockTable>
    
            </apex:pageBlock> 

   <!--      END OF Parent_Financial_Sponsor OUTPUT             -->
            





   <!--        Deal_Client_Contact OUTPUT             -->
            <apex:pageBlock tabStyle="Account" rendered="{!IF(Deal_Client_Contact_ListSize != '0', 'true', 'false')}">
                <apex:facet name="header">
                <a name="Deal_Client_Contact_target"/>
                   	<apex:outputPanel layout="none" style="line-height:20px;" >
                    <div style="line-height:20px;">
						<h3>Deal Client Contact [{!Deal_Client_Contact_ListSize}]</h3>
                    </div>
					</apex:outputPanel>
                </apex:facet>
                
                <apex:pageBlockTable value="{!Deal_Client_Contact_List}" var="var_Deal_Client_Contact" id="block_Deal_Client_Contact_Id">
                    <apex:column styleClass="actionColumn">
                        <apex:facet name="header"><h3>Action</h3></apex:facet>
                            <apex:outputLink value="{!URLFOR($Action.Project_Client_Contact__c.Edit, var_Deal_Client_Contact.id)}">
                                <b>Edit</b>
                            </apex:outputLink>                        
                    </apex:column>
                    <apex:column >
                        <apex:facet name="header">
                            <b>Name </b>
                                    
                        </apex:facet>
                        <apex:outputLink value="{!URLFOR($Action.Project_Client_Contact__c.View, var_Deal_Client_Contact.id)}">
                            {!var_Deal_Client_Contact.name}
                        </apex:outputLink>                          
                    </apex:column>
                    <apex:column >
                        <apex:facet name="header">Client Contact Name</apex:facet>
						{!var_Deal_Client_Contact.Client_Contact__r.Name}
                    </apex:column>
                </apex:pageBlockTable>
    
            </apex:pageBlock> 

   <!--      END OF Deal_Client_Contact OUTPUT             -->
            




   <!--        Deal_Team OUTPUT             -->
            <apex:pageBlock tabStyle="Account" rendered="{!IF(Deal_Team_ListSize != '0', 'true', 'false')}">
                <apex:facet name="header">
                <a name="Deal_Team_target"/>
                   	<apex:outputPanel layout="none" style="line-height:20px;" >
                    <div style="line-height:20px;">
						<h3>Deal Team [{!Deal_Team_ListSize}]</h3>
                    </div>
					</apex:outputPanel>
                </apex:facet>
                
            </apex:pageBlock> 

   <!--      END OF Deal_Team OUTPUT             -->







   <!--        Deal_Related_Party OUTPUT             -->
            <apex:pageBlock tabStyle="Account" rendered="{!IF(Deal_Related_Party_ListSize != '0', 'true', 'false')}">
                <apex:facet name="header">
                <a name="Deal_Related_Party_target"/>
                   	<apex:outputPanel layout="none" style="line-height:20px;" >
                    <div style="line-height:20px;">
						<h3>Deal Related Party [{!Deal_Related_Party_ListSize}]</h3>
                    </div>
					</apex:outputPanel>
                </apex:facet>
                
                
                <apex:pageBlockTable value="{!Deal_Related_Party_List}" var="var_Deal_Related_Party" id="block_Deal_Related_Party_Id">
                    <apex:column styleClass="actionColumn">
                        <apex:facet name="header"><h3>Action</h3></apex:facet>
                            <apex:outputLink value="{!URLFOR($Action.Deal_Related_Parties__c.Edit, var_Deal_Related_Party.id)}">
                                <b>Edit</b>
                            </apex:outputLink>                        
                    </apex:column>
                    <apex:column >
                        <apex:facet name="header">
                            <b>Name</b>
                                   
                        </apex:facet>
                        <apex:outputLink value="{!URLFOR($Action.Deal_Related_Parties__c.View, var_Deal_Related_Party.id)}">
                            {!var_Deal_Related_Party.name}
                        </apex:outputLink>                          
                    </apex:column>
                    <apex:column >
                        <apex:facet name="header">Company Name</apex:facet>
						{!var_Deal_Related_Party.Company__r.Name}
                    </apex:column>
                </apex:pageBlockTable>
    
            </apex:pageBlock> 

   <!--      END OF Deal_Related_Party OUTPUT             -->








   <!--        Target_Buyer_Contacts OUTPUT             -->
            <apex:pageBlock tabStyle="Account" rendered="{!IF(Target_Buyer_Contacts_ListSize != '0', 'true', 'false')}">
                <apex:facet name="header">
                <a name="Target_Buyer_Contacts_target"/>
                   	<apex:outputPanel layout="none" style="line-height:20px;" >
                    <div style="line-height:20px;">
						<h3>Target Buyer Contacts [{!Target_Buyer_Contacts_ListSize}]</h3>
                    </div>
					</apex:outputPanel>
                </apex:facet>
                
                <apex:pageBlockTable value="{!Target_Buyer_Contacts_List}" var="var_Target_Buyer_Contacts" id="block_Target_Buyer_Contacts_Id">
                    <apex:column styleClass="actionColumn">
                        <apex:facet name="header"><h3>Action</h3></apex:facet>
                            <apex:outputLink value="{!URLFOR($Action.Potential_Buyer_Investor_Contact__c.Edit, var_Target_Buyer_Contacts.id)}">
                                <b>Edit</b>
                            </apex:outputLink>                        
                    </apex:column>
                    <apex:column >
                        <apex:facet name="header">
                            <b>Name</b>
                        </apex:facet>
                        <apex:outputLink value="{!URLFOR($Action.Potential_Buyer_Investor_Contact__c.View, var_Target_Buyer_Contacts.id)}">
                            {!var_Target_Buyer_Contacts.name}
                        </apex:outputLink>                          
                    </apex:column>
                    <apex:column >
                        <apex:facet name="header">Contact Name</apex:facet>
						{!var_Target_Buyer_Contacts.Contact__r.Name}
                    </apex:column>
                </apex:pageBlockTable>
    
            </apex:pageBlock> 

   <!--      END OF Target_Buyer_Contacts OUTPUT             -->







   <!--        Moelis_Employee_Relationship OUTPUT             -->
            <apex:pageBlock tabStyle="Account" rendered="{!IF(Moelis_Employee_Relationship_ListSize != '0', 'true', 'false')}">
                <apex:facet name="header">
                <a name="Moelis_Employee_Relationship_target"/>
                   	<apex:outputPanel layout="none" style="line-height:20px;" >
                    <div style="line-height:20px;">
						<h3>Moelis Employee Relationship [{!Moelis_Employee_Relationship_ListSize}]</h3>
                    </div>
					</apex:outputPanel>
                </apex:facet>
                
                
                <apex:pageBlockTable value="{!Moelis_Employee_Relationship_List}" var="var_Moelis_Employee_Relationship" id="block_Moelis_Employee_Relationship_Id">
                    <apex:column styleClass="actionColumn">
                        <apex:facet name="header"><h3>Action</h3></apex:facet>
                            <apex:outputLink value="{!URLFOR($Action.Employee_Relationships__c.Edit, var_Moelis_Employee_Relationship.id)}">
                                <b>Edit</b>
                            </apex:outputLink>                        
                    </apex:column>
                    <apex:column >
                        <apex:facet name="header">
                           <b>Name</b>
                        </apex:facet>
                        <apex:outputLink value="{!URLFOR($Action.Employee_Relationships__c.View, var_Moelis_Employee_Relationship.id)}">
                            {!var_Moelis_Employee_Relationship.name}
                        </apex:outputLink>                          
                    </apex:column>
                    <apex:column >
                        <apex:facet name="header">Contact Name</apex:facet>
						{!var_Moelis_Employee_Relationship.Contact__r.Name}
                    </apex:column>
                    <apex:column >
                        <apex:facet name="header">Employee Name</apex:facet>
                        {!var_Moelis_Employee_Relationship.Employee__r.Name}
                    </apex:column>
                </apex:pageBlockTable>
    
            </apex:pageBlock> 

   <!--      END OF Moelis_Employee_Relationship OUTPUT             -->
       
        </div>
<!-- End Default Content REMOVE THIS -->
</apex:outputPanel>

</apex:page>