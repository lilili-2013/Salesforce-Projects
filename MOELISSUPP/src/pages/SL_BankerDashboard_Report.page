<apex:page showHeader="false" controller="SL_BankerDashboard_Report_Controller"  renderAs="pdf" readOnly="true">
<head> 
    <meta http-equiv="Content-Type" content="text/html;charset=UTF-8" />
    <style>
        @page { 
            margin: 0.5in 0.25in 1.0in 0.25in;
            mso-header-margin: 0.0in; 
            mso-footer-margin: 0.0in;
            font-family:Arial,sans-serif;
            size: 11in 8.5in;
            @top-center { 
                /* chapter title in the running head of the left page */
                content: element(top);
            }
            @bottom-right {
                font-family:Arial,sans-serif; 
                font-size:8.0pt;
                content: "Page " counter(page); 
            }
        }
        @page:first{ 
            margin: 0.5in 0.25in 0.5in 0.25in; 
            @top-right { content: normal }
            @top-left { content: normal }
            @top-center { content: normal }
        }
        body{
            font-family:Arial,sans-serif;
        }
        h1{
            font-size: 12.0pt;
        }
        h2  {
            font-size: 10.0pt;
        }
        td  {
            padding-left:5px;
            padding-right:5px;
        }
        a   {
            font-size:6.0pt;
        }
        .tabl {
            background-color:white;
            border:1px solid black;
            font-size:8.0pt;
            font-family:Arial,sans-serif;
            vertical-align:top;
            width: 100%;
            /*page-break-inside: avoid;*/
        }
        .head {
            background-color:rgb(68, 105, 125);
            font-size:10.0pt;
            color:white;
            font-weight:bold;
            vertical-align:center;
            height:16pt;
            border-top:.5pt dotted black;
        }
        .summaryColumn{
        	width:180px;
        }
        .subtotal{
        	background-color:rgb(183, 200, 208);
        }
        .moneyColumn{
            width:40px;
            padding:2px;
            margin:0px;
        }
        .head2 {
            background-color:rgb(198, 188, 137);
            font-size:8.0pt;
            height:16pt;
            font-weight:bold;
            text-align:left;
            vertical-align:center;
            border-top:.5pt dotted black;
        }
        .right{
            text-align:right;
        }
        .bord{
            border-top:.5pt dotted black;
            height:2pt;
        }
        .spacer{
            height:8px;
        }
        div.top{                
            display: block; 
            padding: 5px;               
            position: running(top);
            font-size: 9pt;
            font-style: italic;
            font-weight: bold;
            color: #808080;           
        } 
        .totalgray {
            background-color:#F0EEE3;
        }
    </style>
</head>
<body>
<!--apex:outputText value="{!DebugInfo}"></apex:outputText-->
 <div class="top"></div>
 <apex:variable value="{!0}" var="rowNum"/>
<apex:repeat value="{!listSBS_Reports}" var="report">

<h1 style="{!IF(FLOOR(rowNum) == 0,'','page-break-before: always;')}">{!$Label.SL_ReportSummaryName}&nbsp;&#8211;&nbsp;Summary</h1>
<apex:variable var="rowNum" value="{!rowNum + 1}"/>
    <table cellpadding="0" cellspacing="0" border="0" class="tabl" align="center">
        <tr><td class="spacer"></td></tr>
        <tr>
            <td><b>Name:</b></td>
            <td>{!report.Last_Name}, {!report.First_Name}</td>
            <td><b>Title:</b></td>
            <td>{!report.Title}</td>
            <td><b>Report Start Date:</b></td>
            <td>
                <apex:outputText value="{0,date,MM/dd/yyyy}">
                    <apex:param value="{!curStartDate}" />
               </apex:outputText>
           </td>
        </tr>
        <tr><td colspan="6" class="bord">&nbsp;</td></tr>
        <tr>
            <td><b>Group:</b></td>
            <td>{!report.Groups}</td>
            <td><b>Start Date:</b></td>
            <td>
                <apex:outputText value="{0,date,MM/dd/yyyy}">
                    <apex:param value="{!report.Start_Date}" />
               </apex:outputText>
            </td>
            <td><b>Report End Date:</b></td>
            <td>
                <apex:outputText value="{0,date,MM/dd/yyyy}">
                    <apex:param value="{!curEndDate}" />
               </apex:outputText>
           </td>
        </tr>
        <tr><td colspan="6" class="bord">&nbsp;</td></tr>
        <tr>
            <td><b>Office:</b></td>
            <td>{!report.Office_Location}</td>
            <td><b>MD Promotion Date:</b></td>
            <td>
                <apex:outputText value="{0,date,MM/dd/yyyy}">
                    <apex:param value="{!report.MD_Promotion_Date}" />
               </apex:outputText>
            </td>
            <td></td>
            <td></td>
        </tr>
    </table>    
    <br/>
    <table cellpadding="0" cellspacing="0" border="0" class="tabl" align="center">
        <tr><td colspan="6"  class="head"><b>Current Period</b></td></tr>
        <tr>
            <td class="head2">Category</td>
            <td class="head2"></td>
            <td class="head2 right summaryColumn">Banker - Current Period</td>
            <td class="head2 right summaryColumn">Average</td>
            <td class="head2 right summaryColumn">Variance</td>
            <td class="head2"></td>
        </tr>
        <tr><td colspan="6" class="bord">&nbsp;</td></tr>
        <tr>
            <td>Pitches (#)</td>
            <td></td>
            <td class="right">{!report.Pitches_Banker}</td>
            <td class="right"><apex:outputText value="{0,number,#,###,##0.0}"><apex:param value="{!report.Pitches_Average}" /></apex:outputText></td>
            <td class="right">
                <apex:outputText value="{0,number,#,###,##0.0}" rendered="{!report.Pitches_Variance >=0}"><apex:param value="{!report.Pitches_Variance}" /></apex:outputText>
                <apex:outputText value="({0,number,#,###,##0.0})" rendered="{!report.Pitches_Variance <0}"><apex:param value="{!(-1)*report.Pitches_Variance}" /></apex:outputText>
            </td> 
            <td></td>
        </tr>
        <tr><td colspan="6" class="bord">&nbsp;</td></tr>
        <tr>
            <td>Resource Utilization (hrs)</td>
            <td></td>
            <td class="right"><apex:outputText value="{0,number,#,###,##0.00}"><apex:param value="{!report.RU_Banker}" /></apex:outputText></td>
            <td class="right"><apex:outputText value="{0,number,#,###,##0.00}"><apex:param value="{!report.RU_Average}" /></apex:outputText></td>
            <td class="right">
                <apex:outputText value="{0,number,#,###,##0.00}" rendered="{!report.RU_Variance >= 0}"><apex:param value="{!report.RU_Variance}" /></apex:outputText>
                <apex:outputText value="({0,number,#,###,##0.00})" rendered="{!report.RU_Variance < 0}"><apex:param value="{!(-1)*report.RU_Variance}" /></apex:outputText>   
            </td>
            <td></td>
        </tr>
        <tr><td colspan="6" class="bord">&nbsp;</td></tr>
        <tr><td class="spacer"></td></tr>
        <tr><td colspan="6" class="head"><b>Year to Date ({!currencySymbol})</b></td></tr>
        <tr>
            <td class="head2">Category </td>
            <td class="head2"></td>
            <td class="head2 right">Banker - YTD</td>
            <td class="head2 right">Average YTD</td>
            <td class="head2 right">Variance</td>
            <td class="head2"></td>
        </tr>
        <tr><td colspan="6" class="bord">&nbsp;</td></tr>
        <tr>
            <td>Net Pipeline (mm)</td>
            <td></td>
            <td class="right"><apex:outputText value="{0,number,#,###,##0.000}"><apex:param value="{!report.NetPipeline_Banker}" /></apex:outputText></td>
            
            <td class="right"><apex:outputText value="{0,number,#,###,##0.000}"><apex:param value="{!report.NetPipeline_Average}" /></apex:outputText></td>
            <td class="right">
                <apex:outputText value="{0,number,#,###,##0.00}" rendered="{!report.NetPipeline_Variance >= 0}"><apex:param value="{!report.NetPipeline_Variance}" /></apex:outputText>
                <apex:outputText value="({0,number,#,###,##0.00})" rendered="{!report.NetPipeline_Variance < 0}"><apex:param value="{!(-1)*report.NetPipeline_Variance}" /></apex:outputText>
            </td>
            <td></td>
        </tr>
        <tr><td colspan="6" class="bord">&nbsp;</td></tr>
        <tr>
            <td>Weighted Pipeline (mm)</td>
            <td></td>
            <td class="right">
                <apex:outputText value="{0,number,#,###,##0.000}" rendered="{!report.WeightPipeline_Banker>=0}">
                    <apex:param value="{!report.WeightPipeline_Banker}" />
                </apex:outputText>
                <apex:outputText value="({0,number,#,###,##0.000})" rendered="{!report.WeightPipeline_Banker<0}">
                    <apex:param value="{!(-1)*report.WeightPipeline_Banker}" />
                </apex:outputText>
            </td>
            <td class="right">
                <apex:outputText value="{0,number,#,###,##0.000}" rendered="{!report.WeightPipeline_Average>=0}">
                        <apex:param value="{!report.WeightPipeline_Average}" />
                    </apex:outputText>
                    <apex:outputText value="({0,number,#,###,##0.000})" rendered="{!report.WeightPipeline_Average<0}">
                        <apex:param value="{!(-1)*report.WeightPipeline_Average}" />
                </apex:outputText>
            </td>
            <td class="right">
                <apex:outputText value="{0,number,#,###,##0.000}" rendered="{!report.WeightPipeline_Variance>=0}">
                    <apex:param value="{!report.WeightPipeline_Variance}" />
                </apex:outputText>
                <apex:outputText value="({0,number,#,###,##0.000})" rendered="{!report.WeightPipeline_Variance<0}">
                    <apex:param value="{!(-1)*report.WeightPipeline_Variance}" />
                </apex:outputText>
            </td>
            <td></td>
        </tr>
        <tr><td colspan="6" class="bord">&nbsp;</td></tr>
        <tr>
            <td>YTD Fees Invoiced (mm)</td>
            <td></td>
            <td class="right">
                <apex:outputText value="{0,number,#,###,##0.000}"  rendered="{!report.YTDFeesInvoiced_Banker >= 0}">
                    <!--<apex:variable var="CP_estRevFees_subTotal" value="{!Round(report.YTDFeesInvoiced_Banker/1000000,3)}" />-->
                    <apex:param value="{!Round(report.YTDFeesInvoiced_Banker/1000000,3)}" />
                </apex:outputText>
                <apex:outputText value="({0,number,#,###,##0.000})"  rendered="{!report.YTDFeesInvoiced_Banker < 0}">
                    <!--<apex:variable var="CP_estRevFees_subTotal" value="{!Round((-1)*report.YTDFeesInvoiced_Banker/1000000,3)}" />-->
                    <apex:param value="{! Round((-1)*report.YTDFeesInvoiced_Banker/1000000,3)}" />
                </apex:outputText>
            </td>
            <td class="right">
                <apex:outputText value="{0,number,#,###,##0.000}"  rendered="{!report.YTDFeesInvoiced_Average >= 0}">
                    <!--<apex:variable var="CP_estRevFees_subTotal" value="{!Round(report.YTDFeesInvoiced_Average/1000000,3)}" />-->
                    <apex:param value="{!Round(report.YTDFeesInvoiced_Average/1000000,3)}" />
                </apex:outputText>
                <apex:outputText value="({0,number,#,###,##0.000})"  rendered="{!report.YTDFeesInvoiced_Average < 0}">
                    <!--<apex:variable var="CP_estRevFees_subTotal" value="{!Round((-1)*report.YTDFeesInvoiced_Average/1000000,3)}" />-->
                    <apex:param value="{! Round((-1)*report.YTDFeesInvoiced_Average/1000000,3)}" />
                </apex:outputText>
            </td>
            <td class="right">
                <apex:outputText value="{0,number,#,###,##0.000}"  rendered="{!report.YTDFeesInvoiced_Variance >= 0}">
                    <!--<apex:variable var="CP_estRevFees_subTotal" value="{!Round(report.YTDFeesInvoiced_Variance/1000000,3)}" />-->
                    <apex:param value="{!report.YTDFeesInvoiced_Variance/1000000}" />
                </apex:outputText>
                <apex:outputText value="({0,number,#,###,##0.000})"  rendered="{!report.YTDFeesInvoiced_Variance < 0}">
                    <!--<apex:variable var="CP_estRevFees_subTotal" value="{!Round((-1)*report.YTDFeesInvoiced_Variance/1000000,3)}" />-->
                    <apex:param value="{! (-1)*report.YTDFeesInvoiced_Variance/1000000}" />
                </apex:outputText>
                
            </td>
            <td></td>
        </tr>
        <tr><td colspan="6" class="bord">&nbsp;</td></tr>
        <tr>
            <td>Live Mandates (#)</td>
            <td></td>
            <td class="right">{!report.LiveMandates_Banker}</td>
            <td class="right"><apex:outputText value="{0,number,#,###,##0.0}"><apex:param value="{!report.LiveMandates_Average}" /></apex:outputText></td>
            <td class="right">
            <apex:outputText value="{0,number,#,###,##0.0}" rendered="{!report.LiveMandates_Variance >= 0}"><apex:param value="{!report.LiveMandates_Variance}" /></apex:outputText>
            <apex:outputText value="({0,number,#,###,##0.0})" rendered="{!report.LiveMandates_Variance < 0}"><apex:param value="{!(-1)*report.LiveMandates_Variance}" /></apex:outputText>
            </td>
            <td></td>
        </tr>
        <tr><td colspan="6" class="bord">&nbsp;</td></tr>
        <tr>
            <td>Average Fee Per Mandate (mm)</td>
            <td></td>
            <td class="right">
                <apex:outputText value="{0,number,#,###,##0.000}" rendered="{!report.AverageFee_Banker>=0}"><apex:param value="{!report.AverageFee_Banker}" /></apex:outputText>
                <apex:outputText value="({0,number,#,###,##0.000})" rendered="{!report.AverageFee_Banker<0}"><apex:param value="{!(-1)*report.AverageFee_Banker}" /></apex:outputText>
            </td>
            <td class="right">
                <apex:outputText value="{0,number,#,###,##0.000}" rendered="{!report.AverageFee_Average>=0}"><apex:param value="{!Round(report.AverageFee_Average,3)}" /></apex:outputText>
                <apex:outputText value="({0,number,#,###,##0.000})" rendered="{!report.AverageFee_Average<0}"><apex:param value="{!Round((-1)*report.AverageFee_Average,3)}" /></apex:outputText>
            </td>
            <td class="right">
                <apex:outputText value="{0,number,#,###,##0.000}" rendered="{!report.AverageFee_Variance>=0}"><apex:param value="{!Round(report.AverageFee_Variance,3)}" /></apex:outputText>
                <apex:outputText value="({0,number,#,###,##0.000})" rendered="{!report.AverageFee_Variance<0}"><apex:param value="{!Round((-1)*report.AverageFee_Variance,3)}" /></apex:outputText>
            </td>
            <td></td>
        </tr>
        <tr><td colspan="6" class="bord">&nbsp;</td></tr>
        <tr>
            <td>Pitches (#)</td>
            <td></td>
            <td class="right">{!report.YTD_Pitches_Banker}</td>
            <td class="right"><apex:outputText value="{0,number,#,###,##0.0}"><apex:param value="{!report.YTD_Pitches_Average}" /></apex:outputText></td>
            <td class="right">
                <apex:outputText value="{0,number,#,###,##0.0}" rendered="{!report.YTD_Pitches_Variance >=0 }"><apex:param value="{!report.YTD_Pitches_Variance}" /></apex:outputText>
                <apex:outputText value="({0,number,#,###,##0.0})" rendered="{!report.YTD_Pitches_Variance <0 }"><apex:param value="{!(-1)*report.YTD_Pitches_Variance}" /></apex:outputText>
            </td>
            <td></td>
        </tr>
        <tr><td colspan="6" class="bord">&nbsp;</td></tr>
        <tr>
            <td>Resource Utilization (hrs)</td>
            <td></td>
            <td class="right"><apex:outputText value="{0,number,#,###,##0.00}"><apex:param value="{!report.YTD_RU_Banker}" /></apex:outputText></td>
            <td class="right"><apex:outputText value="{0,number,#,###,##0.00}"><apex:param value="{!report.YTD_RU_Average}" /></apex:outputText></td>
            <td class="right">
                <apex:outputText value="{0,number,#,###,##0.00}" rendered="{!report.YTD_RU_Variance >= 0}"><apex:param value="{!report.YTD_RU_Variance}" /></apex:outputText>
                <apex:outputText value="({0,number,#,###,##0.00})" rendered="{!report.YTD_RU_Variance < 0}"><apex:param value="{!(-1)*report.YTD_RU_Variance}" /></apex:outputText>
            </td>
            <td></td>
        </tr>
    </table>
    <h1 style="page-break-before: always;" >{!$Label.SL_ReportSummaryName}&nbsp;&#8211;&nbsp;Detailed</h1>
    <table cellpadding="0" cellspacing="0" border="0" class="tabl" align="center">
        <tr><td class="spacer"></td></tr>
        <tr>
            <td><b>Name:</b></td>
            <td>{!report.Last_Name}, {!report.First_Name}</td>
            <td><b>Title:</b></td>
            <td>{!report.Title}</td>
            <td><b>Report Start Date:</b></td>
            <td>
                <apex:outputText value="{0,date,MM/dd/yyyy}">
                    <apex:param value="{!curStartDate}" />
               </apex:outputText>
           </td>
        </tr>
        <tr><td colspan="6" class="bord">&nbsp;</td></tr>
        <tr>
            <td><b>Group:</b></td>
            <td>{!report.Groups}</td>
            <td><b>Start Date:</b></td>
            <td>
                <apex:outputText value="{0,date,MM/dd/yyyy}">
                    <apex:param value="{!report.Start_Date}" />
               </apex:outputText>
            </td>
            <td><b>Report End Date:</b></td>
            <td>
                <apex:outputText value="{0,date,MM/dd/yyyy}">
                    <apex:param value="{!curEndDate}" />
               </apex:outputText>
           </td>
        </tr>
        <tr><td colspan="6" class="bord">&nbsp;</td></tr>
        <tr>
            <td><b>Office:</b></td>
            <td>{!report.Office_Location}</td>
            <td><b>MD Promotion Date:</b></td>
            <td>
                <apex:outputText value="{0,date,MM/dd/yyyy}">
                    <apex:param value="{!report.MD_Promotion_Date}" />
               </apex:outputText>
            </td>
            <td></td>
            <td></td>
        </tr>
    </table>
    <br/>
    <table  cellpadding="0" cellspacing="0" border="0" class="tabl" align="center">
        <tr><td colspan="14" class="head"><b>Pipeline &#38; Revenue Activity</b></td></tr>
        <tr><td colspan="14" class="bord"><h2>Current Year Pipeline ({!currencySymbol})</h2></td></tr>
        <tr>  
            <td class="head2" style="width:100px">Company Name</td>
            <td class="head2">Project Name</td>
            <td class="head2">Project Code</td>
            <td class="head2">Product Type</td>
            <td class="head2">Role</td>
            <td class="head2">Stage</td>
            <td class="head2 right moneyColumn">Txn Size (mm)</td>
            <td class="head2 right moneyColumn">Est. Fee Rev. (mm)</td>
            <td class="head2 right moneyColumn">Total Fees Invoiced (mm)</td>
            <td class="head2 right moneyColumn">YTD Fees Invoiced (mm)</td>
            <td class="head2 right">Expected Timing</td>
            <td class="head2 right moneyColumn">Net Est. Fee Rev. (mm)</td>
            <td class="head2 right moneyColumn">Prob. Adj. Rev. (mm)</td>
            <td class="head2" style="width:200px">Sr. Bankers</td>
        </tr>
        <apex:variable var="CYP_estRevFees_subTotal" value="{!0}" />
        <apex:variable var="CP_grandRevFees_subTotal" value="{!0}" />
        <!--<apex:variable var="CP_subTotal_revenueExpenses" value="{!0}" />-->
        <apex:repeat value="{!report.detailedCurrentYearPipeline}" var="deal">
        <tr><td colspan="14" class="bord">&nbsp;</td></tr>
        <tr> 
            <td>{!deal.company}</td>
            <td>{!deal.projectName}</td>
            <td>{!deal.projectCode}</td>
            <td>{!deal.recordtype}</td>
            <td>{!deal.role}</td>
            <td>{!deal.stage}</td>
            <td class="right moneyColumn">
                <apex:outputText value="{0,number,#,###,##0.0}" rendered="{!deal.txnSize >= 0 }"><apex:param value="{!deal.txnSize}" /></apex:outputText>
                <apex:outputText value="({0,number,#,###,##0.0})"  rendered="{!deal.txnSize < 0 }"><apex:param value="{!(-1)*deal.txnSize}" /></apex:outputText>
            </td>
            <td class="right moneyColumn">
                <apex:outputText value="{0,number,#,###,##0.000}" rendered="{!deal.revenue >= 0}"><apex:param value="{!deal.revenue}" /></apex:outputText>
                <apex:outputText value="({0,number,#,###,##0.000})" rendered="{!deal.revenue < 0}"><apex:param value="{! (-1)*deal.revenue}" /></apex:outputText>
            </td>
            <td class="right moneyColumn">
                <apex:outputText value="{0,number,#,###,##0.000}" rendered="{!deal.totalInvoiceFees >= 0}"><apex:param value="{!deal.totalInvoiceFees}" /></apex:outputText>
                <apex:outputText value="({0,number,#,###,##0.000})" rendered="{!deal.totalInvoiceFees < 0}"><apex:param value="{! (-1)*deal.totalInvoiceFees}" /></apex:outputText>
            </td>
            <td class="right moneyColumn">
                <apex:outputText value="{0,number,#,###,##0.000}"  rendered="{!deal.revenueFees >= 0}">
                    <apex:variable var="CYP_estRevFees_subTotal" value="{!CYP_estRevFees_subTotal + (deal.revenueFees/1000000)}" />
                    <apex:variable var="CP_grandRevFees_subTotal" value="{!CP_grandRevFees_subTotal + (deal.revenueFees/1000000)}" />
                    <apex:param value="{!(deal.revenueFees/1000000)}" />
                </apex:outputText>
                <apex:outputText value="({0,number,#,###,##0.000})"  rendered="{!deal.revenueFees < 0}">
                    <apex:variable var="CYP_estRevFees_subTotal" value="{!CYP_estRevFees_subTotal + (deal.revenueFees/1000000)}" />
                    <apex:variable var="CP_grandRevFees_subTotal" value="{!CP_grandRevFees_subTotal + (deal.revenueFees/1000000)}" />
                    <apex:param value="{! (-1)*(deal.revenueFees/1000000)}" />
                </apex:outputText>
            </td>
            <td class="right">{!deal.timing}</td>
            <td class="right moneyColumn">
                <apex:outputText value="{0,number,#,###,##0.000}" rendered="{!deal.netEstFeeRev >= 0}"><apex:param value="{!deal.netEstFeeRev}" /></apex:outputText>
                <apex:outputText value="({0,number,#,###,##0.000})" rendered="{!deal.netEstFeeRev < 0}"><apex:param value="{!(-1)*deal.netEstFeeRev}" /></apex:outputText>
            </td>
            <td class="right moneyColumn">
                <apex:outputText value="{0,number,#,###,##0.000}" rendered="{!deal.PARevenu >= 0}"><apex:param value="{!Round(deal.PARevenu,3)}" /></apex:outputText>
                <apex:outputText value="({0,number,#,###,##0.000})" rendered="{!deal.PARevenu < 0}"><apex:param value="{!Round((-1)*deal.PARevenu,3)}" /></apex:outputText> 
            </td>
            <td>{!deal.strCSBankerName}</td>
        </tr>
        </apex:repeat>
        <tr><td colspan="14" class="bord subtotal" >&nbsp;</td></tr>
        <!--Start : Subtotal for current pipeline should come here  -->
        <tr class="bord subtotal">
            <td colspan='4'><b>Subtotal - Current Year Pipeline</b></td>
            
            <td></td>
            <td></td>
            <td></td>
            <td class="right moneyColumn"><b>
                <apex:outputText value="{0,number,#,###,##0.000}" rendered="{!report.subTotalFeeRevenue_CYP_CPS>=0}"><apex:param value="{!report.subTotalFeeRevenue_CYP_CPS}" /></apex:outputText>
                <apex:outputText value="({0,number,#,###,##0.000})" rendered="{!!ISBLANK(report.subTotalFeeRevenue_CYP_CPS) && report.subTotalFeeRevenue_CYP_CPS<0}"><apex:param value="{!(-1)*report.subTotalFeeRevenue_CYP_CPS}" /></apex:outputText>
                <apex:outputText value="0.000" rendered="{!IF(ISBLANK(report.subTotalFeeRevenue_CYP_CPS),'true','false')}"></apex:outputText>
            </b></td>
             <td></td>
            <td class="right moneyColumn"><b>
                <apex:outputText value="{0,number,#,###,##0.000}" rendered="{!CYP_estRevFees_subTotal>=0}"><apex:param value="{!CYP_estRevFees_subTotal}" /></apex:outputText>
                <apex:outputText value="({0,number,#,###,##0.000})" rendered="{!!ISBLANK(CYP_estRevFees_subTotal) && CYP_estRevFees_subTotal<0}"><apex:param value="{!(-1)*CYP_estRevFees_subTotal}" /></apex:outputText>
                <apex:outputText value="0.000" rendered="{!IF(ISBLANK(CYP_estRevFees_subTotal),'true','false')}"></apex:outputText>
            </b></td>
            <td></td>
            <td  class="right moneyColumn"> <b>
                <apex:outputText value="{0,number,#,###,##0.000}" rendered="{!report.subTotalNetEstFeeRev_CYP>=0}"><apex:param value="{!report.subTotalNetEstFeeRev_CYP}" /></apex:outputText>
                <apex:outputText value="({0,number,#,###,##0.000})" rendered="{!!ISBLANK(report.subTotalNetEstFeeRev_CYP) && report.subTotalNetEstFeeRev_CYP<0}"><apex:param value="{!(-1)*report.subTotalNetEstFeeRev_CYP}" /></apex:outputText>
                <apex:outputText value="0.000" rendered="{!IF(ISBLANK(report.subTotalNetEstFeeRev_CYP),'true','false')}"></apex:outputText>
            </b></td>
            <td class="right moneyColumn"><b>
                <apex:outputText value="{0,number,#,###,##0.000}" rendered="{!report.subTotalPARevenue_CYP_CPS>=0}"><apex:param value="{!report.subTotalPARevenue_CYP_CPS}" /></apex:outputText>
                <apex:outputText value="({0,number,#,###,##0.000})" rendered="{!!ISBLANK(report.subTotalPARevenue_CYP_CPS) && report.subTotalPARevenue_CYP_CPS<0}"><apex:param value="{!(-1)*report.subTotalPARevenue_CYP_CPS}" /></apex:outputText>
                <apex:outputText value="0.000" rendered="{!IF(ISBLANK(report.subTotalPARevenue_CYP_CPS),'true','false')}"></apex:outputText>
            </b></td>
            <td></td>
        </tr>
        <tr><td colspan="14" class="bord">&nbsp;</td></tr>
        <!-- End : Subtitle for current pipeline  -->
        <!-- ##############################Added by Vivek Start : MBS-95 ################################### -->
        <tr><td colspan="14" class="bord"><h2>Other Pipeline ({!currencySymbol})</h2></td></tr>
        <tr>  
            <td class="head2" style="width:100px">Company Name</td>
            <td class="head2">Project Name</td>
            <td class="head2">Project Code</td>
            <td class="head2">Product Type</td>
            <td class="head2">Role</td>
            <td class="head2">Stage</td>
            <td class="head2 right moneyColumn">Txn Size (mm)</td>
            <td class="head2 right moneyColumn">Est. Fee Rev. (mm)</td>
            <td class="head2 right moneyColumn">Total Fees Invoiced (mm)</td>
            <td class="head2 right moneyColumn">YTD Fees Invoiced (mm)</td>
            <td class="head2 right">Expected Timing</td>
            <td class="head2 right moneyColumn">Net Est. Fee Rev. (mm)</td>
            <td class="head2 right moneyColumn">Prob. Adj. Rev. (mm)</td>
            <td class="head2" style="width:200px">Sr. Bankers</td>
        </tr>
        <apex:variable var="FP_estRevFees_subTotal" value="{!0}" />
        <!--<apex:variable var="CP_subTotal_revenueExpenses" value="{!0}" />-->
        <apex:repeat value="{!report.detailedFuturePipeline}" var="deal">
        <tr><td colspan="14" class="bord">&nbsp;</td></tr>
        <tr> 
            <td>{!deal.company}</td>
            <td>{!deal.projectName}</td>
            <td>{!deal.projectCode}</td>
            <td>{!deal.recordtype}</td>
            <td>{!deal.role}</td>
            <td>{!deal.stage}</td>
            <td class="right moneyColumn">
                <apex:outputText value="{0,number,#,###,##0.0}" rendered="{!deal.txnSize >= 0 }"><apex:param value="{!deal.txnSize}" /></apex:outputText>
                <apex:outputText value="({0,number,#,###,##0.0})"  rendered="{!deal.txnSize < 0 }"><apex:param value="{!(-1)*deal.txnSize}" /></apex:outputText>
            </td>
            <td class="right moneyColumn">
                <apex:outputText value="{0,number,#,###,##0.000}" rendered="{!deal.revenue >= 0}"><apex:param value="{!deal.revenue}" /></apex:outputText>
                <apex:outputText value="({0,number,#,###,##0.000})" rendered="{!deal.revenue < 0}"><apex:param value="{! (-1)*deal.revenue}" /></apex:outputText>
            </td>
            <td class="right moneyColumn">
                <apex:outputText value="{0,number,#,###,##0.000}" rendered="{!deal.totalInvoiceFees >= 0}"><apex:param value="{!deal.totalInvoiceFees}" /></apex:outputText>
                <apex:outputText value="({0,number,#,###,##0.000})" rendered="{!deal.totalInvoiceFees < 0}"><apex:param value="{! (-1)*deal.totalInvoiceFees}" /></apex:outputText>
            </td>
            <td class="right moneyColumn">
                <apex:outputText value="{0,number,#,###,##0.000}"  rendered="{!deal.revenueFees >= 0}">
                    <apex:variable var="FP_estRevFees_subTotal" value="{!FP_estRevFees_subTotal + (deal.revenueFees/1000000)}" />
                    <apex:variable var="CP_grandRevFees_subTotal" value="{!CP_grandRevFees_subTotal + (deal.revenueFees/1000000)}" />
                    <apex:param value="{!(deal.revenueFees/1000000)}" />
                </apex:outputText>
                <apex:outputText value="({0,number,#,###,##0.000})"  rendered="{!deal.revenueFees < 0}">
                    <apex:variable var="FP_estRevFees_subTotal" value="{!FP_estRevFees_subTotal + (deal.revenueFees/1000000)}" />
                    <apex:variable var="CP_grandRevFees_subTotal" value="{!CP_grandRevFees_subTotal + (deal.revenueFees/1000000)}" />
                    <apex:param value="{! (-1)*(deal.revenueFees/1000000)}" />
                </apex:outputText>
            </td>
            <td class="right">{!deal.timing}</td>
            <td class="right moneyColumn">
                <apex:outputText value="{0,number,#,###,##0.000}" rendered="{!deal.netEstFeeRev >= 0}"><apex:param value="{!deal.netEstFeeRev}" /></apex:outputText>
                <apex:outputText value="({0,number,#,###,##0.000})" rendered="{!deal.netEstFeeRev < 0}"><apex:param value="{!(-1)*deal.netEstFeeRev}" /></apex:outputText>
            </td>
            <td class="right moneyColumn">
                <apex:outputText value="{0,number,#,###,##0.000}" rendered="{!deal.PARevenu >= 0}"><apex:param value="{!Round(deal.PARevenu,3)}" /></apex:outputText>
                <apex:outputText value="({0,number,#,###,##0.000})" rendered="{!deal.PARevenu < 0}"><apex:param value="{!Round((-1)*deal.PARevenu,3)}" /></apex:outputText> 
            </td>
            <td>{!deal.strCSBankerName}</td>

        </tr>
        </apex:repeat>
        <tr><td colspan="14" class="bord subtotal">&nbsp;</td></tr>
         <!--  Subtotal for future pipeline should come here  -->
         <tr class="subtotal">  
            <td colspan='4'><b>Subtotal - Other Pipeline</b></td>
            
            <td></td>
            <td></td>
            <td></td>
            <td class="right moneyColumn"><b>
                <apex:outputText value="{0,number,#,###,##0.000}" rendered="{!report.subTotalFeeRevenue_FP_CPS>=0}"><apex:param value="{!report.subTotalFeeRevenue_FP_CPS}" /></apex:outputText>
                <apex:outputText value="({0,number,#,###,##0.000})" rendered="{!!ISBLANK(report.subTotalFeeRevenue_FP_CPS) && report.subTotalFeeRevenue_FP_CPS<0}"><apex:param value="{!(-1)*report.subTotalFeeRevenue_FP_CPS}" /></apex:outputText>
                <apex:outputText value="0.000" rendered="{!IF(ISBLANK(report.subTotalFeeRevenue_FP_CPS),'true','false')}"></apex:outputText>
            </b></td>
             <td></td>
            <td class="right moneyColumn"><b>
                <apex:outputText value="{0,number,#,###,##0.000}" rendered="{!FP_estRevFees_subTotal>=0}"><apex:param value="{!FP_estRevFees_subTotal}" /></apex:outputText>
                <apex:outputText value="({0,number,#,###,##0.000})" rendered="{!!ISBLANK(FP_estRevFees_subTotal) && FP_estRevFees_subTotal<0}"><apex:param value="{!(-1)*FP_estRevFees_subTotal}" /></apex:outputText>
                <apex:outputText value="0.000" rendered="{!IF(ISBLANK(FP_estRevFees_subTotal),'true','false')}"></apex:outputText>
            </b></td>
            <td></td>
            <td  class="right moneyColumn"> <b>
                <apex:outputText value="{0,number,#,###,##0.000}" rendered="{!report.subTotalNetEstFeeRev_FP>=0}"><apex:param value="{!report.subTotalNetEstFeeRev_FP}" /></apex:outputText>
                <apex:outputText value="({0,number,#,###,##0.000})" rendered="{!!ISBLANK(report.subTotalNetEstFeeRev_FP) && report.subTotalNetEstFeeRev_FP<0}"><apex:param value="{!(-1)*report.subTotalNetEstFeeRev_FP}" /></apex:outputText>
                <apex:outputText value="0.000" rendered="{!IF(ISBLANK(report.subTotalNetEstFeeRev_FP),'true','false')}"></apex:outputText>
            </b></td>
            <td class="right moneyColumn"><b>
                <apex:outputText value="{0,number,#,###,##0.000}" rendered="{!report.subTotalPARevenue_FP_CPS>=0}"><apex:param value="{!report.subTotalPARevenue_FP_CPS}" /></apex:outputText>
                <apex:outputText value="({0,number,#,###,##0.000})" rendered="{!!ISBLANK(report.subTotalPARevenue_FP_CPS) && report.subTotalPARevenue_FP_CPS<0}"><apex:param value="{!(-1)*report.subTotalPARevenue_FP_CPS}" /></apex:outputText>
                <apex:outputText value="0.000" rendered="{!IF(ISBLANK(report.subTotalPARevenue_FP_CPS),'true','false')}"></apex:outputText>
            </b></td>           
            <td></td>
        </tr>
        <tr><td colspan="14" class="totalgray bord">&nbsp;</td></tr>
        <!--################################End ##########################################  -->
        <tr class="totalgray">  
            <td colspan="4"><b>Total Pipeline</b></td>
            <td></td>
            <td></td>
            <td></td>
            <td class="right moneyColumn"><b>
                <apex:outputText value="{0,number,#,###,##0.000}" rendered="{!report.grandTotalFeeRevenue_CPS>=0}"><apex:param value="{!report.grandTotalFeeRevenue_CPS}" /></apex:outputText>
                <apex:outputText value="({0,number,#,###,##0.000})" rendered="{!report.grandTotalFeeRevenue_CPS<0}"><apex:param value="{!(-1)*report.grandTotalFeeRevenue_CPS}" /></apex:outputText>
            </b></td>
             <td></td>
            <td class="right moneyColumn"><b>
                <apex:outputText value="{0,number,#,###,##0.000}" rendered="{!CP_grandRevFees_subTotal>=0}"><apex:param value="{!CP_grandRevFees_subTotal}" /></apex:outputText>
                <apex:outputText value="({0,number,#,###,##0.000})" rendered="{!CP_grandRevFees_subTotal<0}"><apex:param value="{!(-1)*CP_grandRevFees_subTotal}" /></apex:outputText>
            </b></td>
            <td></td>
            
            <td  class="right moneyColumn"> <b>
                <apex:outputText value="{0,number,#,###,##0.000}" rendered="{!report.grandTotalNetEstFeeRev>=0}"><apex:param value="{!report.grandTotalNetEstFeeRev}" /></apex:outputText>
                <apex:outputText value="({0,number,#,###,##0.000})" rendered="{!!ISBLANK(report.grandTotalNetEstFeeRev) && report.grandTotalNetEstFeeRev<0}"><apex:param value="{!(-1)*report.grandTotalNetEstFeeRev}" /></apex:outputText>
                <apex:outputText value="0.000" rendered="{!IF(ISBLANK(report.grandTotalNetEstFeeRev),'true','false')}"></apex:outputText>
            </b></td>
            <td class="right moneyColumn"><b>
                <apex:outputText value="{0,number,#,###,##0.000}" rendered="{!report.grandTotalPARevenue_CPS>=0}"><apex:param value="{!report.grandTotalPARevenue_CPS}" /></apex:outputText>
                <apex:outputText value="({0,number,#,###,##0.000})" rendered="{!report.grandTotalPARevenue_CPS<0}"><apex:param value="{!(-1)*report.grandTotalPARevenue_CPS}" /></apex:outputText>
            </b></td>
            
            
            <td></td>
        </tr>
        <tr><td colspan="14" class="bord">&nbsp;</td></tr>
        <tr><td colspan="14"  class="bord"><h2>Completed Deals / Other YTD Fees Invoiced ({!currencySymbol})</h2></td></tr>
        <tr> 
            <td class="head2" style="width:100px">Company Name</td>
            <td class="head2">Project Name</td>
            <td class="head2">Project Code</td>
            <td class="head2"> Product Type</td>
            <td class="head2">Role</td>
            <td class="head2">Stage</td>
            <td class="head2 right moneyColumn"> Txn Size (mm) </td>
            <td class="head2 right moneyColumn">Est. Fee Rev. (mm)</td>
            <td class="head2 right moneyColumn">Total Fees Invoiced (mm) </td>
            <td class="head2 right moneyColumn">YTD Fees Invoiced (mm)</td>
            <td class="head2">Timing</td>
            <td class="head2" colspan="3">Sr. Bankers</td>
        </tr>
        <apex:variable var="COMPL_estRevFees_subTotal" value="{!0}" />
        <apex:variable var="OTHER_subTotal_revenueExpenses" value="{!0}" />
        <apex:repeat value="{!report.detailedOtherFeesInvoiced}" var="deal">
        <tr><td colspan="14" class="bord">&nbsp;</td></tr>
        <tr>
            <td>{!deal.company}</td>
            <td>{!deal.projectName}</td>
            <td>{!deal.projectCode}</td>
            <td>{!deal.recordtype}</td>
            <td>{!deal.role}</td>
            <td>{!deal.stage}</td>
            <td class="right moneyColumn">
                <apex:outputText value="{0,number,#,###,##0.0}" rendered="{!deal.txnSize >= 0 }"><apex:param value="{!deal.txnSize}" /></apex:outputText>
                <apex:outputText value="({0,number,#,###,##0.0})"  rendered="{!deal.txnSize < 0 }"><apex:param value="{!(-1)*deal.txnSize}" /></apex:outputText>
            </td>
            <td class="right moneyColumn">
                <apex:outputText value="{0,number,#,###,##0.000}" rendered="{!deal.revenue >= 0}"><apex:param value="{!deal.revenue}" /></apex:outputText>
                <apex:outputText value="({0,number,#,###,##0.000})" rendered="{!deal.revenue < 0}"><apex:param value="{! (-1)*deal.revenue}" /></apex:outputText>
            </td>
            <td class="right moneyColumn">
                <apex:outputText value="{0,number,#,###,##0.000}" rendered="{!deal.totalInvoiceFees >= 0}"><apex:param value="{!deal.totalInvoiceFees}" /></apex:outputText>
                <apex:outputText value="({0,number,#,###,##0.000})" rendered="{!deal.totalInvoiceFees < 0}"><apex:param value="{! (-1)*deal.totalInvoiceFees}" /></apex:outputText>
            </td>
            <td class="right moneyColumn">
                <apex:outputText value="{0,number,#,###,##0.000}"  rendered="{!deal.revenueFees >= 0}">
                    <apex:variable var="COMPL_estRevFees_subTotal" value="{!COMPL_estRevFees_subTotal + (deal.revenueFees/1000000)}" />
                    <apex:param value="{!(deal.revenueFees/1000000)}" />
                </apex:outputText>
                <apex:outputText value="({0,number,#,###,##0.000})"  rendered="{!deal.revenueFees < 0}">
                    <apex:variable var="COMPL_estRevFees_subTotal" value="{!COMPL_estRevFees_subTotal + (deal.revenueFees/1000000)}" />
                    <apex:param value="{! (-1)*(deal.revenueFees/1000000)}" />
                </apex:outputText>
            </td>
            <td>{!deal.timing}</td>
            <td colspan="3" >{!deal.strCSBankerName}</td>
        </tr>
        </apex:repeat>
        <tr><td colspan="14" class="bord subtotal">&nbsp;</td></tr>
        <tr class="subtotal"> 
            <td colspan='4'><b>Subtotal</b></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td><!-- this td was to replace the commented one below.
            <td class="right"><b>
                <apex:outputText value="{0,number,#,###,##0.000}" rendered="{!report.subtotalFeeRevenue_OFI>=0}"><apex:param value="{!report.subtotalFeeRevenue_OFI}" /></apex:outputText>
                <apex:outputText value="({0,number,#,###,##0.000})" rendered="{!report.subtotalFeeRevenue_OFI<0}"><apex:param value="{!(-1)*report.subtotalFeeRevenue_OFI}" /></apex:outputText>
            </b></td>-->
            <td></td>
            <td class="right moneyColumn"><b>
                <apex:outputText value="{0,number,#,###,##0.000}" rendered="{!COMPL_estRevFees_subTotal>=0}">
                    <apex:param value="{!COMPL_estRevFees_subTotal}" />
                </apex:outputText>
                <apex:outputText value="({0,number,#,###,##0.000})" rendered="{!COMPL_estRevFees_subTotal<0}">
                    <apex:param value="{!(-1)*COMPL_estRevFees_subTotal}" />
                </apex:outputText>
            </b></td> 
            <td></td>
            <td></td>
            <td></td>
            <td></td>
        </tr> 
        <tr><td colspan="14" class="totalgray bord">&nbsp;</td></tr>
        <tr class="totalgray"> 
            <td colspan="4"><b>Grand Total</b></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td> 
            <td></td> 
            <td class="right moneyColumn"><b>
                <apex:outputText value="{0,number,#,###,##0.000}" rendered="{!(CP_grandRevFees_subTotal + COMPL_estRevFees_subTotal) >= 0}">
                    <apex:param value="{! (CP_grandRevFees_subTotal + COMPL_estRevFees_subTotal)}" />
                </apex:outputText>
                <apex:outputText value="({0,number,#,###,##0.000})" rendered="{!(CP_grandRevFees_subTotal + COMPL_estRevFees_subTotal) < 0}">
                    <apex:param value="{! (-1)*(CP_grandRevFees_subTotal + COMPL_estRevFees_subTotal)}" />
                </apex:outputText></b>
            </td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
        </tr>
    </table>    
    <br/>
    <table cellpadding="0" cellspacing="0" border="0" class="tabl"  style="border-bottom:.1pt solid white;" align="center">
        <tr><td colspan="10" class="head"><b>New Business Activity </b></td></tr>
    </table>    
    <table  cellpadding="0" cellspacing="0" border="0" class="tabl"  style="border-top:.5pt dotted black;border-bottom:.1pt solid white;" align="center">
        <tr><td colspan="14"><h2>Near Term Transactions ({!currencySymbol})</h2></td></tr>
        <tr>
            <td class="head2" style="width:100px">Company Name</td>
            <td class="head2">Project Name</td>
            <td class="head2">Project Code</td>
            <td class="head2">Deal Type</td>
            <td class="head2 right moneyColumn">Txn Size (mm)</td>
            <td class="head2 right moneyColumn">Est. Fees (mm)</td>
            <td class="head2 right moneyColumn">Deal Prob. (%)</td>
            <td class="head2 right moneyColumn">Moelis Prob. (%)</td>
            <td class="head2">Expected Timing</td>
            <td class="head2">Status</td>
            <td class="head2" style="width:100px">Senior<br/>Assistance</td>
            <td class="head2" style="width:100px">Product<br/>Assistance</td>
            <td class="head2" style="width:100px">Industry<br/>Assistance</td>
            <td class="head2" style="width:300px">Description of Transaction</td>
        </tr>
        <tr><td colspan="14" class="bord">&nbsp;</td></tr>
        <tr><td colspan="4"><apex:outputText rendered="{!report.listNearTermTransactions.size == 0}"><b>No data to report.</b></apex:outputText></td></tr>
        <apex:repeat value="{!report.listNearTermTransactions}" var="tr">
        <tr><td colspan="14" class="bord">&nbsp;</td></tr>
        <tr>
            <td>{!tr.Company}</td>
            <td>{!tr.projectName}</td>
            <td>{!tr.projectCode}</td>
            <td>{!tr.Type}</td>
            <td class="right moneyColumn"><apex:outputText value="{0,number,#,###,##0.0}" ><apex:param value="{!tr.txnSize}" /></apex:outputText></td>
            <td class="right moneyColumn"><apex:outputText value="{0,number,#,###,##0.000}" ><apex:param value="{!tr.estFees}" /></apex:outputText></td>
            <td class="right moneyColumn">{!tr.dealProb}</td>
            <td class="right moneyColumn">{!tr.moelisProb}</td>
            <td>{!tr.expectedTiming}</td>
            <td>{!tr.targetStatus}</td>
            <td>{!tr.srAssistance}</td>
            <td>{!tr.productAssistance}</td>
            <td>{!tr.industryAssistance}</td>
            <td>{!tr.Description}</td>
        </tr>
        </apex:repeat>   
        <tr><td colspan="14"  class="bord">&nbsp;</td></tr>
    </table>    
    <table  cellpadding="0" cellspacing="0" border="0" class="tabl"  style="border-top:.5pt dotted black;border-bottom: .5t black;" align="center">
        <tr><td colspan="12"><h2>Pitches YTD ({!currencySymbol})</h2></td></tr>
        <tr>
            <td class="head2" style="width:100px">Company Name</td>
            <td class="head2">Project Name</td>
            <td class="head2">Project Code</td>
            <td class="head2">Role</td>
            <td class="head2">Product Type</td>
            <td class="head2">Pitch Date</td>
            <td class="head2 right moneyColumn">Txn Size<br/>(mm)</td>
            <td class="head2 right moneyColumn">Est. Fee<br/>Rev. (mm)</td>
            <td class="head2">Expected Timing</td>
            <td class="head2" style="width:100px">Stage</td>
            <td class="head2" style="width:175px">Reason (if&nbsp;Lost&nbsp;or&nbsp;Dead)</td>
            <td class="head2" style="width:200px">Sr. Bankers</td>
        </tr>
        <tr><td colspan="12" class="bord">&nbsp;</td></tr>
        <tr><td colspan="4"><apex:outputText rendered="{!report.listPitchesYTD.size == 0}"><b>No data to report.</b></apex:outputText></td></tr>
        <apex:repeat value="{!report.listPitchesYTD}" var="deal">
        <tr><td colspan="12" class="bord">&nbsp;</td></tr>
        <tr>
            <td>{!deal.company}</td>
            <td>{!deal.projectName}</td>
            <td>{!deal.projectCode}</td>
            <td>{!deal.role}</td>
            <td>{!deal.recordType}</td>
            <td>
                <apex:outputText value="{0,date,MM/dd/yy}">
                    <apex:param value="{!deal.pitchDate}" />
               </apex:outputText>
            </td>
            <td class="right moneyColumn">
                <apex:outputText value="{0,number,#,###,##0.0}" rendered="{!deal.txnSize >= 0 }"><apex:param value="{!deal.txnSize}" /></apex:outputText>
                <apex:outputText value="({0,number,#,###,##0.0})"  rendered="!{deal.txnSize < 0 }"><apex:param value="{!(-1)*deal.txnSize}" /></apex:outputText>
            </td>
            <td class="right moneyColumn">
                <apex:outputText value="{0,number,#,###,##0.000}" rendered="{!deal.revenue >= 0 }"><apex:param value="{!deal.revenue}" /></apex:outputText>
                <apex:outputText value="({0,number,#,###,##0.000})"  rendered="{!deal.revenue < 0 }"><apex:param value="{!(-1)*deal.revenue}" /></apex:outputText>
            </td>
            <td>{!deal.expectedTiming}</td>
            <td>{!deal.stage}</td>
            <td>{!deal.reason}</td>
            <td>{!deal.team}</td>
        </tr>
        </apex:repeat>
    </table>
    <br/>
    <table cellpadding="0" cellspacing="0" border="0" class="tabl" align="center">
        <tr><td colspan="6" class="head"><b>Resource Management </b></td></tr>
        <tr><td colspan="6" class="bord"><h2>Resource Utilization&nbsp;&#8211;&nbsp;Current Period</h2></td></tr>
        <tr> 
            <td class="head2"></td>
            <td class="head2 right" style="width:150px">Deal Hours</td>
            <td class="head2 right" style="width:150px">Infra/Bus Dev Hours</td>
            <td class="head2 right" style="width:150px">Total Hours</td>
            <td class="head2 right" style="width:150px">Average Usage</td>
            <td class="head2 right" style="width:150px">Variance</td>
        </tr>
        <apex:repeat value="{!report.listResourcesUtilizationCurrentPeriod}" var="hour">
        <tr><td colspan="6" class="bord">&nbsp;</td></tr>
        <tr>
            <td>{!hour.title}</td>
            <td class="right"><apex:outputText value="{0,number,#,###,##0.00}"><apex:param value="{!hour.dealHours}" /></apex:outputText></td>
            <td class="right"><apex:outputText value="{0,number,#,###,##0.00}"><apex:param value="{!hour.devHours}" /></apex:outputText></td>
            <td class="right"><apex:outputText value="{0,number,#,###,##0.00}"><apex:param value="{!hour.totalHours}" /></apex:outputText></td>
            <td class="right"><apex:outputText value="{0,number,#,###,##0.00}"><apex:param value="{!hour.averageUsage}" /></apex:outputText></td>
            <td class="right">
                <apex:outputText value="{0,number,#,###,##0.00}"  rendered="{!hour.variance >= 0 }"><apex:param value="{!hour.variance}" /></apex:outputText>
                <apex:outputText value="({0,number,#,###,##0.00})"  rendered="{!hour.variance < 0 }"><apex:param value="{!(-1)*hour.variance}" /></apex:outputText>
            </td>
        </tr>
        </apex:repeat>   
        <tr><td colspan="6" class="totalgray bord">&nbsp;</td></tr>
        <tr class="totalgray">
            <td><b>Total</b></td>
            <td class="right"><b><apex:outputText value="{0,number,#,###,##0.00}"><apex:param value="{!report.totDealHours}" /></apex:outputText></b></td>
            <td class="right"><b><apex:outputText value="{0,number,#,###,##0.00}"><apex:param value="{!report.totDevHours}" /></apex:outputText></b></td>
            <td class="right"><b><apex:outputText value="{0,number,#,###,##0.00}"><apex:param value="{!report.totTotalHours}" /></apex:outputText></b></td>
            <td class="right"><b><apex:outputText value="{0,number,#,###,##0.00}"><apex:param value="{!report.totAverageUsage}" /></apex:outputText></b></td>
            <td class="right"><b>
                <apex:outputText value="{0,number,#,###,##0.00}" rendered="{!report.totVariance>=0}"><apex:param value="{!report.totVariance}" /></apex:outputText>
                <apex:outputText value="({0,number,#,###,##0.00})" rendered="{!report.totVariance<0}"><apex:param value="{!(-1)*report.totVariance}" /></apex:outputText></b>
            </td>
        </tr>
    </table>
</apex:repeat>
</body>
</apex:page>