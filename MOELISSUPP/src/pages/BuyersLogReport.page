<apex:page controller="buyersLogReport_Controller">
 	<apex:form >
		<apex:commandButton action="{!toPDF}" value="Export to PDF"/>
		<br/><br/><br/>

		<apex:outputPanel rendered="{!ISNULL(DealIdStr)}">
			<apex:selectList size="1" multiselect="false" value="{!lProjectList}" >
				<apex:selectOptions value="{!ProjectListItems}"/>
				<apex:actionSupport event="onchange" rerender="theTable" status="status"/>
			</apex:selectList>
			&nbsp;&nbsp;
			<apex:actionstatus id="status" startText="processing..." stopText="" />
			<br/><br/><br/>
		</apex:outputPanel>
		
<apex:outputPanel id="theTable">
	<span style="font-size:25px"><b>Buyers Log for Project:&nbsp;&nbsp;{!DealName}</b></span>
	<br/><br/>


	<table id="mainTable" cellpadding="0" cellspacing="0" style="border:1px solid black;border-bottom:0px solid black;border-left:0px solid black;">
		<tr style="color:#333399;">
			<td align="center" style="color:white;background-color:#333399;vertical-align:top;border:0px solid black;border-bottom:1px solid black;border-left:1px solid black;padding:2px;"><b>Target&nbsp;Name</b></td>
			<td align="center" style="color:white;background-color:#333399;vertical-align:top;border:0px solid black;border-bottom:1px solid black;border-left:1px solid black;padding:2px;"><b>Target&nbsp;Professionals</b></td>
			<td align="center" style="color:white;background-color:#333399;vertical-align:top;border:0px solid black;border-bottom:1px solid black;border-left:1px solid black;padding:2px;"><b>Target&nbsp;Type</b></td> 
			<td align="center" style="color:white;background-color:#333399;vertical-align:top;border:0px solid black;border-bottom:1px solid black;border-left:1px solid black;padding:2px;"><b>Target&nbsp;Buyers&nbsp;Resource</b></td>
			<td align="center" style="color:white;background-color:#333399;vertical-align:top;border:0px solid black;border-bottom:1px solid black;border-left:1px solid black;padding:2px;"><b>Milestones</b></td>
			<td align="center" style="color:white;background-color:#333399;vertical-align:top;border:0px solid black;border-bottom:1px solid black;border-left:1px solid black;padding:2px;"><b>Activity&nbsp;Logs</b></td>
		</tr>
		<apex:repeat value="{!TargetBuyersList}" var="JA">
			<tr>
				<td style="vertical-align:top;border:0px solid black;border-bottom:1px solid black;border-left:1px solid black;padding:2px;">{!JA.targetName}</td>
				<td style="vertical-align:top;border:0px solid black;border-bottom:1px solid black;border-left:1px solid black;padding:2px;">
					<apex:repeat value="{!JA.targetProfessionals}" var="prof">
						<apex:outputText value="{!prof.fullName}" escape="false" />
						<apex:outputText value="{!prof.title}" escape="false" />
						<apex:outputText value="{!prof.street}" escape="false" />
						<apex:outputText value="{!prof.city_state_pcode}" escape="false" />
						<apex:outputText value="{!prof.country}" escape="false" />
						<apex:outputText value="{!prof.phone}" escape="false" />
						<apex:outputText value="{!prof.fax}" escape="false" />
						<apex:outputText value="{!prof.mobilePhone}" escape="false" />
						<apex:outputText value="{!prof.email}" escape="false" />
						<br/>
						<br/>
						<br/>
					</apex:repeat>
				</td>
				<td style="vertical-align:top;border:0px solid black;border-bottom:1px solid black;border-left:1px solid black;padding:2px;">{!JA.targetType}</td>
				<td style="vertical-align:top;border:0px solid black;border-bottom:1px solid black;border-left:1px solid black;padding:2px;">
					<apex:repeat value="{!JA.responsibleUsers}" var="prof">
						<apex:outputText value="{!prof.role}"           escape="false" /> 
						<apex:outputText value="{!prof.fullName}"       escape="false" />
						<apex:outputText value="{!prof.officeLocation}" escape="false" />
						<apex:outputText value="{!prof.phone}"          escape="false" />
						<br/>
						<br/>
						<br/>
					</apex:repeat>
				</td>
				<td style="vertical-align:top;border:0px solid black;border-bottom:1px solid black;border-left:1px solid black;padding:2px;">
					<apex:outputText value="{!JA.ContactMade}" escape="false" />
					<apex:outputText value="{!JA.TeaserSent}" escape="false" />
					<apex:outputText value="{!JA.CASent}" escape="false" />
					<apex:outputText value="{!JA.CAStatus}" escape="false" />
					<apex:outputText value="{!JA.CIMSent}" escape="false" />
					<apex:outputText value="{!JA.CIMNumber}" escape="false" />
					<apex:outputText value="{!JA.InitialBid}" escape="false" />
					<apex:outputText value="{!JA.FinalBid}" escape="false" />
					<apex:outputText value="{!JA.Declined}" escape="false" />
				</td>
				<td style="vertical-align:top;border:0px solid black;border-bottom:1px solid black;border-left:1px solid black;padding:2px;">
					<apex:repeat value="{!JA.acivityLogs}" var="logs">
						<apex:outputText value="{!logs.actDateTime}" escape="false" />
<!-- 						<apex:outputText value="{!logs.actType}" escape="false" /> -->
						<apex:outputText value="{!logs.actSubject}" escape="false" />
						<apex:outputText value="{!logs.actNotes}" escape="false" />
						<br/>
					</apex:repeat>
				</td>
			</tr>
		</apex:repeat>
	</table>

</apex:outputPanel>
<!--  		<apex:include pageName="BuyersLogReport_Included"/>  -->
 	</apex:form>
</apex:page>