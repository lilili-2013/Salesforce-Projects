<apex:page id="thePage" showHeader="false" controller="SL_SeniorBankerScorecard_Dashboard" >


<apex:form id="theForm" target="_blank" onsubmit="return checkDatas();">
	<apex:pageBlock id="theBlock"  title="Senior Banker Scorecard" mode="detail">
		<apex:pageBlockSection id="theBlockS" columns="1">
		
		<apex:pageMessages />
		
		<apex:pageBlockSectionItem id="filterBlockSI">
			<apex:outputLabel value="Filter by"/>
			<apex:selectList onchange="changeFilter(this.value)" value="{!Filter}" size="1" id="filter">
				<apex:selectOptions value="{!FilterItems}"/>            
			</apex:selectList> 
        </apex:pageBlockSectionItem>
		 <apex:pageBlockSectionItem id="subfilterBlockSI">
			<apex:outputLabel value=""/>
			<apex:selectList id="subfilter" value="{!SubFilters}" size="5" multiselect="true" > 
			     <apex:selectOptions value="{!SubFilterItems}"/>
			</apex:selectList> 
        </apex:pageBlockSectionItem>
		<apex:pageBlockSectionItem id="sDateBlockSI">
              <apex:outputLabel value="Start Date"/>
              <apex:inputField value="{!tmpObj.Start_Date__c}" id="sDate"/> 
        </apex:pageBlockSectionItem>
		<apex:pageBlockSectionItem id="eDateBlockSI">
              <apex:outputLabel value="End Date"/>
              <apex:inputField value="{!tmpObj.End_Date__c}" id="eDate"/> 
        </apex:pageBlockSectionItem>
<script>
function checkDatas()
{
	var isError = false;
	var filter = document.getElementById("thePage:theForm:theBlock:theBlockS:filterBlockSI:filter").value;
	var subfilter = document.getElementById("thePage:theForm:theBlock:theBlockS:subfilterBlockSI:subfilter").value;
	var sDate = document.getElementById("thePage:theForm:theBlock:theBlockS:sDateBlockSI:sDate").value;
	var eDate = document.getElementById("thePage:theForm:theBlock:theBlockS:eDateBlockSI:eDate").value;
	if(filter != '' && subfilter != '' && sDate != '' && eDate != '' &&  sDate != eDate)
	{
	    if (Date.parse(sDate) > Date.parse(eDate)) {
			alert('End Date must be later than Start Date. Both End Date and Start Date must be <= TODAY.')
			return false;
		}
	}
	else 
	{
		alert('All Filters should be selected. End Date must be later than Start Date. Both End Date and Start Date must be <= TODAY.');
		return false;
	}
	return true;
}
</script>		
		<apex:commandButton action="{!run}" value="Run Report" />
		
		</apex:pageBlockSection> 
		
	</apex:pageBlock>
</apex:form>


<apex:form >
    <apex:actionFunction action="{!changeFilter}" immediate="true" name="changeFilter" reRender="subfilter" status="MCSub">
        <apex:param name="p1" assignTo="{!Filter}" value="" />
    </apex:actionFunction>
</apex:form>
</apex:page>