<apex:page showHeader="false" sidebar="false" standardStylesheets="false" controller="SL_ctrl_VendorInactiveTemplate">
	<meta http-equiv="content-type" content="text/html; charset=utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1" />
	<!-- Start of including all necessary css and js files -->
    <apex:stylesheet value="{!URLFOR($Resource.SL_VendorCommunity,'css/bootstrap.min.css')}"/>
	<apex:stylesheet value="{!URLFOR($Resource.SL_VendorCommunity,'css/bootstrap-theme.min.css')}"/>
	<style type="text/css">
		.container{
			padding-right: 0px;
			padding-left: 0px;
		}
		.container-main{
			min-height: 100%;
			min-width: 100%;
			background: {!loginBkgrdColor};
			font-family: {!fontName};
			color: {!fontColor};
		}
		.container-content{
			border-radius: 6px;
			width: 65%;
			margin: 0 auto;
			height: 350px;
			-moz-box-shadow: 3px 3px 4px #A1A1A1;
			-webkit-box-shadow: 3px 3px 4px #A1A1A1;
			box-shadow: 3px 3px 4px #A1A1A1;
			-ms-filter: "progid:DXImageTransform.Microsoft.Shadow(Strength=4, Direction=135, Color='#A1A1A1')";
			filter: progid:DXImageTransform.Microsoft.Shadow(Strength=4, Direction=135, Color='#A1A1A1');
			background: {!loginPrimaryColor};
		}
		#forgotPasswordContainer{
			border-radius: 6px;
			border: 1px solid #A1A1A1;
			width: 95%;
			margin: 0 auto;
			background-color: #FFF;			
		}
		.form-group{
			margin: 5px auto;
		}
		.login-input{
			width: 200px;
		}
		.forgot-password-input, .form-control{
			display: inline;
			width: 200px;
		}
		.vertical-center {
		  	min-height: 100%;  /* Fallback for browsers do NOT support vh unit */
		  	min-height: 100vh; /* These two lines are counted as one :-)       */
		  	display: flex;
		  	align-items: center;
		  	margin-bottom: 0px;
		  	background-color: {!loginBkgrdColor};
		}
		.login-btn{
			margin: 10px auto;
			border: none;
			text-shadow: none;
			color: {!loginBtnFontColor};
			background:	{!loginBtnColor};
		}
		#loginFormContainer, .logo-div{
			text-align: center;
		}
		.logo-div{
			margin-top: 10px;
		}
		#forgot-password-inputs{
			margin: 5px auto;
			padding-left: 10px;
		}
		#change-password-inputs{
			margin: 5px auto; 
			padding: 0px 10px;
		}
		#helpText, .change-password-form-group{
			padding: 5px 10px 0px;
			margin: 0 auto;
		}
		#forgot-continue{
			width: 125px; 
		}
		html, body{
		    height: 100%;
		    width: 100%
		}
	</style>
	<script type="text/javascript">
		var SL_LoginUtil = function () {
		
			//This will store the current page url and will replace the http:// with https://.
			var currentUrl = window.location.href;//getting current page url.
           	if(currentUrl.indexOf('://') == 4)
           	{
           		currentUrl = currentUrl.replace('http://', 'https://')//Replacing http:// with https:// to pass the forceSSL.
           		window.open(currentUrl, '_self');
           	}
				       
			//This method will call onclick of login button on login page.	                	
			var validateData = function(){
			
				var errorDivId = document.getElementById("errorTextId");
            	document.getElementById('{!$Component.loginPage.loginForm.username}').style.borderColor = " rgb(179, 180, 180)";
            	document.getElementById('{!$Component.loginPage.loginForm.password}').style.borderColor = " rgb(179, 180, 180)";
            	
            	document.getElementById("errorTextId").innerHTML = '';
            	
            	if(document.getElementById('{!$Component.loginPage.loginForm.username}').value.trim() == '')
                {
                	errorDivId.style.visibility = "visible";
                	document.getElementById('{!$Component.loginPage.loginForm.username}').style.borderColor = "rgb(149, 59, 57)";
                    errorDivId.innerHTML = '<span style="color:red;" class="help-inline active"><i class="fa fa-exclamation-triangle fa-1x"></i> Please enter username.</span>';
                    return false;
                }
                else if(document.getElementById('{!$Component.loginPage.loginForm.password}').value == '')
                {   
                	errorDivId.style.visibility = "visible";
                	document.getElementById('{!$Component.loginPage.loginForm.password}').style.borderColor = "rgb(149, 59, 57)";
                    errorDivId.innerHTML = '<span style="color:red;" class="help-inline active"><i class="fa fa-exclamation-triangle fa-1x"></i>Please enter password.</span>';
                    return false;
                }
				                        
           		doLogin();                      
            	return true;
			}
			
			var doLoginIntoCommunity = function(e) {
				
			 if(e.keyCode == 13) 
      			{
      				validateData();	
   				}
				
			}
			
			var validateIfEnterPress = function(e) {
			 	if(e.keyCode == 13) 
      			{
      				validateDataForgotPasswordPage();	
   				}
				return false;
			}
			
			//This method is to show error message on Login page.
			var showErrorMessage = function() {
			
				$('#errorTextId').css('visibility', 'visible');
               	$('[id$="username"]}').css("borderColor", "rgb(149, 59, 57)");
               	$('[id$="password"]}').css("borderColor", "rgb(149, 59, 57)");
                $('#errorTextId').html('<span style="color:red;" class="help-inline active"><i class="fa fa-exclamation-triangle fa-1x"></i> The username or password you entered is incorrect.</span>');
			}
			
			//This method is use to show the error message on forgot password page.
			var showError = function() {
				$('#errorTextId').css('visibility', 'visible');
               	$('#errorTextId').html('*Please enter the correct username.');
			}
			
			//This method is use to validate data onclick of submit button in forgot password page.
			var validateDataForgotPasswordPage = function() {
				var errorDiv = $("#errorTextId"),
					regex = /^([a-zA-Z0-9_.+-])+\@(([a-zA-Z0-9-])+\.)+([a-zA-Z0-9]{2,4})+$/;
               	$(errorDiv).html('');
                    	
            	if($('#username').val() == '' || !(regex.test($('#username').val())))
                {
                   	$(errorDiv).css('visibility', 'visible');
	                $(errorDiv).html('*Please enter a valid username');
                    return false;
                }
                   
   				SL_ctrl_VendorForgotPassword.sendPasswordEmail(
					$('#username').val(),
					function(results, event) {
				        if(event.type === 'exception'){
				            console.log("exception");
				            console.log(event);
				        }else if(event.status){
				            if(results == true){
								showSuccessMessage();
							}
				        }else{
				            console.log(event.message);
				        }
				    }
				);
			
			}
			var validateChangePasswordData = function(){
				var errorDiv = $("#errorTextId"),
					regex = /^(?=.*\d)[a-zA-Z0-9]{8,}$/;
               	$(errorDiv).html('');
                    	
            	if($('#newPassword').val() == '' || !(regex.test($('#newPassword').val())))
                {
                   	$(errorDiv).css('visibility', 'visible');
	                $(errorDiv).html('*Password is not 8 characters long or does not contain both numbers and characters');
                    return false;
                }

                if($('#newPassword').val() != $('#verifyPassword').val())
                {
                   	$(errorDiv).css('visibility', 'visible');
	                $(errorDiv).html('*Passwords do not match');
                    return false;
                }
                   
   				SL_ctrl_VendorChangePassword.changePassword(
					$('#newPassword').val(),
					$('#verifyPassword').val(),
					function(results, event){
						if(results.success === false){
				            console.log("exception");
				            console.log(results.message);
							$(errorDiv).css('visibility', 'visible');
				            $(errorDiv).html(results.message);    
				        }else if(results.success === true){
				            window.location.replace(results.message);
				        }else{
				            console.log(results.message);
				        }
					}
				);
			}
			var borderColorChangeOnError = function(strFieldName,strColor,strErrorMsg)
            {
              	$('#errorTextId').css('visibility', 'visible');
              	$('#errorTextId').htlm('<span style="color:red;" class="help-inline active"><i class="fa fa-exclamation-triangle fa-1x"></i> '+strErrorMsg+'</span>');
              	if(strFieldName != ''){
              		$('#'+strFieldName).css("borderColor", strColor);
              		$('#'+strFieldName).focus();              	}
            }              
            var borderErrorColorRemove = function()
            {
              	$('input').each(function(){
              		if($(this).attr('type').toLowerCase() == 'text' || $(this).attr('type').toLowerCase() == 'password'){
              			$(this).css('borderColor', 'rgb(179, 180, 180)')
              		}
              	})
            }
            var showSuccessMessage = function()
            {
            	$('[id$="forgotPasswordForm"]').hide();
            	$('#emailSent').show();
            }
						                    
			return {
				
				validateData:validateData,
				showErrorMessage:showErrorMessage,
				validateDataForgotPasswordPage:validateDataForgotPasswordPage,
				showError:showError,
				doLoginIntoCommunity:doLoginIntoCommunity,
				validateIfEnterPress:validateIfEnterPress,
				showSuccessMessage:showSuccessMessage,
				validateChangePasswordData:validateChangePasswordData
			}
		
        }();
        
        if(window.onload)
        {
        	SL_LoginUtil();
        }
	</script>
	
	<apex:includeScript value="{!URLFOR($Resource.SL_VendorCommunity,'js/jquery.min.js')}"/>
	<apex:includeScript value="{!URLFOR($Resource.SL_VendorCommunity,'js/bootstrap.min.js')}"/>
    <!-- End of including all necessary css and js files -->
	
    <div class="container container-main">
		<div class="jumbotron vertical-center">
			<!-- Start of main section -->
		  	<div class="container container-content">
	  			<apex:insert name="mainSection"/>			  		
		  	</div>
			<!-- End of main section -->

			<!-- Start of footer section -->
			<!-- <div class="container container-footer">
				<apex:insert name="footer">
					<c:SL_VendorFooter />
				</apex:insert>
			</div> -->
			<!-- End of footer section -->		
		</div>
	</div>
</apex:page>