<apex:page controller="AnnualGoalsDashboardDataController" docType="html-5.0" sidebar="false" showHeader="true">
    <apex:includeScript value="https://ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"/>
    <apex:includeScript value="{!URLFOR($Resource.BTG_Resources, 'bootstrap-3.0.2/js/bootstrap.min.js')}"/>
    <apex:stylesheet value="{!URLFOR($Resource.BTG_Resources, 'bootstrap-3.0.2/css/bootstrap-btg-force.css')}"/>
    
    <style>
        .overlay {position: fixed; top: 0; left: 0; height: 100%; width: 100%; z-index: 10; background-color: rgba(0,0,0,0.5);}
        .white-box{width: 300px; height: 110px; position: fixed; top: 50%; left: 50%; margin-top: -100px; margin-left: -150px; background-color: #FFFFFF; border-radius: 5px; text-align: center; z-index: 11;}
        .white-box img{width: 75px;}
        #loadingLabel{font-weight: bold; font-size: 25px;}
    </style>
    <div id="overlay" style="display: none;">
        <div class="overlay">
        </div>
        <div class="white-box">
            <div style="padding: 42px 0px;">
                <span id="loadingLabel">Loading</span>
            </div>
        </div>
    </div>
    <apex:form >
        <div class="btg-force">
        
            <div class="row">
                <div class="col-md-12">
                    <div class="name-header-container clearfix">
                        <div class="pull-left">
                            <h1 class="name-header">Business Dashboard Data</h1>  
                        </div>
                        <div class="pull-left" style="margin-left: 8px; margin-top: 15px;">
                            <apex:selectList id="userList" value="{!userId}" multiselect="false" size="1" style="width: 200px;" rendered="{!IsManager}">
                                 <apex:selectoptions value="{!UserOptions}" />
                                 <apex:actionsupport event="onchange" rerender="data" action="{!userListOnChange}" onsubmit="displayOverlay();" oncomplete="hideOverlay();" />
                             </apex:selectList>
                        </div>
                    </div>
                </div>
            </div> <!-- row -->
            <apex:outputPanel id="data" >
                <div class="row" style="margin-top: 20px;">
                    <div class="col-sm-12 col-lg-6">
                        <table class="table table-bordered table-striped">
                            <thead>
                                <tr>
                                    <th>
                                        Schedule
                                    </th>
                                    <th>
                                        FMA
                                    </th>
                                    <th>
                                        FMV
                                    </th>
                                    <th>
                                        CSC
                                    </th>
                                </tr>
                            </thead>
                            <tbody>
                                <apex:repeat value="{!ScheduleSummaries}" var="s">
                                    <tr>
                                        <td>
                                            <a href="/{!s.id}">{!s.name}</a>
                                        </td>
                                        <td class="text-right">
                                            <apex:outputText value="${0,number,###,###,###,##0.00}">
                                                <apex:param value="{!s.fma}"/>
                                            </apex:outputText>
                                        </td>
                                        <td class="text-right">
                                            <apex:outputText value="${0,number,###,###,###,##0.00}">
                                                <apex:param value="{!s.fmv}"/>
                                            </apex:outputText>
                                        </td>
                                        <td class="text-right">
                                            <apex:outputText value="${0,number,###,###,###,##0.00}">
                                                <apex:param value="{!s.csc}"/>
                                            </apex:outputText>
                                        </td>
                                    </tr>
                                </apex:repeat>
                                <tr>
                                    <td class="text-right">
                                        <strong>Total: </strong>&nbsp;&nbsp;&nbsp;&nbsp;
                                        <apex:outputText value="${0,number,###,###,###,##0.00}">
                                            <apex:param value="{!total}"/>
                                        </apex:outputText>
                                    </td>
                                    <td class="text-right">
                                        <apex:outputText value="${0,number,###,###,###,##0.00}">
                                            <apex:param value="{!fmaTotal}"/>
                                        </apex:outputText>
                                    </td>
                                     <td class="text-right">
                                         <apex:outputText value="${0,number,###,###,###,##0.00}">
                                             <apex:param value="{!fmvTotal}"/>
                                         </apex:outputText>
                                    </td>
                                    <td class="text-right">
                                        <apex:outputText value="${0,number,###,###,###,##0.00}">
                                            <apex:param value="{!cscTotal}"/>
                                        </apex:outputText>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </apex:outputPanel>
       </div>
    </apex:form>
    <script type="text/javascript">
        function displayOverlay()
        {
            $("#overlay").attr('style','display: block;');
        }
    
        function hideOverlay()
        {   
            $("#overlay").attr('style','display: none;');
        }
   </script>
</apex:page>