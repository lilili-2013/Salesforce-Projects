<!-- 
* @PageName      : SL_EnhancedContactRelatedList.
* @Ticket No.    : NPD-85.
* @CreatedOn     : 30/July/2015
* @CreatedBy     : Sandeep
* @Description   : This page will display the contact list
-->
<apex:page standardController="Account" extensions="SL_EnhancedContactRelatedListCtrl" sidebar="false" showHeader="false">
    <apex:form id="frm">
        <apex:stylesheet value="{!URLFOR($Resource.SL_EnhancedContactRelatedList, 'css/jquery.dataTables.min.css')}"/>
        <apex:includeScript value="{!URLFOR($Resource.SL_EnhancedContactRelatedList, 'js/jquery-1.11.3.min.js')}"/>
        <apex:includeScript value="{!URLFOR($Resource.SL_EnhancedContactRelatedList, 'js/jquery.dataTables.min.js')}"/>
        
        <style>
            table.dataTable thead .sorting_asc {
            background: url("{!URLFOR($Resource.SL_EnhancedContactRelatedList, 'images/sort_asc.png')}") no-repeat center left;
            }
            table.dataTable thead .sorting_desc {
            background: url("{!URLFOR($Resource.SL_EnhancedContactRelatedList, 'images/sort_desc.png')}") no-repeat center left;
            }
            table.dataTable thead .sorting {
            background: url("{!URLFOR($Resource.SL_EnhancedContactRelatedList, 'images/sort_both.png')}") no-repeat center left;
            }
            .se-pre-con {
            position: fixed;
            left: 0px;
            top: 0px;
            width: 100%;
            height: 100%;
            z-index: 9999;
            background: url({!URLFOR($Resource.SL_EnhancedContactRelatedList, '/images/loader.gif')}) center no-repeat #fff;
            }
        </style>
        <apex:actionFunction action="{!delContactRecord}" name="delContactAF" rerender="frm" status="counterStatus">
            <apex:param name="contactId" value="" assignTo="{!idSelectedContactId}"/>
        </apex:actionFunction>
        <div class="se-pre-con"></div>
        <div style="height:400px;overflow:auto;">
            <table id="contactTableID" class="display" cellspacing="0" width="100%">
                <thead style="background-color:#F5F5F5">
                    <tr>
                        <th style="background-image:none;"></th>
                        <th>Name</th>
                        <th>Practice</th>
                        <apex:repeat value="{!$ObjectType.Contact.FieldSets.SL_EnhancedContact}" var="fs">
                        <th>
                            {!fs.Label}
                        </th>
                        </apex:repeat>
                    </tr>
                </thead>
                 <tbody>
                    <apex:repeat value="{!mapContactIdToContactWrapper}" var="key">
                    <tr>
                        <td><a href="/{!mapContactIdToContactWrapper[key].objContact.Id}" target="_top">View</a> | 
                            <a href="/{!mapContactIdToContactWrapper[key].objContact.Id}/e" target="_top">Edit</a> | 
                            <apex:outputLink value="javascript:if (window.confirm('Are you sure?')) delContactAF('{!mapContactIdToContactWrapper[key].objContact.id}');"> Del
                            </apex:outputLink>
                        </td>
                        <td>
                            <a href="/{!mapContactIdToContactWrapper[key].objContact.Id}" target="_top">
                                <apex:outputField value="{!mapContactIdToContactWrapper[key].objContact.Name}"></apex:outputField>
                            </a>
                        </td>
                        <td>
                            <apex:outputText value="{!mapContactIdToContactWrapper[key].strName}"/>
                        </td>
                        <apex:repeat value="{!$ObjectType.Contact.FieldSets.SL_EnhancedContact}" var="fs">
                        <td class="tdClass">
                            <apex:outputField value="{!mapContactIdToContactWrapper[key].objContact[fs]}">
                            </apex:outputField>
                        </td>
                        </apex:repeat>
                    </tr>
                   </apex:repeat>
                </tbody>
            </table>
        </div>
        <script>
            $(".se-pre-con").fadeOut("slow");
            
            $(document).ready(function() {
                var oTable =$('#contactTableID').DataTable({
                        "columnDefs": [ { //remove the sortable from first column
                          "targets": 0,
                          "orderable": false
                    }]
                });
             });
        </script>
        <!--Action status for loading symbol-->
        <apex:actionstatus id="counterStatus">
            <apex:facet name="start">
                <div class="waitingSearchDiv" id="el_loading" style="background-color: #fbfbfb; height:100%;opacity:0.65;width:100%;">
                    <div class="waitingHolder" style="top: 100px; width: 91px;">
                    <img class="waitingImage" src="{!URLFOR($Resource.SL_EnhancedContactRelatedList, '/images/loader.gif')}" title="Please Wait..." />
                    <span class="waitingDescription">Loading...</span>
                    </div>
                </div>
            </apex:facet>
        </apex:actionstatus>
    </apex:form>
</apex:page>