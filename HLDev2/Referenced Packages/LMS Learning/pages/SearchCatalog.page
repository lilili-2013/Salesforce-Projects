<apex:page controller="lmscons.SearchCatalog" showHeader="false" sideBar="false">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>{!$Label.SearchCatalog_Title}</title>
<apex:includeScript value="{!URLFOR($Resource.lmscons__LMSSearch, 'js/jquery.js')}"/>
<apex:includeScript value="{!URLFOR($Resource.lmscons__LMSSearch, 'js/lightbox.js')}"/>
<apex:includeScript value="{!URLFOR($Resource.lmscons__LMSSearch, 'js/lightbox.js')}"/>
<apex:stylesheet value="{!URLFOR($Resource.lmscons__LMSSearch, 'css/search-catalog.css')}"/>
<apex:stylesheet value="{!URLFOR($Resource.lmscons__LMSSearch, 'css/lms-lightbox.css')}"/>
<apex:includeScript value="{!URLFOR($Resource.lmscons__jquery152min)}" />
<link rel="stylesheet" type="text/css" href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.16/themes/base/jquery-ui.css" />

<style>
	pre {
		font-family: Arial,Helvetica,sans-serif;
		white-space: pre-wrap;
		word-wrap: break-word;
	}

	.hideElement {
        display:none;
    }
</style>

<script type="text/javascript">
	var overlay;
	var lightbox;

	var isenroll = 0;

	jQuery.noConflict();

	InitPage();
	InitLightbox();

	jQuery(document).ready(function() {
		//jQuery('[id$="DueDateId"]').val('').parent().hide();
		overlay = jQuery('.b-overlay');
		lightbox = jQuery('.b-lightbox');

		jQuery.fn.center = function(parent) {
			if (parent) {
				parent = this.parent();
			}
			else {
				parent = window;
			}
			this.css({
				"position": "absolute",
				"top": (((jQuery(parent).height() - this.outerHeight()) / 3) + jQuery(parent).scrollTop() + "px")
			});
			return this;
		}
	});

	function closepopup() {
		//window.opener.closesearch();
		parent.closesearch();
	}

	function showDueDate(){
		jQuery('[id$="DueDateId"]').parent().toggle();
	}

	function Lightbox(){
		jQuery('[id$="DueDateId"]').val('').parent().hide();
		jQuery('[id*=selectall]').attr('checked', false);

		lightbox.fadeIn('fast');
		overlay
			.height( 1000 )
			.css('opacity','0.6')
			.fadeIn('fast');
		jQuery(".b-lightbox").center();
		return false;
	}

	function Closelightbox(){
		lightbox.fadeOut('fast');
		overlay.fadeOut('fast');
	}

	function handleKeyPress(e) {
		var eventInstance = window.event ? event : e;
		var keyCode = eventInstance.charCode ? eventInstance.charCode : eventInstance.keyCode;
		if (keyCode == 13){
			dosearch();
			return false;
		}
	}

	function AssignTraining(asgn, tp, isConsumerUser) {
		if (isConsumerUser == 'true') {
			overlay = jQuery('.b-overlay');
			lightbox = jQuery('.b-lightbox');
			assign_train(asgn, tp);
		}
		else {
			notConsumerUser();
		}
	}

	function EnrollContent(asgn, tp) {
		enroll_content(asgn, tp);
	}

	function init_page() {
		InitPage();
		//InitLightbox();
	}

	function InitPage() {

		jQuery(document).ready(function(){
			jQuery('.m-tbl td:empty').html('&nbsp;');
			SearchToggler();
			HideShowRowsToggler();
			SetColspan();
			SafariFix();
		});
	}

	function SafariFix(){
		/* safari fix */
		if (navigator.userAgent.indexOf('Safari') != -1 && navigator.userAgent.indexOf('Chrome') == -1) {
			jQuery('body').addClass('m-safari');
		}

		/* mac fix */
		if((navigator.platform.indexOf("Mac") != -1)) {
			jQuery('body').addClass('m-mac').removeClass('m-safari');
		}
	}

	function SetColspan() {
		jQuery('.b-search-catalog .m-tbl').each(function(i) {
			var CountTd = jQuery(this).find('th').size();
			jQuery('.b-search-catalog').eq(i).find('.b-inner').attr('colspan', CountTd);
		});
	}

	/* Login Toggler */
	function SearchToggler(){
	//jQuery('.b-search .b-advanced-box').hide();
	//jQuery('.b-search .b-advanced-link .m-toggle-link').click(function(){
	//   jQuery('.b-search .b-advanced-link .m-toggle-link').toggleClass('m-open');
	//   jQuery('.b-search .b-advanced-box').toggle();
	//});
	}

	/* Hide/Show toggler */
	function HideShowRowsToggler() {
		jQuery('.m-hide').hide();

		jQuery('.b-title.m-plus').click(function () {
			jQuery(this).toggleClass('m-minus');
			jQuery(this).next('.m-hide').toggle();
			jQuery(this).parent().parent('tr').next('tr').toggle();
		});
	}
</script>
</head>
<body>
<apex:outputpanel id="whole">
	<apex:actionStatus id="while_assign" onstop="Lightbox()">
		<apex:facet name="start">
			<c:EnhancedActionStatus BackColor="#efefef" borderColor="#336699" borderSize="1" height="50px" width="120px" ImageUrl="/img/loading.gif" Message="{!$Label.Consumer_Global_Loading}..." messageStyle="color:darkred;font-size:11pt;font-weight:bold;"/>
		</apex:facet>
	</apex:actionStatus>

	<apex:actionStatus id="status2">
		<apex:facet name="start">
			<c:EnhancedActionStatus BackColor="#efefef" borderColor="#336699" borderSize="1" height="50px" width="120px" ImageUrl="/img/loading.gif" Message="{!$Label.Consumer_Global_Loading}..." messageStyle="color:darkred;font-size:11pt;font-weight:bold;"/>
		</apex:facet>
	</apex:actionStatus>

	<div class="h-base">
		<br/>
		<apex:form id="frm">
			<apex:pageMessages id="messages" ></apex:pageMessages>
			<div class="l-content">
				<div class="b-search-catalog">
					<div class="b-search">
						<div class="m-cfix">
							<div class="b-search-controls">
								<apex:inputText id="SearchKeyWord" value="{!searchKeyWord}" maxlength="200" style="width:400px;font-size:8pt" onkeypress="return handleKeyPress(event)"></apex:inputText>
								<apex:actionFunction name="dosearch" action="{!SearchInCatalog}" oncomplete="init_page()" status="loadStatus" reRender="whole" />
								<apex:actionFunction name="ToggleSearch" action="{!ToggleSearch}" oncomplete="init_page()" status="loadStatus" reRender="whole" />
								<apex:actionFunction name="SortCol" action="{!SortCol}" oncomplete="init_page()" status="loadStatus" reRender="whole">
									<apex:param name="snd1" value="" assignTo="{!SortColumnNumber}"/>
								</apex:actionFunction>
								<a class="b-btn" href="JavaScript:dosearch()"><span class="b-icon">&nbsp;</span>{!$Label.ConsumerUser_value_Search}</a>
								<apex:actionStatus id="loadStatus">
									<apex:facet name="start">
										<apex:image url="/img/loading.gif" />
									</apex:facet>
								</apex:actionStatus>
							</div>
							<div class="b-checkbox">
								<apex:inputCheckbox value="{!Search_Description}"/>
								<label for="description">{!$Label.SearchCatalog_Search_Description}</label>
							</div>
							<div class="b-advanced-link">
								<a href="javascript:ToggleSearch()" class="m-toggle-link">{!$Label.SearchCatalog_Advanced_Search}</a>
							</div>
						</div>
						<apex:outputPanel layout="block" styleclass="b-advanced-box" rendered="{!AdvancedSearch = true}">
							<div class="b-box">
								<apex:outputLabel value="{!$Label.SearchCatalog_SelectCatalog}" />&nbsp;&nbsp;
								<apex:selectList value="{!CatalogId}" multiselect="false" size="1" style="width: 100px;">
									<apex:selectOptions value="{!CatalogSelectOptions}"/>
								</apex:selectList>
							</div>
							<div class="b-box">
								<apex:inputCheckbox value="{!Search_Quiz}"/>
								<label for="option0">{!$Label.Quizzes}</label>&nbsp;
							</div>
							<div class="b-box">
								<apex:inputCheckbox value="{!Search_Module}"/>
								<label for="option1">{!$Label.SearchCatalog_Modules}</label>&nbsp;
							</div>
							<div class="b-box">
								<apex:inputCheckbox value="{!Search_Course}"/>
								<label for="option2">{!$Label.SearchCatalog_Courses}</label>
							</div>
							<div class="b-box">
								<apex:inputCheckbox value="{!Search_LP}"/>
								<label for="option3">{!$Label.SearchCatalog_LearningPaths}</label>&nbsp;
							</div>
							<div class="b-box">
								<apex:inputCheckbox value="{!Search_Curr}"/>
								<label for="option4">{!$Label.SearchCatalog_Curriculums}</label>
							</div>
						</apex:outputPanel>
					</div>
					<apex:outputpanel layout="block" rendered="{!SearchItem.size = 0}"><br/>{!$Label.No_results_found_Please_search_again}</apex:outputpanel>
					<div class="b-results">
						<apex:outputpanel id="b1" layout="none" rendered="{!SearchItem.size > 0}">
							<table width="100%" cellpadding="0" cellspacing="0" class="m-tbl">
								<thead>
									<tr>
										<th class="m-td-title"><a href="JavaScript:SortCol('1');" class="{!IF(SortColumnNumber == '1' && AscDesc == true, 'm-sort2', '')}{!IF(SortColumnNumber == '1' && AscDesc == false, 'm-sort1', '')}">{!$Label.SearchCatalog_Column_Title}</a></th>
										<th class="m-td-descr"><a href="JavaScript:SortCol('2');" class="{!IF(SortColumnNumber == '2' && AscDesc == true, 'm-sort2', '')}{!IF(SortColumnNumber == '2' && AscDesc == false, 'm-sort1', '')}">{!$Label.SearchCatalog_Column_Description}</a></th>
										<th class="m-td-type">{!$Label.SearchCatalog_Column_Type}</th>
										<th class="m-td-btns m-count">{!SearchItem.size} {!$Label.SearchCatalog_Column_Results}</th>
									</tr>
								</thead>
								<tbody>
									<apex:repeat value="{!SearchItem}" var="s" id="rep">
									<!-------------------------- MODULES ---------------------------------->
										<apex:outputpanel rendered="{!s.Type = 'Module'}" layout="none">
											<tr>
												<td class="m-td-title"><div class="b-title">{!s.Module.Title}</div></td>
												<td class="m-td-descr"><pre><apex:outputText value="{!s.Module.Description}"/>&nbsp;&nbsp;</pre></td>
												<td class="m-td-type">{!s.Module.Type}</td>
												<!-- <td width="32" class="m-right">1</td> -->
												<td class="m-td-btns">
													<apex:outputpanel rendered="{!s.Module.ShowEnroll = true}" layout="none" >
														<a href="JavaScript:EnrollContent('{!s.Module.ItemId}','{!s.Module.Type}');" class="b-btn">{!$Label.SearchCatalog_Enroll}</a>
													</apex:outputpanel>

													<apex:outputpanel rendered="{!IsManager = true}" layout="none" >
														<a href="JavaScript:AssignTraining('{!s.Module.ItemId}','{!s.Module.Type}','{!isConsumerUser}');" class="b-btn">{!$Label.SearchCatalog_Assign}</a>
													</apex:outputpanel>
												</td>
											</tr>
										</apex:outputpanel>
										<!-------------------------- COURSES ---------------------------------->
										<apex:outputpanel rendered="{!s.Type = 'Course'}" layout="none" id="m2">
											<tr>
												<td class="m-td-title"><div class="b-title m-plus">{!s.Module.Title}</div></td>
												<td class="m-td-descr"><pre><apex:outputText value="{!s.Module.Description}"/>&nbsp;</pre></td>
												<td class="m-td-type">{!s.Type}</td>
												<!-- <td width="32" class="m-right">{!s.Modules.size}</td> -->
												<td class="m-td-btns">
													<apex:outputpanel rendered="{!s.Module.ShowEnroll = true}" layout="none" >
														<a href="JavaScript:EnrollContent('{!s.Module.ItemId}','{!s.Type}');" class="b-btn">{!$Label.SearchCatalog_Enroll}</a>
													</apex:outputpanel>
													<apex:outputpanel rendered="{!IsManager = true}" layout="none" >
														<a href="JavaScript:AssignTraining('{!s.Module.ItemId}','{!s.Type}','{!isConsumerUser}');" class="b-btn">{!$Label.SearchCatalog_Assign}</a>
													</apex:outputpanel>
												</td>
											</tr>
											<tr class="m-hide">
												<td class="b-inner m-level-1" colspan="4">
													<table width="100%" cellspacing="0" cellpadding="0">
														<tbody>
															<apex:repeat value="{!s.Modules}" var="m">
															<tr>
																<td class="m-td-title"><div class="b-title">{!m.Title}</div></td>
																<td class="m-td-descr"><pre><apex:outputText value="{!m.Description}"/>&nbsp;&nbsp;</pre></td>
																<td class="m-td-type">{!m.Type}</td>
																<!-- <td width="32" class="m-right">1</td> -->
																<td class="m-td-btns">&nbsp;</td>
															</tr>
															</apex:repeat>
														</tbody>
													</table>
												</td>
											</tr>
										</apex:outputpanel>
										<!-------------------------- LEARNING PATHS ---------------------------------->
										<apex:outputpanel rendered="{!s.Type = 'Learning Path'}" layout="none" id="m3">
											<tr>
												<td class="m-td-title"><div class="b-title m-plus">{!s.Module.Title}</div></td>
												<td class="m-td-descr"><pre><apex:outputText value="{!s.Module.Description}"/>&nbsp;</pre></td>
												<td class="m-td-type">{!s.Type}</td>
												<!-- <td width="32" class="m-right">{!s.Courses.size}</td> -->
												<td class="m-td-btns">
													<apex:outputpanel rendered="{!s.Module.ShowEnroll = true}" layout="none" >
														<a href="JavaScript:EnrollContent('{!s.Module.ItemId}','{!s.Type}');" class="b-btn">{!$Label.SearchCatalog_Enroll}</a>
													</apex:outputpanel>
													<apex:outputpanel rendered="{!IsManager = true}" layout="none" >
														<a href="JavaScript:AssignTraining('{!s.Module.ItemId}','{!s.Type}','{!isConsumerUser}');" class="b-btn">{!$Label.SearchCatalog_Assign}</a>
													</apex:outputpanel>
												</td>
											</tr>
											<tr class="m-hide">
												<td class="b-inner m-level-1" colspan="4">
													<table width="100%" cellspacing="0" cellpadding="0">
														<tbody>
														<apex:repeat value="{!s.SortedList}" var="sl">
															<apex:outputPanel layout="none" rendered="{!IF(sl.Type=='Module'||sl.Type=='Quiz',true,false)}">
																	<tr>
																		<td class="m-td-title"><div class="b-title">{!sl.Title}</div></td>
																		<td class="m-td-descr"><pre><apex:outputText value="{!sl.Description}"/>&nbsp;&nbsp;</pre></td>
																		<td class="m-td-type">{!sl.Type}</td>
																		<td class="m-td-btns">&nbsp;&nbsp;</td>
																	</tr>
																</apex:outputPanel>
																<apex:outputPanel layout="none" rendered="{!sl.Type=='Course'}">
																	<tr>
																		<td class="m-td-title"><div class="b-title m-plus">{!sl.Title}</div></td>
																		<td class="m-td-descr"><pre><apex:outputText value="{!sl.Description}"/>&nbsp;</pre></td>
																		<td class="m-td-type">{!sl.Type}</td>
																		<td class="m-td-btns">&nbsp;</td>
																	</tr>
																	<tr class="m-hide">
																		<td class="b-inner m-level-2" colspan="4">
																			<table width="100%" cellspacing="0" cellpadding="0">
																				<tbody>
																				<apex:repeat value="{!sl.Courses.Modules}" var="m1">
																					<tr>
																						<td class="m-td-title"><div class="b-title">{!m1.Title}</div></td>
																						<td class="m-td-descr"><pre><apex:outputText value="{!m1.Description}"/>&nbsp;</pre></td>
																						<td class="m-td-type">{!m1.Type}</td>
																						<td class="m-td-btns">&nbsp;&nbsp;</td>
																					</tr>
																				</apex:repeat>
																				</tbody>
																			</table>
																		</td>
																	</tr>
																</apex:outputPanel>
															</apex:repeat>
														</tbody>
													</table>
												</td>
											</tr>
										</apex:outputpanel>
										<!-------------------------- CURRICULUM ---------------------------------->
										<apex:outputpanel rendered="{!s.Type = 'Curriculum'}" layout="none" >
											<tr>
												<td class="m-td-title"><div class="b-title m-plus">{!s.Module.Title}</div></td>
												<td class="m-td-descr"><pre><apex:outputText value="{!s.Module.Description}"/>&nbsp;</pre></td>
												<td class="m-td-type">{!s.Type}</td>
												<!-- <td width="32" class="m-right">{!s.Courses.size}</td> -->
												<td class="m-td-btns">
													<apex:outputpanel rendered="{!s.Module.ShowEnroll = true}" layout="none" >
														<a href="JavaScript:EnrollContent('{!s.Module.ItemId}','{!s.Type}');" class="b-btn">{!$Label.SearchCatalog_Enroll}</a>
													</apex:outputpanel>
													<apex:outputpanel rendered="{!IsManager = true}" layout="none" >
														<a href="JavaScript:AssignTraining('{!s.Module.ItemId}','{!s.Type}','{!isConsumerUser}');" class="b-btn">{!$Label.SearchCatalog_Assign}</a>
													</apex:outputpanel>
												</td>
											</tr>
											<tr class="m-hide">
												<td class="b-inner m-level-1" colspan="4">
													<table width="100%" cellspacing="0" cellpadding="0">
														<tbody>
														<apex:repeat value="{!s.SortedList}" var="sl">

															<apex:outputPanel layout="none" rendered="{!IF(sl.Type=='Module'||sl.Type=='Quiz',true,false)}">
																<tr>
																	<td class="m-td-title"><div class="b-title">{!sl.Title}</div></td>
																	<td class="m-td-descr"><pre><apex:outputText value="{!sl.Description}"/>&nbsp;&nbsp;</pre></td>
																	<td class="m-td-type">{!sl.Type}</td>
																	<td class="m-td-btns">&nbsp;&nbsp;</td>
																</tr>
															</apex:outputPanel>
															<apex:outputPanel layout="none" rendered="{!sl.Type=='Course'}">
																<tr>
																	<td class="m-td-title"><div class="b-title m-plus">{!sl.Title}</div></td>
																	<td class="m-td-descr"><pre><apex:outputText value="{!sl.Description}"/>&nbsp;</pre></td>
																	<td class="m-td-type">{!sl.Type}</td>
																	<td class="m-td-btns">&nbsp;</td>
																</tr>
																<tr class="m-hide">
																	<td class="b-inner m-level-2" colspan="4">
																		<table width="100%" cellspacing="0" cellpadding="0">
																			<tbody>
																			<apex:repeat value="{!sl.Courses.Modules}" var="m1">
																				<tr>
																					<td class="m-td-title"><div class="b-title">{!m1.Title}</div></td>
																					<td class="m-td-descr"><pre><apex:outputText value="{!m1.Description}"/>&nbsp;</pre></td>
																					<td class="m-td-type">{!m1.Type}</td>
																					<td class="m-td-btns">&nbsp;&nbsp;</td>
																				</tr>
																			</apex:repeat>
																			</tbody>
																		</table>
																	</td>
																</tr>
															</apex:outputPanel>
															<apex:outputPanel layout="none" rendered="{!sl.Type=='Learning Path'}">
																<tr>
																	<td class="m-td-title"><div class="b-title m-plus">{!sl.Title}</div></td>
																	<td class="m-td-descr"><pre><apex:outputText value="{!sl.Description}"/>&nbsp;</pre></td>
																	<td class="m-td-type">{!sl.Type}</td>
																	<td class="m-td-btns">&nbsp;</td>
																</tr>
																<tr class="m-hide">
																<td class="b-inner m-level-2" colspan="4">
																	<table width="100%" cellspacing="0" cellpadding="0">
																		<tbody>
																		<apex:repeat value="{!sl.Learnpths.SortedList}" var="m1">
																		<apex:outputPanel layout="none" rendered="{!m1.Type=='Course'}">
																				<tr>
																					<td class="m-td-title"><div class="b-title m-plus">{!m1.Title}</div></td>
																					<td class="m-td-descr"><pre><apex:outputText value="{!m1.Description}"/>&nbsp;</pre></td>
																					<td class="m-td-type">{!m1.Type}</td>
																					<!-- <td width="32" class="m-right">1</td> -->
																					<td class="m-td-btns">&nbsp;</td>
																				</tr>
																				<tr class="m-hide">
																					<td class="b-inner m-level-3" colspan="4">
																						<table width="100%" cellspacing="0" cellpadding="0">
																							<tbody>
																							<apex:repeat value="{!m1.Courses.Modules}" var="m2">
																								<tr>
																									<td class="m-td-title"><div class="b-title">{!m2.Title}</div></td>
																									<td class="m-td-descr"><pre><apex:outputText value="{!m2.Description}"/></pre>&nbsp;</td>
																									<td class="m-td-type">{!m2.Type}</td>
																									<td class="m-td-btns">&nbsp;</td>
																								</tr>
																							</apex:repeat>
																							</tbody>
																						</table>
																					</td>
																				</tr>
																		</apex:outputPanel>
																		<apex:outputPanel layout="none" rendered="{!IF(m1.Type=='Module' || m1.Type=='Quiz',true,false)}">
																				<tr>
																					<td class="m-td-title"><div class="b-title">{!m1.Title}</div></td>
																					<td class="m-td-descr"><pre><apex:outputText value="{!m1.Description}"/></pre>&nbsp;</td>
																					<td class="m-td-type">{!m1.Type}</td>
																					<td class="m-td-btns">&nbsp;</td>
																				</tr>
																		</apex:outputPanel>
																		</apex:repeat>
																		</tbody>
																	</table>
																</td>
															</tr>
															</apex:outputPanel>
														</apex:repeat>
														</tbody>
													</table>
												</td>
											</tr>
										</apex:outputpanel>
									</apex:repeat>
								</tbody>
							</table>
						</apex:outputpanel>
					</div>
				</div>
			</div>
		</apex:form>
	</div>


	<div class="b-overlay"></div>
	<div class="b-lightbox">
		<apex:form id="assign_form">
			<apex:outputpanel id="ab" layout="none">

				<apex:actionFunction status="while_assign" name="assign_train" action="{!ShowUserListForAssign}" reRender="ab, assign_form">
					<apex:param name="snd1" value="" assignTo="{!AssignedContentId}"/>
					<apex:param name="snd2" value="" assignTo="{!AssignObjectType}"/>
				</apex:actionFunction>

				<apex:actionFunction name="notConsumerUser" oncomplete="init_page()" action="{!ShowUserListForAssign}" status="status2" reRender="ab, assign_form, whole"/>

				<apex:actionFunction name="enroll_content" oncomplete="init_page()" action="{!addToMyTraining}" status="status2" reRender="ab, assign_form, whole">
					<apex:param name="snd1" value="" assignTo="{!idTraining}"/>
					<apex:param name="snd2" value="" assignTo="{!idObjectType}"/>
				</apex:actionFunction>

				<div class="b-title-bar">
					<div class="b-title">{!$Label.SearchCatalog_Assign_Learning}</div>
					<div class="b-close-btn"><a href="javascript:Closelightbox()">{!$Label.SearchCatalog_Close}</a></div>
				</div>
				<div class="b-content">
					<apex:pageMessages id="messages2" ></apex:pageMessages>
					<p><strong class="m-faded">{!AsignObject.Type}:</strong> {!AsignObject.Title} </p>
					<p><pre><strong class="m-faded">Description:</strong> {!AsignObject.Description}</pre></p>
					<div class="b-scroller">
																			
						<apex:outputPanel id="TraineesList">					
							<apex:outputPanel style="float:right;font-size:85%;"  rendered="{!IF((HasPrevTraineePage)||(HasNextTraineePage), true, false)}">
								<apex:commandLink action="{!PrevTraineePage}" rerender="TraineesList, " rendered="{!HasPrevTraineePage}" status="loadStatus2" onclick="if(intSelectedItemsCount!=0) { if(confirm('{!JSENCODE($Label.AssignTrainingContent_js_Alert)}') == false) {return false;} else {intSelectedItemsCount=0}};">&lt;{!$Label.AssignTrainingContent_oT_Previous_Page}</apex:commandlink>
								<apex:outputText rendered="{!NOT(HasPrevTraineePage)}">&lt;{!$Label.AssignTrainingContent_oT_Previous_Page}</apex:outputText>
								&nbsp;|&nbsp;
								<apex:commandLink action="{!NextTraineePage}" rerender="TraineesList" rendered="{!HasNextTraineePage}" status="loadStatus2" onclick="if(intSelectedItemsCount!=0) { if(confirm('{!JSENCODE($Label.AssignTrainingContent_js_Alert)}') == false) {return false;} else {intSelectedItemsCount=0}};">{!$Label.AssignTrainingContent_oT_Next_Page}&gt;</apex:commandlink>
								<apex:outputText rendered="{!NOT(HasNextTraineePage)}">{!$Label.AssignTrainingContent_oT_Next_Page}&gt;</apex:outputText>
							</apex:outputPanel>
							<br/>
						   <script type='text/javascript'>
						   		var intSelectedItemsCount = 0;
						   </script>
						   
							<apex:outputPanel layout="block" rendered="{!Trainee.size > 0}">							
								<table width="100%" border="0" cellspacing="0" cellpadding="0" class="m-data">
									<thead>
										<tr>
											<th width="20px"><apex:inputCheckbox id="selectall" selected="false" onclick="jQuery('[id*=usr_check]').attr('checked', jQuery(this).attr('checked')); refreshSelectedItemsCount();" /> </th>
											<th>{!$Label.SearchCatalog_Trainees}</th>
											<th>{!$Label.SearchCatalog_Roles}</th>
										</tr>
									</thead>
									<tbody>
									<apex:repeat value="{!Trainee}" var="tr">
										<tr>
											<td> <apex:inputCheckbox value="{!tr.selected}" id="usr_check" onclick="jQuery('[id*=selectall]').attr('checked', false); refreshSelectedItemsCount();"/> </td>
											<td>{!tr.user.Name}</td>
											<td>{!tr.user.UserRole.Name} </td>
										</tr>
									</apex:repeat>
									</tbody>
								</table>
							</apex:outputPanel>
								
							<apex:outputPanel style="float:right;font-size:85%;"  rendered="{!IF((HasPrevTraineePage)||(HasNextTraineePage), true, false)}">
								<apex:commandLink action="{!PrevTraineePage}" rerender="TraineesList, " rendered="{!HasPrevTraineePage}" status="loadStatus2" onclick="if(intSelectedItemsCount!=0) { if(confirm('{!JSENCODE($Label.AssignTrainingContent_js_Alert)}') == false) {return false;} else {intSelectedItemsCount=0}};">&lt;{!$Label.AssignTrainingContent_oT_Previous_Page}</apex:commandlink>
								<apex:outputText rendered="{!NOT(HasPrevTraineePage)}">&lt;{!$Label.AssignTrainingContent_oT_Previous_Page}</apex:outputText>
								&nbsp;|&nbsp;
								<apex:commandLink action="{!NextTraineePage}" rerender="TraineesList" rendered="{!HasNextTraineePage}" status="loadStatus2" onclick="if(intSelectedItemsCount!=0) { if(confirm('{!JSENCODE($Label.AssignTrainingContent_js_Alert)}') == false) {return false;} else {intSelectedItemsCount=0}};">{!$Label.AssignTrainingContent_oT_Next_Page}&gt;</apex:commandlink>
								<apex:outputText rendered="{!NOT(HasNextTraineePage)}">{!$Label.AssignTrainingContent_oT_Next_Page}&gt;</apex:outputText>
							</apex:outputPanel>							
						</apex:outputPanel>						
					</div>
					<br/>					
					<apex:outputPanel layout="block" rendered="{!Trainee.size > 0}">
						<input type="checkbox" onclick="showDueDate()"/>
						{!$ObjectType.Transcript_Line__c.fields.Due_Date__c.label} &nbsp;&nbsp;&nbsp;
						<apex:inputField value="{!Dummy.lmscons__Due_Date__c}" id="DueDateId" />
					</apex:outputPanel>


					<apex:outputPanel layout="block">						
						<apex:commandButton style="float:right;" onclick="Closelightbox(); return false;" value="{!$Label.SearchCatalog_Cancel}" />
						<!-- after the first time clicked this button will disappear -->
						<apex:commandButton style="float:right;" action="{!AssignContentToUsers}" oncomplete="Closelightbox()" rendered="{!Trainee.size > 0}" rerender="messages" status="loadStatus2" value="{!$Label.SearchCatalog_Assign}" id="AssignButton" onclick="jQuery('input[id$=AssignButton]').addClass('hideElement'); jQuery('input[id$=CopyAssignButton]').removeClass('hideElement');" />
						<!-- and this button will appear instead but you will be not able to click on it -->
						<apex:commandButton style="float:right;" value="{!$Label.SearchCatalog_Assign}" id="CopyAssignButton" styleClass="hideElement" disabled="true" />
					</apex:outputPanel>
					<apex:actionStatus id="loadStatus2">
						<apex:facet name="start">
							<apex:image url="/img/loading.gif" />
						</apex:facet>
					</apex:actionStatus>
					<br/><br/>
				</div>
			</apex:outputpanel>									
			
		</apex:form>
	</div>
</apex:outputpanel>

<script type="text/javascript">
	function refreshSelectedItemsCount(){	
		intSelectedItemsCount = jQuery('th > input[type=checkbox]:checked').length + jQuery('td > input[type=checkbox]:checked').length; 					
	}
</script>

</body>

</apex:page>