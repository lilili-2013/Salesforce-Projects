<apex:page controller="ts2.s_EmailController" showHeader="false" sideBar="false">

<body class="setup popupTab">

<apex:form id="frm">

	<br/>
	<div class="bFilterView">
		<span class="bFilter">
			<apex:outputLabel style="text-align:left;font-weight:bold;padding-right:.69em;" for="fcf_templateSelector" value="{!$Label.Email_Folder}" />
			<apex:selectList id="fcf_templateSelector" value="{!SelectedEmailFolder}" size="1" >
				<apex:selectOptions value="{!EmailFoldersList}" />
				<apex:actionSupport event="onchange" action="{!ChangeEmailFolderAction}" />
			</apex:selectList>
		</span>
	</div>
	<br/>

	<apex:pageBlock id="fcf_Templates" mode="details">
		<apex:pageBlockTable value="{!EmailTemplates}" var="template" rendered="{!EmailTemplates.SIZE > 0}">
			<apex:column headerValue="{!$ObjectType.EmailTemplate.Fields.Name.Label}">
				<apex:outputLink value="#" onclick="setTemplateId('{!template.Id}')"><apex:outputField value="{!template.Name}" /></apex:outputLink>
			</apex:column>
			<apex:column headerValue="{!$ObjectType.EmailTemplate.Fields.TemplateType.Label}">
				<apex:outputField value="{!template.TemplateType}" />
			</apex:column>
			<apex:column headerValue="{!$ObjectType.EmailTemplate.Fields.Description.Label}">
				<apex:outputField value="{!template.Description}" />
			</apex:column>
		</apex:pageBlockTable>

		<apex:outputText value="{!$Label.Email_Folder_No_Templates}" rendered="{!EmailTemplates.SIZE = 0}" />
	</apex:pageBlock>

</apex:form>

</body>

<script type="text/javascript">
	function setTemplateId(templateId) {
		window.opener.setTemplateId(templateId);
		window.close();
	}
</script>

</apex:page>