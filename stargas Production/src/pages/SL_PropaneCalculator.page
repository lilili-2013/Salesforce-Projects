<apex:page standardcontroller="Opportunity" extensions="SL_PropaneCalculatorController">
	<apex:form >
		<apex:actionFunction name="calculatePropaneAF" action="{!calculatePropane}" rerender="purposeValues,Errors" status="processing">
			<apex:param name="SumOfSelectedPuposes" value="" assignTo="{!Sum_Of_Selected_Purposes}"/>
			<apex:param name="CountOfRouteMethods" value="" assignTo="{!Count_Of_Route_Methods}"/>
			<apex:param name="CountOfNonRouteMethods" value="" assignTo="{!Count_Of_Non_Route_Methods}"/>
		</apex:actionFunction>
		<apex:pageMessages id="Errors"/>
		<span style="color:red;">*</span><span style="font-weight:bold;">Purpose</span><br/>
			<apex:outputPanel id="purposeValues">
				<table>
					<tr>
						<td>
							<apex:inputcheckbox value="{!objOpportunity.Barbeque_Grill__c}" id="BarbequeGrill"/>
						</td>
						<td>
							<apex:outputLabel value="Barbeque Grill" for="BarbequeGrill"/>
						</td>
						<td bgcolor="#DBD908">
							<apex:outputLabel value="Usage:" style="padding-left:20px;"/>
						</td>
						<td bgcolor="#DBD908">
							<apex:outputText value="{!objOpportunity.Usage__c}"/>
						</td>
					</tr>
					<tr>
						<td>
							<apex:inputcheckbox value="{!objOpportunity.Cooking_Range__c}" id="CookingRange"/>
						</td>
						<td>
							<apex:outputLabel value="Cooking Range" for="CookingRange"/>
						</td>
<!-- 						<td bgcolor="#DBD908"> -->
<!-- 							<apex:outputLabel value="Sub Level:" style="padding-left:20px;"/> -->
<!-- 						</td> -->
<!-- 						<td bgcolor="#DBD908"> -->
<!-- 							<apex:outputText value="{!objOpportunity.Sub_Level__c}"/> -->
<!-- 						</td> -->
						<td bgcolor="#DBD908">
							<apex:outputLabel value="K-Factor:" style="padding-left:20px;"/>
						</td>
						<td bgcolor="#DBD908">
							<apex:outputText value="{!objOpportunity.K_Factor__c}"/>
						</td>
					</tr>
					<tr>
						<td>
							<apex:inputcheckbox value="{!objOpportunity.Hot_Water__c}" id="HotWater"/>
						</td>
						<td>
							<apex:outputLabel value="Hot Water" for="HotWater"/>
						</td>
						<td bgcolor="#DBD908">
							<apex:outputLabel value="Route Table #" style="padding-left:20px;"/>
						</td>
						<td bgcolor="#DBD908">
							<apex:outputText value="{!objOpportunity.Route_Table__c}"/>
						</td>
					</tr>
					<tr>
						<td>
							<apex:inputcheckbox value="{!objOpportunity.Space_Heating_Fireplace__c}" id="SpaceHeatingFireplace"/>
						</td>
						<td>
							<apex:outputLabel value="Space Heating - Fireplace" for="SpaceHeatingFireplace"/>
						</td>
						<td bgcolor="#DBD908">
							<apex:outputLabel value="HW Gallons:" style="padding-left:20px;"/>
						</td>
						<td bgcolor="#DBD908">
							<apex:outputText value="{!objOpportunity.HW_Gallons__c}"/>
						</td>
					</tr>
					<tr>
						<td>
							<apex:inputcheckbox value="{!objOpportunity.Swimming_Pool_Only__c}" id="SwimmingPoolOnly"/>
						</td>
						<td>
							<apex:outputLabel value="Swimming Pool Only" for="SwimmingPoolOnly"/>
						</td>
						<td bgcolor="#DBD908">
							<apex:outputLabel value="Separate HW:" style="padding-left:20px;"/>
						</td>
						<td bgcolor="#DBD908">
							<apex:outputText value="{!objOpportunity.Separate_HW__c}"/>
						</td>
					</tr>
					<tr>
						<td>
							<apex:inputcheckbox value="{!objOpportunity.Swimming_Pool_With_Spa__c}" id="SwimmingPoolWithSpa"/>
						</td>
						<td>
							<apex:outputLabel value="Swimming Pool With Spa" for="SwimmingPoolWithSpa"/>
						</td>
					</tr>
					<tr>
						<td>
							<apex:inputcheckbox value="{!objOpportunity.Dryer_Clothes__c}" id="DryerClothes"/>
						</td>
						<td>
							<apex:outputLabel value="Dryer - Clothes" for="DryerClothes"/>
						</td>
					</tr>
					<tr>
						<td>
							<apex:inputcheckbox value="{!objOpportunity.Primary_Heat_Small__c}" id="PrimaryHeatSmall"/>
						</td>
						<td>
							<apex:outputLabel value="Primary Heat - Small" for="PrimaryHeatSmall"/>
						</td>
					</tr>
					<tr>
						<td>
							<apex:inputcheckbox value="{!objOpportunity.Primary_Heat_Medium__c}" id="PrimaryHeatMedium"/>
						</td>
						<td>
							<apex:outputLabel value="Primary Heat - Medium" for="PrimaryHeatMedium"/>
						</td>
					</tr>
					<tr>
						<td>
							<apex:inputcheckbox value="{!objOpportunity.Primary_Heat_Large__c}" id="PrimaryHeatLarge"/>
						</td>
						<td>
							<apex:outputLabel value="Primary Heat - Large" for="PrimaryHeatLarge"/>
						</td>
					</tr>
					<tr>
						<td>
							<apex:inputcheckbox value="{!objOpportunity.Generator__c}" id="Generator"/>
						</td>
						<td>
							<apex:outputLabel value="Generator" for="Generator"/>
						</td>
					</tr>
					<tr>
						<td>
							<apex:inputcheckbox value="{!objOpportunity.Fireplace_Decorative__c}" id="FireplaceDecorative"/>
						</td>
						<td>
							<apex:outputLabel value="Fireplace - Decorative" for="FireplaceDecorative"/>
						</td>
					</tr>
					<tr>
						<td>
							<apex:inputcheckbox value="{!objOpportunity.Employee__c}" id="Employee"/>
						</td>
						<td>
							<apex:outputLabel value="Employee" for="Employee"/>
						</td>
					</tr>
				</table>
<!-- 				<div style="padding-left:7px;padding-top:18px;"> -->
<!-- 					<apex:inputText value="{!objOpportunity.Planned_Tank_Size_Gallons__c}" id="PlannedTankSize" style="text-align:center;" onkeypress="return isNumberKey(event);"/>&nbsp;							 -->
<!-- 					<apex:outputLabel value="Planned Tank Size / Gallons" for="PlannedTankSize"/>									 -->
<!-- 				</div> -->
			<center><apex:commandButton value="Calculate Propane" onClick="return countSelectedPurpose();"/></center>
			</apex:outputPanel>
			<!-- START OF ACTION STATUS -->	    
		    <apex:actionstatus id="processing" startText="Requesting...">
		         <apex:facet name="start">
			          <div id="salesforceSource_blurybackground" style="position:fixed; left:1px; top:1px; width:100%; height:100%; text-align:center; vertical-align: middle; background-color: #dcdcdc; opacity:0.7;filter:alpha(opacity=60)"></div>
				           <div id="ManageMembersViewport_loading" class="waitingSearchDiv" style="width: 100%; height: 100%; display: ''; ">
					            <div style="width: 144px;vertical-align: middle;" class="waitingHolder">
						             <table  style="width: 100%; height: 30%">
							              <tr align="center" valign="top" style="width: 100%; height: 30%">
							                 <td valign="top"><img src="/img/loading.gif"/><span class="waitingDescription"><b>Loading...</b></span></td>
							              </tr>
						             </table>
					            </div>
			         	 	</div>
			         <div id="ManageMembersViewport_loading" class="waitingSearchDiv" style="width: 100%; height: 100%; display:''; "></div>
			         <script>document.getElementById('ManageMembersViewport_loading').height = window.innerHeight * (3/4);</script>
		         </apex:facet>
		         <apex:facet name="stop"></apex:facet>
		    </apex:actionstatus>	    
		 	<!-- END OF ACTION STATUS -->
	</apex:form>
	<script>
		function countSelectedPurpose()
		{
			var Count_Of_Route_Methods = 0;
			var Count_Of_Non_Route_Methods = 0;
			var CheckedBoxes=document.getElementsByTagName('input');
			for(var i=0;i < CheckedBoxes.length;i++)
			{
				if(CheckedBoxes[i].type == 'checkbox' && CheckedBoxes[i].checked)
				{
					var purposeId = CheckedBoxes[i].id;
					if(purposeId.indexOf('Employee') == -1)
					{
						if(purposeId.indexOf('BarbequeGrill') !=-1 || purposeId.indexOf('CookingRange') != -1 || purposeId.indexOf('DryerClothes')!=-1 || purposeId.indexOf('Generator')!=-1 || purposeId.indexOf('FireplaceDecorative')!=-1)
							Count_Of_Route_Methods++;
						else
							Count_Of_Non_Route_Methods++;
					}
				}		
			}
			calculatePropaneAF(Count_Of_Route_Methods + Count_Of_Non_Route_Methods,Count_Of_Route_Methods,Count_Of_Non_Route_Methods);
			return false;
		}
		
		//script to validate that the entered text is number only
		function isNumberKey(evt)
        {
            var charCode = (evt.which) ? evt.which : event.keyCode;
            if (charCode != 46 && charCode > 31 && (charCode < 48 || charCode > 57))
                return false;

            return true;
        }
	</script>
</apex:page>