<apex:page controller="SL_FundDashboardReportGenController">
    <apex:form >
        <style>
        .lbl
        {
            font-weight:bold;
            padding-right:10px;
            font-family:Calibri;
        }
        .requireField
        {

            width: 5px; 
            padding-top : 2px;
            color: #CC0000;
            font-size: 19px;
            font-weight:bold;   
        }
        </style>
        <script type="text/javascript">
            function checkFundValue(fundId, StartDate, EndDate)
            {               
                if(document.getElementById(fundId).value == '')
                {
                    alert('Please select the Fund value.');                 
                }
                else if(document.getElementById(StartDate).value!=null && document.getElementById(EndDate).value!=null && document.getElementById(StartDate).value!='' && document.getElementById(EndDate).value!='')
                {                   
                    var StartDateValue = document.getElementById(StartDate).value;
                    var EndDateValue = document.getElementById(EndDate).value;
                    
                    if(!validateDate(StartDateValue) || !validateDate(EndDateValue))
                        return false;
                    
                    var dtStartDate = new Date(StartDateValue);
                    var dtEndDate = new Date(EndDateValue);
                    
                    if(dtStartDate > dtEndDate)
                        alert('Please select valid date: From Date cannot be greater than To Date');
                }
                return false;       
            }
            
            function enableButton(ButtonId,DummyId,fundId, StartDate, EndDate)
            {
                if(document.getElementById(fundId).value!=null && document.getElementById(fundId).value!='')
                {                   
                    document.getElementById(ButtonId).style.display = '';
                    document.getElementById(DummyId).style.display = 'none';
                }
                else
                {
                    document.getElementById(ButtonId).style.display = 'none';
                    document.getElementById(DummyId).style.display = '';
                }
                
                if(document.getElementById(StartDate).value!=null && document.getElementById(EndDate).value!=null && document.getElementById(StartDate).value!='' && document.getElementById(EndDate).value!='')
                {                   
                    var StartDateValue = document.getElementById(StartDate).value;
                    var EndDateValue = document.getElementById(EndDate).value;
                    
                    if(!validateDate(StartDateValue) || !validateDate(EndDateValue))
                    {
                        document.getElementById(ButtonId).style.display = 'none';
                        document.getElementById(DummyId).style.display = '';
                        return false;
                    }
                    
                    var dtStartDate = new Date(StartDateValue);
                    var dtEndDate = new Date(EndDateValue);
                    
                    if(dtStartDate > dtEndDate)
                    {
                        alert('Please select valid date: From Date cannot be greater than To Date');
                        document.getElementById(ButtonId).style.display = 'none';
                        document.getElementById(DummyId).style.display = '';
                    }
                }
            }
            
            function validateDate(dValidate)
            {
                var arDValidate=dValidate.split("/");
                if(arDValidate.length==3)
                {
                  if(arDValidate[0].length > 2 || (arDValidate[0]>13))
                  {
                     alert("Wrong Date format");
                     return false;
                  }
                  else if(arDValidate[1].length > 2 || (arDValidate[1]>32))
                  {
                     alert("Wrong Month format");
                     return false;
                  }
                  else if(arDValidate[2].length > 4)
                  {
                     alert("Wrong Year format");
                     return false;
                  }
                  else
                  {
                    var dateDate=new Date(arDValidate[2],arDValidate[1]-1,arDValidate[0]);
                    if((arDValidate[0]!=dateDate.getDate()))
                    {
                      alert("Wrong Date Enter e.g date month year is not correct 31 feb 2009");
                      return false;
                    }
                  }
                }
                else
                {
                    alert("Wrong Format, Please enter the date in mm/dd/yyyy format");
                    return false;
                }
                return true;
            }
        </script>
        <div style="text-align:center;height: 200%;font-size: 200%; font-weight:bold;padding-bottom: 20px;padding-top:30px;">
                    Custom Report Generator
        </div>
       <apex:pageMessages />
        <table width = "100%;" style ="padding-top: 10px; border-top: 2px solid #000000;">
            <tr>
                <td style = "width:60%;">
                    <table style="padding-top: 10px; width:100%;">
                        <tr style="width:100%;">
                            <td colspan="2" style="text-align:center;border-bottom: 2px solid #000000;">
                                <span class="lbl" style="font-size:20px;">Filtering</span>
                            </td>
                        </tr>
                        <tr>
                            <td style = "text-align: right; padding-top:8px;">
                                <apex:outputLabel value="Fund:" for="project" styleClass="lbl"/>
                            </td>
                            <td style = "text-align: left;">
                                <apex:outputText value="|"  styleClass="requireField"/>
                                <apex:inputField value="{!objFundraisingDeal.Fund__c}" id="FundId" style="width:130px;" onChange="enableButton('{!$Component.GenerateReport}','{!$Component.Dummy}','{!$Component.FundId}','{!$Component.dateStartId}','{!$Component.dateEndId}');"/>
                            </td>
                        </tr>
                        <tr>
                            <td style = "text-align: right;">
                                <apex:outputLabel value="Consultant:" styleClass="lbl" />&nbsp;
                            </td>
                            <td  style = "text-align: left;">
                                <apex:inputText value="{!strConsultant}" />
                            </td>
                        </tr>
                        <tr>
                            <td style = "text-align: right;">
                                <apex:outputLabel value="Coverage:" styleClass="lbl"/>
                            </td>
                            <td style = "text-align: left;">
                                <apex:inputText value="{!strCoverage}"/>
                            </td>
                        </tr>
                        <tr>
                            <td style = "text-align: right;padding-top:20px;">
                                <apex:outputLabel value="Interest Level:" styleClass="lbl"/>
                            </td>
                            <td  style = "text-align: left;">
                               <c:SL_MultiselectComponent leftLabel="Available" leftOptions="{!multiselectInterestLevel.available}" rightLabel="Selected" rightOptions="{!multiselectInterestLevel.selected}" size="5" width="225px"/>
                            </td>
                        </tr>  
                        <tr>
                            <td style = "text-align: right;padding-top:20px;">
                                <apex:outputLabel value="LP Type:" styleClass="lbl"/>
                            </td>
                            <td style = "text-align: left;">
                              <c:SL_MultiselectComponent leftLabel="Available" leftOptions="{!multiselectLPType.available}" rightLabel="Selected" rightOptions="{!multiselectLPType.selected}" size="5" width="225px"/>
                            </td>
                        </tr>
                        <tr>
                            <td style = "text-align: right;padding-top:20px;">
                                <apex:outputLabel value="Existing Investor:" styleClass="lbl"/>
                            </td>
                            <td  style = "text-align: left;">
                               <c:SL_MultiselectComponent leftLabel="Available" leftOptions="{!multiselectExistingInvestor.available}" rightLabel="Selected" rightOptions="{!multiselectExistingInvestor.selected}" size="3" width="225px"/>
                            </td>
                        </tr>  
                        <tr>
                            <td style = "text-align: right;">
                                <apex:outputLabel value="City:" styleClass="lbl"/>
                            </td>
                            <td  style = "text-align: left;">
                                <apex:inputText value="{!strCity}"/>
                            </td>
                        </tr>
                        <tr>
                            <td style = "text-align: right;">
                                <apex:outputLabel value="Country:" styleClass="lbl"/>
                            </td>
                            <td style = "text-align: left;">
                                <apex:inputText value="{!strCountry}"/>
                            </td>
                        </tr>
                    </table>
                    <table width="100%">
                        <tr>
                            <td width="16%" style = "text-align: right;">
                                <apex:outputLabel value="From Date:" styleClass="lbl"/>
                            </td>
                            <td width="37%" style="text-align: left;">
                                <span style="margin-left: -4px;">
                                    <apex:inputtext value="{!dtRange.dateStart}"  id="dateStartId" onfocus="DatePicker.pickDate(true, '{!$Component.dateStartId}', false);" onChange="enableButton('{!$Component.GenerateReport}','{!$Component.Dummy}','{!$Component.FundId}','{!$Component.dateStartId}','{!$Component.dateEndId}');" style="width:130px;"/>
                                    <span class="dateFormat">[
                                                <a href="javascript:DatePicker.insertDate('{!MONTH(TODAY())}/{!DAY(TODAY())}/{!YEAR(TODAY())}', '{!$component.dateStartId}', true);">
                                                {!MONTH(TODAY())}/{!DAY(TODAY())}/{!YEAR(TODAY())}</a>]
                                    </span>
                                </span>
                            </td>
                            <td width="10%" style = "text-align: right;">
                                <apex:outputLabel value="To Date:" styleClass="lbl"/>
                            </td>
                            <td width="40%" style="text-align: left;">
                                <span>
                                    <apex:inputtext value="{!dtRange.dateEnd}"  id="dateEndId" onfocus="DatePicker.pickDate(true, '{!$Component.dateEndId}', false);" onChange="enableButton('{!$Component.GenerateReport}','{!$Component.Dummy}','{!$Component.FundId}','{!$Component.dateStartId}','{!$Component.dateEndId}');" style="width:130px;"/>
                                    <span class="dateFormat">[
                                                <a href="javascript:DatePicker.insertDate('{!MONTH(TODAY())}/{!DAY(TODAY())}/{!YEAR(TODAY())}', '{!$Component.dateEndId}', true);">
                                                {!MONTH(TODAY())}/{!DAY(TODAY())}/{!YEAR(TODAY())}</a>]
                                    </span>
                                </span>
                            </td>
                        </tr>
                        <tr>
                        	<td style="text-align: right;  width:17%;">
                                <apex:outputLabel value="Select Currency:" styleClass="lbl"/>
                            </td>
                            <td style="text-align: left;">
                               <apex:SelectList value="{!strCurrencyType}" size="1" style="margin-left: -4px;">
                                    <apex:selectOptions value="{!CurrencyType}"/>
                                </apex:SelectList>
                            </td>
                        </tr>
                    </table>
                    <table style="padding-top: 10px; width:100%;">
                        <tr style="width:100%;">
                            <td colspan="3" style="width:100%; text-align:center;border-bottom: 2px solid #000000;">
                                <span class="lbl" style="font-size:20px;">Sorting</span>
                            </td>
                        </tr>
                        <tr>
                            <td style="text-align: right;  width:17%;">
                                <apex:outputLabel value="Primary Sort:" styleClass="lbl"/>
                            </td>
                            <td style="text-align: left;">
                               <apex:SelectList value="{!strPrimaryField}" size="1">
                                    <apex:selectOptions value="{!fieldPicklist}"/>
                                </apex:SelectList>
                            </td>
                            <td style="text-align: left;width:60%;">
                                <apex:SelectList value="{!strPrimarySort}" size="1">
                                    <apex:selectOptions value="{!SortValue}"/>
                                </apex:SelectList>
                            </td>  
                        </tr>
                        <tr> 
                            <td style="text-align: right; width:17%; ">
                                <apex:outputLabel value="Secondary Sort:" styleClass="lbl"/>
                            </td>
                            <td style="text-align: left;">
                               <apex:SelectList value="{!strSecondaryField}" size="1">
                                    <apex:selectOptions value="{!fieldPicklist}"/>
                                </apex:SelectList>
                            </td>
                            <td style="text-align: left;width:60%;">
                                <apex:SelectList value="{!strSecondarySort}" size="1">
                                    <apex:selectOptions value="{!SortValue}"/>
                                </apex:SelectList>
                            </td>
                        </tr>
						<!-- Start - Added by Nrusingh for GREENHILL-35 -->
						<tr> 
                            <td style="text-align: right; width:17%; ">
                                <apex:outputLabel value="Tertiary Sort:" styleClass="lbl"/>
                            </td>
                            <td style="text-align: left;">
                               <apex:SelectList value="{!strTertiaryField}" size="1">
                                    <apex:selectOptions value="{!fieldPicklist}"/>
                                </apex:SelectList>
                            </td>
                            <td style="text-align: left;width:60%;">
                                <apex:SelectList value="{!strTertiarySort}" size="1">
                                    <apex:selectOptions value="{!SortValue}"/>
                                </apex:SelectList>
                            </td>
                        </tr>                       
                       <!-- End --> 
                    </table>
                </td>
                <td></td><td></td>
                <td>
                    <table style="padding-top: 10px; width:100%;">
                        <tr style="width:100%;">
                            <td colspan="2" style="text-align:center;border-bottom: 2px solid #000000;">
                                <span class="lbl" style="font-size:20px;">Columns</span>
                            </td>
                        </tr>
                        <apex:repeat value="{!lstFieldWrapper}" var="field">
                            <tr>
                                <td style="width:10px;">
                                   <apex:inputCheckbox value="{!field.isSelected}"/>
                                </td>
                                 <td>
                                     <apex:outputLabel value="{!field.strFieldLabel}" styleClass="lbl"/>
                                </td>
                            </tr>
                        </apex:repeat>
                    </table>
                </td>
                <td></td><td></td>
            </tr>
            <tr>
                <td>
                    <table style="padding-top: 10px; width:100%;">
                        <tr style="width:100%;">
                            <td colspan="2" style="text-align:center;border-bottom: 2px solid #000000;">
                                <span class="lbl" style="font-size:20px;">Report Type</span>
                            </td>
                        </tr>
                       <tr>
                            <td style="text-align: right;  width:17%;">
                                <apex:outputLabel value="Report Type:" styleClass="lbl"/>
                            </td>
                            <td style="text-align: left;">
                               <apex:SelectList value="{!strReportType}" size="1">
                                    <apex:selectOptions value="{!ReportType}"/>
                                </apex:SelectList>
                            </td>
                        </tr>
                    </table>
                </td>
            </tr>
            <tr>
                <td colspan="4" style="text-align:center;">
                    <apex:commandLink target="_blank" style="text-decoration:none;display:none;" id="GenerateReport" action="{!generateReport}" >
                        <apex:commandButton value="Generate Report"/>
                     </apex:commandLink>
                     <apex:commandButton value="Generate Report" onClick="return checkFundValue('{!$Component.FundId}','{!$Component.dateStartId}','{!$Component.dateEndId}');" id="Dummy"/>
                 </td>
            </tr> 
        </table>
    </apex:form>
</apex:page>