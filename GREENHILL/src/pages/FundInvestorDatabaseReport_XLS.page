<apex:page showHeader="false" controller="FundInvestorDatabaseReport" cache="true" contentType="application/vnd.ms-excel#FundInvestorDatabaseReport.xls" renderAs="{!chooserender}"> <!-- renderAs="{!chooserender}"  -->
<html> 
<head>
<style>
        ms {
        	mso-number-format:"mm\/dd\/yy";
        	font-size: 120%;
        }
</style>
</head>
<body>
	<b><apex:outputText style="font-size: 160%;" value="{!curFundObj.Name}"/></b><br/> 
	<b><apex:outputText styleClass="ms" value="{!DateNow}"/></b><br/>
	<b>All Figures in {!curFundObj.Native_Currency__c} Currency</b><br/><br/>
	 
	<table width="100%" style="collapse: collapse; border: 0px #c0c0c0 solid;" cellpadding="2" cellspacing="0">

		<col style="mso-width-source:userset;width: 250px;" >
		<col style="mso-width-source:userset;width: 35px;">
		<col style="mso-width-source:userset;width: 35px;">
		<col style="mso-width-source:userset;width: 50px;">
		<col style="mso-width-source:userset;width: 50px;">
		<col style="mso-width-source:userset;width: 60px;">
		<col style="mso-width-source:userset;width: 60px;">
		<col style="mso-width-source:userset;width: 60px;">
		<col style="mso-width-source:userset;width: 60px;">
		<col style="mso-width-source:userset;width: 70px;">
		<col style="mso-width-source:userset;width: 320px;">		 
		
				
		<tr style="background-color: #c8c8c8;">
			<td style="width:35px; text-align: center; vertical-align: top; font-size: {!FontSize}; {!BorderColors}" rowspan="2"><b>Investor<br/>Name</b></td>
			<td style="width:20px; text-align: center; vertical-align: top; font-size: {!FontSize}; {!BorderColors}" colspan="2"><b>Coverage</b></td>
			<!-- <td style="width:35px; text-align: center; vertical-align: top; font-size: {!FontSize}; {!BorderColors}"><b><br/>2</b></td> -->
			<td style="width:50px; text-align: center; vertical-align: top; font-size: {!FontSize}; {!BorderColors}" rowspan="2"><b>Low, mm</b></td>
			<td style="width:50px; text-align: center; vertical-align: top; font-size: {!FontSize}; {!BorderColors}" rowspan="2"><b>High, mm</b></td>
			<td style="width:50px; text-align: center; vertical-align: top; font-size: {!FontSize}; {!BorderColors}" rowspan="2"><b>Flash Sent</b></td>
<!-- 			<td style="text-align: center; vertical-align: top; font-size: {!FontSize};"><b>Presentation Sent</b></td> -->
			<td style="width:50px; text-align: center; vertical-align: top; font-size: {!FontSize}; {!BorderColors}" rowspan="2"><b>PPM Sent</b></td>
			<td style="width:50px; text-align: center; vertical-align: top; font-size: {!FontSize}; {!BorderColors}" rowspan="2"><b>DDQ Sent</b></td>
			<td style="width:50px; text-align: center; vertical-align: top; font-size: {!FontSize}; {!BorderColors}" rowspan="2"><b>LPA Sent</b></td>
 			<td style="width:80px; text-align: center; vertical-align: top; font-size: {!FontSize}; {!BorderColors}" rowspan="2"><b>Meeting</b></td>	
<!-- 			<td style="text-align: center;font-size: {!FontSize};"><b>Inv Mtg</b></td>
			<td style="text-align: center;font-size: {!FontSize};"><b>DD Mtg</b></td>
			<td style="text-align: center;font-size: {!FontSize};"><b>IC Mtg</b></td>
 -->		
			<td style="width:250 px; text-align: center; vertical-align: top; font-size: {!FontSize}; {!BorderColors}" rowspan="2"><b>Comments</b></td>
		</tr>		
		<tr style="background-color: #c8c8c8;">
			<td style="text-align: center; vertical-align: top; font-size: {!FontSize}; {!BorderColors}"><b>1</b></td>
			<td style="text-align: center; vertical-align: top; font-size: {!FontSize}; {!BorderColors}"><b>2</b></td>
		</tr>






	
			<apex:repeat var="ZZZ" value="{!sectionList}">

				<tr>
					<td colspan="11" style="background-color: #808080; vertical-align: top; font-size: {!FontSize};"><b>{!ZZZ.sectionName}</b></td>
				</tr>
				<apex:repeat var="XXX" value="{!ZZZ.rows}" >
					<tr>
						<td style="vertical-align: top; font-size: {!FontSize}; {!BorderColors}">{!XXX.investorName}</td>
						<td style="vertical-align: top; font-size: {!FontSize}; {!BorderColors}">{!XXX.primaryCoverage}</td>
						<td style="vertical-align: top; font-size: {!FontSize}; {!BorderColors}">{!XXX.secondaryCoverage}</td>
						<td style="vertical-align: top; text-align: right;font-size: {!FontSize}; {!BorderColors}">
							<apex:outputText value="{0,number,#0.00}" >
								<apex:param value="{!XXX.low}" />
							</apex:outputText> 				
						</td>
						<td style="text-align: right; vertical-align: top; font-size: {!FontSize}; {!BorderColors}">
							<apex:outputText value="{0,number,#0.00}" >
								<apex:param value="{!XXX.high}" />
							</apex:outputText> 				
						</td>
						<td style="text-align: right; vertical-align: top; font-size: {!FontSize}; {!BorderColors}"> <apex:repeat var="YYY" value="{!XXX.flashSent}"> {!YYY}<br style="mso-data-placement:same-cell;"/> </apex:repeat> </td>
		<!-- 				<td style="text-align: right; vertical-align: top; font-size: {!FontSize};"> <apex:repeat var="YYY" value="{!XXX.presentationSent}"> {!YYY}<br/> </apex:repeat> </td> -->
						<td style="text-align: right; vertical-align: top; font-size: {!FontSize}; {!BorderColors}"> <apex:repeat var="YYY" value="{!XXX.PPMsent}"> {!YYY}<br style="mso-data-placement:same-cell;"/> </apex:repeat> </td>
						<td style="text-align: right; vertical-align: top; font-size: {!FontSize}; {!BorderColors}"> <apex:repeat var="YYY" value="{!XXX.DDQsent}"> {!YYY}<br style="mso-data-placement:same-cell;"/> </apex:repeat> </td>
						<td style="text-align: right; vertical-align: top; font-size: {!FontSize}; {!BorderColors}"> <apex:repeat var="YYY" value="{!XXX.LPAsent}"> {!YYY}<br style="mso-data-placement:same-cell;"/> </apex:repeat> </td>
						
						<td style="text-align: right; vertical-align: top; font-size: {!FontSize}; {!BorderColors}"> 
							<apex:repeat var="YYY" value="{!XXX.invMtgDate}"> {!YYY} (Inv)<br style="mso-data-placement:same-cell;"/> </apex:repeat>
							<apex:repeat var="YYY" value="{!XXX.DDMeetingDate}"> {!YYY} (DD)<br style="mso-data-placement:same-cell;"/> </apex:repeat>
							<apex:repeat var="YYY" value="{!XXX.ICMeetingDate}"> {!YYY} (IC)<br style="mso-data-placement:same-cell;"/> </apex:repeat>
						</td> 
						<td style="text-align: left; vertical-align: top; font-size: {!FontSize}; {!BorderColors}"> <apex:repeat var="YYY" value="{!XXX.comments}"> {!YYY}<br style="mso-data-placement:same-cell;"/> </apex:repeat> </td>
					</tr>
				</apex:repeat>
				
				
				<tr style="background-color: #e0e0e0;">
					<td style=" vertical-align: top; font-size: {!FontSize}; {!BorderColors}"><b>Subtotal {!ZZZ.sectionNameSmall}</b></td>
					<td style=" vertical-align: top; font-size: {!FontSize}; {!BorderColors}" colspan="2"></td>
					<td style=" vertical-align: top; text-align: right; font-size: {!FontSize}; {!BorderColors}">
						<apex:outputText rendered="{!IF(ZZZ.subtotalLow == 0, true, false)}" value="-" />
						<apex:outputText rendered="{!IF(ZZZ.subtotalLow != 0, true, false)}" value="{0,number,#0.00}" >
							<apex:param value="{!ZZZ.subtotalLow}" />
						</apex:outputText> 				
					</td>
					<td style="text-align: right; vertical-align: top; font-size: {!FontSize}; {!BorderColors}">
						<apex:outputText rendered="{!IF(ZZZ.subtotalHigh == 0, true, false)}" value="-" />
						<apex:outputText rendered="{!IF(ZZZ.subtotalHigh != 0, true, false)}" value="{0,number,#0.00}" >
							<apex:param value="{!ZZZ.subtotalHigh}" />
						</apex:outputText> 				
					</td>
					<td colspan="6" style=" vertical-align: top; {!BorderColors}"></td>
				</tr>
				
				
				<tr style="background-color: #b0b0b0;">
					<td style=" vertical-align: top; font-size: {!FontSize}; {!BorderColors}"><b>Total</b></td>
					<td style=" vertical-align: top; font-size: {!FontSize}; {!BorderColors}" colspan="2"></td>
					<td style="text-align: right; vertical-align: top; font-size: {!FontSize}; {!BorderColors}">
						<apex:outputText value="{0,number,#0.00}" >
							<apex:param value="{!ZZZ.totalLow}" />
						</apex:outputText> 				
					</td>
					<td style="text-align: right; vertical-align: top; font-size: {!FontSize}; {!BorderColors}">
						<apex:outputText value="{0,number,#0.00}" >
							<apex:param value="{!ZZZ.totalHigh}" />
						</apex:outputText> 				
					</td>
					<td colspan="6" style=" vertical-align: top; {!BorderColors}"></td>
				</tr>
			</apex:repeat>
	</table>
	</body>
</html>
</apex:page>