<apex:page controller="FundDashboardReportFundraisingDeal" showHeader="true" renderas="pdf" cache="true">
	<apex:stylesheet value="{!$Resource.funddashboardcss}"/> 
	<span style="font-size:60%;font-family:Arial,Helvetica,sans-serif;">
		<div align="center;display:inline;"> 
			<h2 style="display:inline;">
				<apex:outputText style="font-size:90%;font-family:Arial,Helvetica,sans-serif;" value="{!day(TODAY())} {!currentMonth}. {!year(TODAY())}" />
			</h2>
		</div>
		<div align="center" style="padding:10px 0 0px 0;color:blue;display:inline;;font-family:Arial,Helvetica,sans-serif;"><h3><i>{!FundName}</i></h3></div>
		<div align="center" style="padding:5px 0 20px 0;color:black;display:inline;;font-family:Arial,Helvetica,sans-serif;"><h3>Fund Dashboard Report</h3></div>
	</span>

	<table style="-fs-table-paginate: paginate; width:100%; font-size:45%; font-family:Arial,Helvetica,sans-serif" >
	    <col width="280" />
	    <col width="180" />
	    <col width="60" />
	    <col width="75" />
	    <col style="display:{!If(!isOtherFund,'', 'none')};" width="80" />
	    <col width="30" />
	    <col width="500" />
	    <thead>
			<tr >
			    <th style="text-align:left;background-color:#B6DACB; color:#000000">Investor</th>
			    <th style="text-align:left;background-color:#B6DACB; color:#000000">Consultant</th>
			    <th style="text-align:left;background-color:#B6DACB; color:#000000">Coverage</th>
			    <th style="text-align:left;background-color:#B6DACB; color:#000000">Interest Level</th>
			    <th style="display:{!If(!isOtherFund,'', 'none')}; text-align:left; background-color:#B6DACB; color:#000000">Existing Investor</th>
			    <th style="background-color:#B6DACB; color:#000000">$</th>
			    <th style="text-align:left;background-color:#B6DACB; color:#000000">Current Status / Next Step</th>
			</tr>
		</thead>
		<tbody>
			<apex:repeat id="normalizedTable" value="{!NormalizedRecords}" var="normalGroup">
				<tr class="groupheader" style="text-align:left; background-color:#B6DACB; color:#000000; font-weight:bold; font-family:Arial,Helvetica,sans-serif">
				    <td colspan="{!If(!isOtherFund, '7','6')}">{!normalGroup.header.styleclass}</td>
				</tr>
		    	<apex:variable value="{!1}" var="rowNum"/>
		    	<apex:repeat id="tableContent" value="{!normalGroup.content}" var="group" >
			        <!-- 
			        <tr style="{!IF(group.tierclass == '','display:none;','')}">
			            <td colspan="6">
			                {!group.tierclass}
			            </td>
			        </tr>
			        -->
			        <tr style="width:100%; font-family:Arial,Helvetica,sans-serif; vertical-align:top; ','display:none;')}">
			            <td >{!group.opp.company__r.Name}</td>
			            <td >{!group.opp.Consultant_Formula__c}</td>
			            <td >{!group.opp.RECA_Coverage__c}</td>
			            <td >{!group.opp.Stage__c}</td>
			            <td style="display:{!If(!isOtherFund,'', 'none')};">{!group.opp.Existing_Investor__c}</td>
			            <td style="text-align:right">{!group.opp.Commitment_Size_MM__c}</td>
			            <td >{!group.opp.Next_Step_RECA__c}</td>
			        </tr>
			        <tr style="background-color:#C0C0C0">
			            <td height="2px" colspan="{!If(!isOtherFund, '7','6')}"> </td>
			        </tr>
		    		<apex:variable var="rowNum" value="{!rowNum + 1}"/>
		    	</apex:repeat>
				<tr class="grouptotals" style="text-align:left; background-color:#C0C0C0; font-weight:bold;" >
				    <td colspan="{!If(!isOtherFund, '5','4')}">Subtotal</td>
				    <td style="text-align:right;">{!normalGroup.footer.opp.Commitment_Size_MM__c}</td>
				    <td> </td>
				</tr>
				<tr>
				    <td height="20px" colspan="{!If(!isOtherFund, '7','6')}"> </td>
				</tr>
			</apex:repeat>
		</tbody>
	</table>
</apex:page>