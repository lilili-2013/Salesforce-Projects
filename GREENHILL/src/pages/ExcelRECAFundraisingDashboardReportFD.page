<apex:page controller="FundDashboardReportFundraisingDeal" showHeader="false" contenttype="application/vnd.ms-excel#{!fundName} Dashboard Report.xls" cache="true">
	<apex:stylesheet value="{!$Resource.funddashboardcss}"/> 

	<span style="font-size:60%;font-family:Arial,Helvetica,sans-serif;">
		<div align="center;display:inline;"> 
			<h2 style="display:inline;">
				<apex:outputText value="{!day(TODAY())} {!currentMonth}. {!year(TODAY())}" />
			</h2>
		</div>
		<div align="center" style="padding:10px 0 0px 0;color:blue;display:inline;"><h3><i>{!FundName}</i></h3></div>
		<div align="center" style="padding:5px 0 20px 0;color:black;display:inline;"><h3>Fund Dashboard Report</h3></div>
	</span>

	<table border="1" style="width:100%; font-size:70%; font-family:Arial,Helvetica,sans-serif">
	    <col width="280" />
	    <col width="180" />
	    <col width="60" />
	    <col width="75" />
	    <apex:outputPanel rendered="{!If(!isOtherFund, true, false)}">
	    	<col width="80" />
	    </apex:outputPanel>
	    <col width="50" />
	    <col width="490" />
		<tr style="background-color:#B6DACB">
	        <th style="text-align:left">Investor</th>
	        <th style="text-align:left">Consultant</th>
	        <th style="text-align:left">Coverage</th>
	        <th style="text-align:left">Interest Level</th>
	        <apex:outputPanel rendered="{!If(!isOtherFund, true, false)}">
	        	<th style="text-align:left;background-color:#B6DACB; color:#000000">Existing Investor</th>
	        </apex:outputPanel>
	        <th >$</th>
	        <th style="text-align:left">Current Status / Next Step</th>
		</tr>
		<apex:repeat id="normalizedTable" value="{!NormalizedRecords}" var="normalGroup">
			<tr class="groupheader" style="background-color: #035C51; color: #FFFFFF; font-weight: bold;font-family:Arial,Helvetica,sans-serif">
			    <td colspan="{!If(!isOtherFund, '7','6')}">{!normalGroup.header.styleclass}</td>
			</tr>
		    <apex:variable value="{!1}" var="rowNum"/>
		    <apex:repeat id="tableContent" value="{!normalGroup.content}" var="group" >
		        <!-- 
		        <tr style="{!IF(group.tierclass == '','display:none;','')}">
		            <td colspan="6">
		                {!group.tierclass}
		            </td>
		        </tr>
		        -->
	        	<tr height="40px" style="width:100%; font-family:Arial,Helvetica,sans-serif; vertical-align:top; ','display:none;')}">
		            <td >{!group.opp.company__r.Name}</td>
		            <td >{!group.opp.Consultant_Formula__c}</td>
		            <td >{!group.opp.RECA_Coverage__c}</td>
		            <td >{!group.opp.Stage__c}</td>
		            <apex:outputPanel rendered="{!If(!isOtherFund, true, false)}">
		            	<td >{!group.opp.Existing_Investor__c}</td>
		            </apex:outputPanel>	
		            <td style="text-align:right">{!group.opp.Commitment_Size_MM__c}</td>
		            <td style="cellpadding:20px">{!group.opp.Next_Step_RECA__c}</td>
		        </tr>
    			<apex:variable var="rowNum" value="{!rowNum + 1}"/>
    		</apex:repeat>
			<tr class="grouptotals" style="background-color:#C0C0C0; font-weight:bold;" >
			    <td colspan="{!If(!isOtherFund, '5','4')}">Subtotal</td>
			    <td  style="text-align:right;">{!normalGroup.footer.opp.Commitment_Size_MM__c}</td>
			    <td> </td>
			</tr>
			<tr>
			    <td colspan="{!If(!isOtherFund, '7','6')}"> </td>
			</tr>
		</apex:repeat>
	</table>
</apex:page>