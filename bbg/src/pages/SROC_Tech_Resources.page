<apex:page showHeader="false" sidebar="false" standardStylesheets="false" applyHtmlTag="false" applyBodyTag="false" docType="html-5.0" controller="SROC_Tech_ResourcesController" action="{!forwardToLogin}">
	
  <style>
    .has-feedback.has-clear {
      /* Remove Internet Explorer native clear button */
    }
    .has-feedback.has-clear input::-ms-clear { 
      display: none;  
    }
    .has-feedback.has-clear .form-control-clear {   
      color: #bbb;
      color: rgba(0, 0, 0, 0.4);
      pointer-events: auto;
    }
    .has-feedback.has-clear .form-control-clear:hover { 
      color: #777;
      color: rgba(0, 0, 0, 0.7);
      cursor: pointer;
    }
    .has-feedback.has-clear.has-empty-value .form-control-clear {
      display: none;
    }

    .form-control-clearable {
      position: relative;
    }

    .form-control-clearable .form-control-clear {
      top: -5px;
    }
  </style>
	
  <apex:includeScript value="/soap/ajax/34.0/connection.js" />
  <apex:includeScript value="/soap/ajax/34.0/apex.js" />
	
  <apex:composition template="{!$Site.Template}">
    <apex:define name="pagetitle">Tech Resources</apex:define>

    <apex:define name="body" >

      <header class="container page-heading">
        <h1 class="inline">Tech Resources</h1>
      </header>

      <article>
        <section class="container box featured-news">
          <div class="col-xs-0">
            <h1><apex:outputText value="Tech Resources"/></h1>
            <h3><apex:outputText value="Find Owners Manuals, Support Documentation, Community Answers and much more!"/></h3>
            <hr class="hr-sm hr-black"/>
          </div>
        </section>
      </article>

      <article class="container box">
        <div class="row">
          <div class="col-sm-8 col-md-9">

            <apex:pageMessages />

            <!-- Nav tabs -->
            <ul class="nav nav-tabs" role="tablist">
              <li class="active">
                <apex:outputLink value="#show-faqs" html-role="tab" html-data-toggle="tab">Sea Ray FAQs</apex:outputLink>
              </li>
              
              <li>
                <apex:outputLink value="#show-documentation" html-role="tab" html-data-toggle="tab">Sea Ray Resources</apex:outputLink>
              </li>
				
              <li>
                <apex:outputLink value="#show-answers" html-role="tab" html-data-toggle="tab">Answers by Owners</apex:outputLink>
              </li>
            </ul>

            <!-- Tab panes -->
            <div class="tab-content">
              
              <section class="tab-pane az-listing active" id="show-faqs">
			  	<div class="col-xs-0">
                  <h1><apex:outputText value="FAQ Help Text Info..."/></h1>
                  <h3><apex:outputText value="Below you’ll find some of the most Frequently Asked Questions related to Sea Ray ownership. Use keywords to search for your topic of interest or filter by categories to find the most relevant information. If you don’t find what you're looking for, check out the extensive documentation library in Technical Resources or visit the Answers by Owners section to see if another owner has asked or answered the same question based on their own experiences."/></h3>
                  <hr class="hr-sm hr-black"/>
                </div>
                
                <c:SROC_Tech_Resources_FAQ numberOfResults="200" showCategoryFilters="true" filterOnFaqCategory="All" allowSearch="true"/>
                
			  </section>
			  
			  
			  
              <section class="tab-pane az-listing" id="show-documentation">
                <div class="col-xs-0">
                  <h1><apex:outputText value="Tap into Sea Ray's Archives of Useful Documents"/></h1>
                  <h3><apex:outputText value="Access the library of technical resources available from Sea Ray. Search according to boat model, part number or keyword to locate the documents most applicable."/></h3>
                  <hr class="hr-sm hr-black"/>
                </div>

                <apex:form id="searchForm">
                  <form role="form">
                    <div style="min-height: 20px;"></div>
                    <div class="form-group has-feedback has-clear">
                      <span class="form-control-clearable">
                        <apex:inputText id="searchTextInput" value="{!keywordSearch}" styleClass="form-control user-input" style="width: 70%; display: inline-block;margin-left:10px;" html-placeholder="Keywords: type, year, boat category..."/>
                        <span class="glyphicon glyphicon-remove-sign form-control-feedback form-control-clear hidden" aria-hidden="true">X <span class="sr-only">Clear input content</span></span>
                      </span>
                      <apex:commandButton id="searchButton" value="Search" action="{!doFilter}" styleClass="btn btn-primary" style="display: inline-block;margin-bottom: 4px;margin-left:10px;" rerender="kaList,paginationTop" status="filterStatus"/>
                      <apex:actionFunction name="doFilter" action="{!doFilter}" rerender="kaList,paginationTop,paginationBottom,paginationPanel,paginationPanelBottom" status="filterStatus"/>
                    </div>
                   </form>
                </apex:form>

                <div style="min-height: 20px;"></div>

                <div class="col-md-3">

                  <apex:form id="filterForm">
                  <apex:actionRegion id="formRegion">
                    <div class="form-group">
                     
                      Refine By (Select One):
                      <apex:selectList id="filterBySelectList" styleClass="form-control" value="{!filterBy}" multiselect="false" size="3">
                        <apex:selectOption itemValue="Year" itemLabel="Year" />
                        <apex:selectOption itemValue="Boat_Category" itemLabel="Boat Category" />
                        <!-- <apex:selectOption itemValue="Model" itemLabel="Model" /> -->
                        <apex:actionSupport event="onchange" action="{!selectFilterBy}" rerender="kaCategory" status="catSelect"/>
                      </apex:selectList>

                      <apex:actionStatus id="catSelect">
                        <apex:facet name="start">Updating...</apex:facet>
                          <apex:facet name="stop">

                          <apex:outputPanel id="kaCategory" styleClass="scrollable-hint">
                            <apex:selectList styleClass="form-control" style="margin-top:10px;" value="{!selectedCategory}" multiselect="false" size="10">
                              <apex:selectOptions value="{!CategoryList}" />
                              <apex:actionSupport event="onchange" action="{!doFilter}" rerender="kaList,paginationTop,paginationBottom,paginationPanel,paginationPanelBottom" status="filterStatus"/>
                            </apex:selectList>
                          </apex:outputPanel>
                        </apex:facet>
                      </apex:actionStatus>
                    </div>
                    </apex:actionRegion>
                  
                  <div style="min-height: 20px;"></div>
                  
                  Manual Type:
                  	<apex:selectList id="articleTypeSelectList" styleClass="form-control" value="{!selectedArticleType}" multiselect="false" size="10">
                        <apex:selectOption itemValue="Owners_Manual__kav,Parts_Manual__kav,Component_Manual__kav,Engine_Drive_and_Prop_Matrix__kav,Full_Brochure__kav,General_Information_Manual__kav,Prop_Chart__kav,Specification_Sheet__kav" itemLabel="All" />
                        <apex:selectOption itemValue="Owners_Manual__kav" itemLabel="Owners Manual" />
                        <apex:selectOption itemValue="Parts_Manual__kav" itemLabel="Parts Manual" />
                        <apex:selectOption itemValue="Component_Manual__kav" itemLabel="Component Manual" />
                        <apex:selectOption itemValue="Engine_Drive_and_Prop_Matrix__kav" itemLabel="Engine Drive and Prop Matrix" />
                        <apex:selectOption itemValue="Full_Brochure__kav" itemLabel="Full Brochure" />
                        <apex:selectOption itemValue="General_Information_Manual__kav" itemLabel="General Information Manual" />
                        <apex:selectOption itemValue="Prop_Chart__kav" itemLabel="Prop Chart" />
                        <apex:selectOption itemValue="Specification_Sheet__kav" itemLabel="Specification Sheet" />
                        <apex:actionSupport event="onchange" action="{!doFilter}" rerender="kaList,paginationTop,paginationBottom,paginationPanel,paginationPanelBottom" status="filterStatus"/>
                    </apex:selectList>
					
					 <div style="min-height: 20px;"></div>
					
                    <apex:commandButton action="{!resetFilter}" rerender="articleTypeSelectList,paginationTop,paginationBottom,filterBySelectList,kaCategory, kaList, paginationPanel,paginationPanelBottom" status="filterStatus" id="resetFiltersButton" value="Reset" styleClass="btn btn-primary" style="margin-top: 10px; margin-bottom: 4px;"/>


                  </apex:form>    

                </div>

                <div class="col-md-9">
                  <apex:actionStatus startText=" Updating... " stopText="" id="filterStatus"/>
                  
                  <apex:form >
                  <apex:outputPanel id="paginationPanel">
                  <div class="pagination-wrapper pull-right hidden-xs hidden-sm">
                  <apex:outputPanel id="paginationTop" rendered="{!hasResults}">
                    <div class="form-inline pull-left" role="form">
                      <div class="form-group">
                        <label for="page">Page</label>
                        <!--  <input type="text" class="form-control input-sm" id="page" name="page" value="{!pageNumber}" onkeypress="return ignoreEnterKeySave(event,this.value);" onchange="goToPage(this.value);onScreenResize(determineBreakpoint());" />-->
                        <apex:outputText value=" {!pageNumber}"/>
                      </div>
                      
                    </div>
                        <ul class="pagination pagination-sm pull-right hidden-xs">
                          <apex:outputPanel layout="none" rendered="{!hasPrevSet==true}">
                            <li>
                              <apex:commandLink value="<" action="{!prevSet}" rerender="kaList,paginationTop,paginationBottom" status="filterStatus"></apex:commandLink>
                            </li>
                          </apex:outputPanel>
                          <apex:outputPanel layout="none" rendered="{!hasNextSet==true}">
                            <li>
                              <apex:commandLink value=">" action="{!nextSet}" rerender="kaList,paginationTop,paginationBottom" status="filterStatus"></apex:commandLink>
                            </li>
                          </apex:outputPanel>
                        </ul>
                        <apex:actionFunction action="{!GoToPage}" name="goToPage" reRender="kaList,paginationTop,paginationBottom" status="filterStatus">
                             <apex:param name="param" assignTo="{!SpecifiedPageNumber}" value="param" />
                        </apex:actionFunction>
                  </apex:outputPanel>
                </div>
                </apex:outputPanel>
                <apex:actionFunction action="{!noResults}" name="setNoResults" reRender="paginationPanel,paginationPanelBottom" status="filterStatus" oncomplete="setNoResultMsg();"/>
                </apex:form>
                  
                  <script>
                  	sforce.connection.sessionId = '{!$Api.Session_ID}';  
                  </script>
                  
                  <apex:actionRegion >
                    <apex:outputPanel id="kaList">
                      <apex:outputPanel layout="block" rendered="{!selectedCategory != '' && filterBy != ''}">
						
						<apex:outputPanel layout="none" rendered="{!isOwner}">
						<script>
						var hasMoreArticles = false;
						
						function callBookmarkItem(articleId, articleTitle) {
                            
                            var bookmark = "" + sforce.apex.execute("SROCUtilities","queryBookmarkItem", 
                                       {articleId:articleId,
                                       articleTitle: articleTitle});
                            if(bookmark > 0)
                            {
                            	alert('Already added to My Boat Page!');
                            }
                            else
                            {
                            	var result = "" + sforce.apex.execute("SROCUtilities","bookmarkArticle", 
                                       {articleId:articleId});
                                alert(result);
                          	}
                          	
                          }
						</script>
						</apex:outputPanel>
						
                        <knowledge:articleList articleVar="article"
                        articleTypes="{!selectedArticleType}"
                        categories="{!IF(selectedCategory == 'All','','Support_Documentation:'+selectedCategory)}"
                        keyword="{!keywordSearch}"
                        sortBy="mostViewed"
                        pageNumber="{!SpecifiedPageNumber}"
                        pageSize="8"
                        hasMoreVar="false"
                        >
                          <script>
                          	hasMoreArticles = true;
                          </script>
                          
                          <div class="form-group" id="fileurl-{!article.Id}"><apex:outputLink value="{!$Page.SROC_Tech_ResourcesDetail}?id={!article.Id}"> {!article.title}</apex:outputLink></div>
                          <div class="form-group"><apex:outputText escape="false" value="{!article.Summary}"/></div>
                          <apex:outputPanel layout="none" rendered="{!isOwner}">
                          	<div class="form-group" id="bookmark">
                          		<button type="button" class="btn btn-primary" onclick="callBookmarkItem('{!article.Id}','{!article.Title}');">Add to My Boat</button>
                          	</div>
                          </apex:outputPanel>
                          <br/>
                           
                        </knowledge:articleList>
						
						<div id="noResultsDiv"></div>
						
						<script>
							if(!hasMoreArticles && '{!SpecifiedPageNumber}' != '1')
							{
								doFilter();
							}
							else if(!hasMoreArticles && '{!SpecifiedPageNumber}' == '1')
							{
								setNoResults();
																
							}
						</script>
						
                      </apex:outputPanel>
                    </apex:outputPanel>
                  </apex:actionRegion>
                	
                	
                	<apex:form >
                  <apex:outputPanel id="paginationPanelBottom">
                  <div class="pagination-wrapper pull-right hidden-xs hidden-sm">
                  <apex:outputPanel id="paginationBottom" rendered="{!hasResults}">
                    <div class="form-inline pull-left" role="form">
                      <div class="form-group">
                        <label for="page">Page</label>
                        <input type="text" class="form-control input-sm" id="page" name="page" value="{!pageNumber}" onkeypress="return ignoreEnterKeySave(event,this.value);" onchange="goToPage(this.value);onScreenResize(determineBreakpoint());" />
                      </div>
                      
                    </div>
                        <ul class="pagination pagination-sm pull-right hidden-xs">
                          <apex:outputPanel layout="none" rendered="{!hasPrevSet==true}">
                            <li>
                              <apex:commandLink value="<" action="{!prevSet}" rerender="kaList,paginationTop,paginationBottom" status="filterStatus"></apex:commandLink>
                            </li>
                          </apex:outputPanel>
                          <apex:outputPanel layout="none" rendered="{!hasNextSet==true}">
                            <li>
                              <apex:commandLink value=">" action="{!nextSet}" rerender="kaList,paginationTop,paginationBottom" status="filterStatus"></apex:commandLink>
                            </li>
                          </apex:outputPanel>
                        </ul>
                        
                  </apex:outputPanel>
                </div>
                </apex:outputPanel>
                </apex:form>
                	
                	
                	
                </div>
                
                
                
              </section>
			  
			  
			  
			  
			  
              <section class="tab-pane az-listing" id="show-answers">

                <div class="col-xs-0">
                  <h1><apex:outputText value="Engage in Q&A with the Knowledgeable Sea Ray Community"/></h1>
                  <h3><apex:outputText value="Curious about some aspect of your Sea Ray? Your fellow boaters are a tremendous resource. Pose your question to the community, and share your own insights on other members’ posts."/></h3>
                  <hr class="hr-sm hr-black"/>
                </div>
				
				<div class="col-md-3">
					<chatteranswers:searchask communityId="{!ZoneId}" rendered="{!NOT(ISBLANK(ZoneId))}"/>
					<chatteranswers:datacategoryfilter communityId="{!ZoneId}" rendered="{!NOT(ISBLANK(ZoneId))}"/>
				</div>
				<div class="col-md-8">
				
                	
                	<chatteranswers:feedfilter rendered="{!NOT(ISBLANK(ZoneId))}"/>
                	<chatteranswers:feeds communityId="{!ZoneId}" rendered="{!NOT(ISBLANK(ZoneId))}"/>
				</div>
              </section>

            </div>

          </div>
        </div>
      </article>

      <script>
        (function($) {

          function autoSetClearControlState(clearableField, clearControl) {
            // If the search field has any text in it, but isn't just whitespace
            // show the clear control; otherwise, hide it.
            clearControl.toggleClass("hidden", !clearableField.val().trim().length);
          }

          $(".form-group.has-clear").each(function(index, formGroup) {
            var clearControl,
                clearableField;

            formGroup = $(formGroup);

            // Gemt the clear control for this form group.
            clearControl = $(".form-control-clear", formGroup);

            // The field we're going to clear.
            clearableField = $(".form-control.user-input", formGroup);

            // When clicked, set the clearable field's value to an empty string.
            clearControl.on("click", function(event) {
              clearableField.val("");
              clearControl.addClass("hidden");
              doFilter();
            });

            // Show/hide the clear control as-needed when the field is modified.
            clearableField.on("keyup change", function(event) {
              autoSetClearControlState(clearableField, clearControl);
            });

            // Set the initial state.
            autoSetClearControlState(clearableField, clearControl);
          });

        })(jQuery);
        
       	function ignoreEnterKeySave(e, value){
			if ((window.event&&window.event.keyCode==13) || e.which==13) {
    			goToPage(value);
        		return false;
    		} else {
        		return true;
    		};
		}
		
		function setNoResultMsg() {
			$('#noResultsDiv').html( '<div>Your search returned no results.</div>' );
		}
		
		
		$(function(){
		
		// Handle deeplinking down to the submit-ScheduledContent form
		  var tabHash = window.location.hash;
		  tabHash && $('ul.nav a[href="' + tabHash + '"]').tab('show');
		  $('body').scrollTop(0);
        
        $('.nav-tabs a').click(function (e) {
    		$(this).tab('show');
    		var scrollmem = $('body').scrollTop();
    		if(this.tabHash != null && this.tabHash != '')
    		{
    			window.location.hash = this.tabHash;
    		}
    		else
    		{
    			window.location.hash = $(this).attr("href");
    		}
    		$('html,body').scrollTop(scrollmem);
  });
});
        
      </script>

    </apex:define>
  </apex:composition>

</apex:page>