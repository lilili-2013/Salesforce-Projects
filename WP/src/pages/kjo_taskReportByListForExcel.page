<apex:page standardController="Company_List__c" extensions="kjo_TaskReportController" contenttype="application/x-excel#callreport.xls" id="taskreportpage" showHeader="false" sidebar="false">

 <head>
    <meta http-equiv="Content-Type" content="text/html;charset=UTF-8" />
 </head>

<!--  
    contenttype="application/x-excel#callreport.xls"
-->

    
<style type="text/css"> 
.basicdate {
    mso-number-format:"Short Date";
}
.basictext {
    mso-number-format:"\@";
}
</style>

    
    <table>
    	<tr>
    		<th></th>
    	</tr>
    	<tr>
	        <th></th>	    
	        <th></th>        
	        <th colspan="7" style="border-bottom:.5pt solid windowtext;" >Last Activity</th>	      
		    <th colspan="7" style="border-bottom:.5pt solid windowtext;"> Follow-Up Activity</th> 
        </tr>
    </table>
    
    <table>
    <thead>
        <tr>
        <th>
            Company Name        
        </th>  
        <th>
            Contact Name        
        </th> 
        <th>
            Contact Title        
        </th>            
        <th>
            Company Description        
        </th>  

		<th>
            Last Activity Type
        </th>
        
         <th>
            Last Activity Date
        </th>

        <th>
            Last Activity Subject
        </th>
        
        <th>
            Last Activity By
        </th>
        
        <th>
            Last Activity Contacts
        </th>  
        
        <th>
            Last Activity Description
        </th>
        
        <th>
            Last Activity Status
        </th>
        
        <!-- Start follow up  -->   
        
        <th>
            Follow-Up Activity Type
        </th>
        
         <th>
            Follow-Up Activity Date
        </th>
        
        <th>
            Follow-Up Activity Subject
        </th>  
        
        <th>
            Follow-Up Activity By
        </th>   
		
		<th>
            Follow-Up Activity Contacts
        </th> 
        
        <th>
            Follow-Up Activity Description
        </th>     

        <th>
            Follow-Up Status
        </th>        
        
        <th>
            Financials
        </th>
        <th>
            Other Lists
        </th>
        </tr>
    </thead>    
    <tbody>
    <apex:repeat value="{!TaskSummaryInformationAsExcel}" var="tasksummary" >
        <tr>
        <td>
            {!tasksummary.CompanyName}        
        </td>
        
        <td>
        	{!tasksummary.ContactName}
        </td>
        <td>
        	{!tasksummary.ContactTitle}
        </td>
        
        
        <td style='white-space:nowrap'>
            {!tasksummary.CompanyDescription}        
        </td>
                
        <td>
            {!tasksummary.Classification}
        </td>
        
        <td class="basicdate">
            <apex:outputText value="{0, date, MM'/'dd'/'yyyy}">
                <apex:param value="{!tasksummary.ActivityDate}" /> 
            </apex:outputText>        
        </td>

        <td style='white-space:nowrap'>
            {!tasksummary.Subject}
        </td>
		
		<td>
            {!tasksummary.ActivityOwnerName}
        </td>
        
        <td style='white-space:nowrap'>
        	<apex:repeat value="{!tasksummary.OtherContacts}" var="listinfo" >
                {!listinfo.Name}; 
			</apex:repeat>
        </td>
        
        <td style='white-space:nowrap'>
        	{!tasksummary.Description}
        </td>
		
		<td>
            {!tasksummary.Status}
        </td>        
    
	<!-- Start follow up  -->
	    <td>
            {!tasksummary.FollowUpClassification}
        </td>
		
		 <td class="basicdate">
            <apex:outputText value="{0, date, MM'/'dd'/'yyyy}">
                <apex:param value="{!tasksummary.NextActivityDate}" /> 
            </apex:outputText>        
        </td>
		
		<td style='white-space:nowrap'>
            {!tasksummary.FollowUpSubject}
        </td>
		
		<td>
            {!tasksummary.NextActivityOwnerName}
        </td>
		
		<td style='white-space:nowrap'>
        	<apex:repeat value="{!tasksummary.OtherFollowUpContacts}" var="listinfo" >
                {!listinfo.Name}; 
			</apex:repeat>
        </td>
		 
		 <td style='white-space:nowrap'>
            {!tasksummary.FollowupDescription}
        </td>
		
        <td>
            {!tasksummary.FollowUpStatus}
        </td>

        <td style='white-space:nowrap'>
            <apex:repeat value="{!tasksummary.Financials}" var="financials" >
                <!-- 
                <strong>{!financials.PeriodType}</strong> as of 
                <apex:outputText value="{0, date, MM.dd.yy}">
                    <apex:param value="{!financials.PeriodEnded}" />
                </apex:outputText> -  
                [EBITDA: {!financials.CurrencyIsoCode}
                <apex:outputText value="{0, number, 000,000}">
                    <apex:param value="{!financials.EBITDA}" />
                </apex:outputText>] ; 
                [Revenue: {!financials.CurrencyIsoCode}
                <apex:outputText value="{0, number, 000,000}">
                    <apex:param value="{!financials.Revenues}" />
                </apex:outputText>] ; 
                [Net Income: {!financials.CurrencyIsoCode}
                <apex:outputText value="{0, number, 000,000}">
                    <apex:param value="{!financials.NetIncome}" />
                </apex:outputText>]
                 --> 
                {!financials.ReportString}
            </apex:repeat>
        </td>

        <td style='white-space:nowrap'>
            <apex:repeat value="{!tasksummary.OtherLists}" var="listinfo" >
                {!listinfo.Name}; 
            </apex:repeat>
        </td>

        </tr>
    </apex:repeat>
    </tbody>
    </table>
</apex:page>