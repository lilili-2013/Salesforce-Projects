<apex:page controller="SL_ctrl_TickSheetProperty" standardStylesheets="false">

<apex:stylesheet value="{! URLFOR( $Resource.TickSheet, 'css/styles.css' ) }" />
<!--[if IE]>
	<link rel="stylesheet" type="text/css" href="{! URLFOR( $Resource.TickSheet, 'css/styles-ie.css' ) }" />
<![endif]-->

<script type="text/javascript">
function disableButtons() {
	var buttons = document.getElementsByClassName('wp-button');
	for( var i = 0; i < buttons.length; i++ ) {
		buttons[i].className = "wp-button btnDisabled";
		buttons[i].disabled = "disabled";
	}
}
</script>

<apex:form >

<div class="header" style="position: relative">
	<div class="header-body">Contact: {! IF( EmployeeContact.Name != null, EmployeeContact.Name, 'Unknown' ) }</div>
	<div class="ticksheet-selector-wrapper">
		<span class="ticksheet-selector-label">Ticksheet:</span> 
		<apex:selectList styleClass="ticksheet-selector-list" value="{!CurrentTicksheet}" size="1">
			<apex:selectOptions value="{!AvailableTicksheets}" />
			<apex:actionSupport event="onchange" onsubmit="disableButtons();" action="{! ChangeTicksheet }" />
		</apex:selectList>
	</div>
</div>

<apex:messages />

<div class="buttonSection" style="margin-bottom: 10px;">
	<apex:commandButton styleClass="wp-button" action="{! Save }" value="Save" disabled="{! ButtonDisabled }" />
	<apex:commandButton styleClass="wp-button" action="{! Cancel }" value="Cancel" disabled="{! ButtonDisabled }" />
</div>
<table style="width: 100%; border-collapse: collapse; font-family: sans-serif;">
<apex:repeat value="{! Sections }" var="section">
	<tr>
		<td>
			<div class="section-header" style="text-align:{! section.sJustification };{! IF( section.bBold, 'font-weight:bold;', '' ) }{! IF( section.bItalic, 'font-style: italic;', '' ) }">{! section.sTitle }</div>
			<table class="section">
			<apex:repeat value="{! section[ 'aRows' ] }" var="sectionRow">
				<tr>
				<apex:repeat value="{! sectionRow[ 'aColumns' ] }" var="sectionColumn">
					<td colspan="{! sectionColumn[ 'nColspan' ] }" rowspan="{! sectionColumn[ 'nRowspan' ] }" style="{! sectionColumn[ 'sWidth' ] }">
					<apex:repeat value="{! sectionColumn[ 'aSubsections' ] }" var="subsection">
						<table class="{! IF( !subsection[ 'bEmpty' ], 'subsection-header', '' ) }" style="width: 100%;">
							<tr>
								<td class="checkBox" style="{! IF( !subsection.CheckboxRendered, 'display:none', '' ) }"><apex:inputCheckbox rendered="{! subsection.CheckboxRendered }" value="{! subsection.bChecked }" /></td>
								<td style="vertical-align:middle; text-align:{! IF( subsection.sJustification != null, subsection.sJustification, 'left' ) };{! IF( subsection.bBold, 'font-weight:bold; ', '' ) }{! IF( subsection.bItalic, 'font-style:italic;', '' ) }{! IF( !subsection.CheckboxRendered, 'padding-left:33px', '' ) }">{! subsection.sTitle }&nbsp;</td>
							</tr>
						</table>
						<table class="subsection">
						<apex:repeat value="{! subsection[ 'aRows' ] }" var="row">
							<tr>
							<apex:repeat value="{! row[ 'aColumns' ] }" var="property">
								<td class="checkBox" style="{! IF( !property.CheckboxRendered, 'display:none', '' ) }"><apex:inputCheckbox rendered="{! property.CheckboxRendered }" value="{! property.bChecked }" /></td>
								<td class="property-name" colspan="{! IF( !property.CheckboxRendered, '2', '1' ) }" style="text-align:{! property.sJustification };{! IF( property.bBold, 'font-weight:bold;', '' ) }{! IF( property.bItalic, 'font-style:italic;', '' ) }">
									{! property.sTitle }
								</td>
							</apex:repeat>
							</tr>
						</apex:repeat>
						</table>
					</apex:repeat>
					</td>
				</apex:repeat>
				</tr>
			</apex:repeat>
			</table>
		</td>
	</tr>
</apex:repeat>
</table>
<div class="buttonSection" style="margin-top: 5px; padding-top: 5px; border-top: solid 1px silver;">
	<apex:commandButton styleClass="wp-button" action="{! Save }" value="Save" disabled="{! ButtonDisabled }" />
	<apex:commandButton styleClass="wp-button" action="{! Cancel }" value="Cancel" disabled="{! ButtonDisabled }" />
</div>
</apex:form>
</apex:page>