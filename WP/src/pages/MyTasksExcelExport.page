<apex:page controller="MyTasksController" contenttype="application/x-excel#mytasksreport{!NOW()}.xls" id="taskreportpage" showHeader="false" sidebar="false">

<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40">
 <head>
    <meta http-equiv="Content-Type" content="text/html;charset=UTF-8" />
 </head>
 <style type="text/css"> 
.basicdate {
    mso-number-format:"Short Date";
}
.basictext {
    mso-number-format:"\@";
}
</style>
 <table>
    <thead>
    <tr>
    	<th>Due Date</th>
	    <th>Company/Contact</th>
	    <th>Subject</th>
	    <th>Classification</th>
	    <th>Name</th>
	    <th>Note</th>	     
    </tr>
	</thead>
	<tbody>
	<apex:repeat value="{!UserTaskSummaryAsExcel}" var="tasksummary" >
	<tr>
		<td class="basicdate">
            <apex:outputText value="{0, date, MM'/'dd'/'yyyy}">
                <apex:param value="{!tasksummary.ActivityDate}" /> 
            </apex:outputText>        
        </td>
		<td style='white-space:nowrap'>
			{!tasksummary.CompanyContactforExcel}
        </td>
		<td>
			{!tasksummary.Subject}  
		</td>
		<td>
			{!tasksummary.Classification}
		</td>
		<td style='white-space:nowrap'>
        	<apex:repeat value="{!tasksummary.OtherContacts}" var="listinfo" >
                {!listinfo.Name}&nbsp;&nbsp;  
			</apex:repeat>
        </td>
		<td>
			{!tasksummary.Description}
		</td>
	</tr>
	</apex:repeat>
	</tbody>
 </table>
</html>
 </apex:page>